"use strict";(()=>{var ge=(e,n=null)=>{switch(e){case"stage":return n==="Advanced"?t.stage.true>=7||t.stage.true>=6&&t.stage.resets>=1:n==="Structures"||n===null;case"Elements":case"upgrade":return t.stage.true<2&&t.discharge.energyMax<12?!1:n==="Elements"||e==="Elements"?r.stageInfo.activeAll.includes(4)&&t.upgrades[4][1]===1:n==="Upgrades"||n===null;case"strangeness":return t.stage.true<7&&t.strange[0].total<=0&&(!t.inflation.vacuum||t.stage.current<5)?!1:n==="Milestones"?!t.inflation.vacuum:n==="Matter"||n===null;case"inflation":return t.stage.true<7?!1:n==="Researches"||n==="Milestones"||n===null;case"settings":return n==="History"?t.stage.true>=7||t.strange[0].total>0:n==="Settings"||n==="Stats"||n===null;default:return!1}},Pt=(e,n)=>{if(e<1||r.buildingsInfo.maxActive[n]<e+1)return!1;if(n===1)return!0;if(n===2)return!0;if(n===3){if(t.accretion.rank===0)return!1;if(e===1)return!0;if(e===2)return t.upgrades[3][2]===1;if(e===3)return t.upgrades[3][4]===1;if(e===4)return t.upgrades[3][8]===1;if(e===5)return t.upgrades[3][11]===1}else if(n===4){if(t.collapse.mass<r.collapseInfo.unlockB[e]&&t.researchesExtra[5][0]<1)return!1;if(e===1)return!0;if(e===2)return t.researchesExtra[4][0]>=1;if(e===3)return t.researchesExtra[4][0]>=2;if(e===4)return t.researchesExtra[4][0]>=3;if(e===5)return t.elements[26]>=1&&t.challenges.active!==0}else if(n===5){if(e===1)return t.inflation.vacuum||t.milestones[2][0]>=7;if(e===2)return t.inflation.vacuum||t.milestones[3][0]>=7;if(e===3)return t.researchesExtra[5][0]>=1}else if(n===6)return t.inflation.vacuum;return!1},be=(e,n,s)=>{if(e<0)return!1;switch(s){case"upgrades":if(r.upgradesInfo[n].maxActive<e+1)return!1;if(n===1)return e===0||e===1?t.inflation.vacuum:e===3?t.upgrades[1][5]===1||t.buildings[1][t.inflation.vacuum?4:2].total.moreThan("0"):e===4?t.upgrades[1][5]===1||t.buildings[1][t.inflation.vacuum?5:3].total.moreThan("0"):e>5?t.upgrades[1][5]===1:!0;if(n===2)return e===0?t.buildings[2][1].true>=1||t.buildings[2][2].current.moreOrEqual("1"):e===7?t.strangeness[2][2]>=3:e===8?t.strangeness[2][8]>=3:!0;if(n===3)return t.accretion.rank<r.accretionInfo.rankU[e]||t.accretion.rank===0?!1:e===7?t.strangeness[3][2]>=3:!0;if(n===4)return t.collapse.mass<r.collapseInfo.unlockU[e]&&t.researchesExtra[5][0]<1?!1:e===2?t.upgrades[4][1]===1:e===3?t.strangeness[4][2]>=3&&t.upgrades[4][2]===1&&(t.collapse.stars[1]>0||t.researchesExtra[5][0]>=1):e===4?t.strangeness[4][9]>=1&&t.upgrades[4][3]===1:!0;if(n===5){if(e===0)return t.inflation.vacuum||t.milestones[2][0]>=7;if(e===1)return t.inflation.vacuum||t.milestones[3][0]>=7;if(e===2)return t.buildings[5][3].true>=1;if(e===3)return t.inflation.vacuum?t.accretion.rank>=7:t.milestones[5][1]>=8}break;case"researches":if(r.researchesInfo[n].maxActive<e+1)return!1;if(n===1)return t.upgrades[1][5]===1;if(n===2)return!0;if(n===3)return t.accretion.rank>=r.accretionInfo.rankR[e]&&t.accretion.rank!==0;if(n===4)return t.collapse.mass<r.collapseInfo.unlockR[e]&&t.researchesExtra[5][0]<1?!1:e===3?(t.collapse.stars[0]>0||t.researchesExtra[5][0]>=1)&&t.strangeness[4][2]>=1:e===4?t.collapse.stars[2]>0||t.researchesExtra[5][0]>=1:e===5?(t.collapse.stars[2]>0||t.researchesExtra[5][0]>=1)&&t.strangeness[4][9]>=3:!0;if(n===5){if(e===0)return t.inflation.vacuum||t.milestones[2][0]>=7;if(e===1)return t.inflation.vacuum||t.milestones[3][0]>=7}break;case"researchesExtra":if(r.researchesExtraInfo[n].maxActive<e+1)return!1;if(n===1)return e===1?t.researchesExtra[1][2]>=2:e===3?t.researchesExtra[1][2]>=1:e===4?t.accretion.rank>=6:t.upgrades[1][5]===1;if(n===2)return e===3?t.accretion.rank>=6:t.upgrades[2][2]===1;if(n===3)return t.accretion.rank<r.accretionInfo.rankE[e]||t.accretion.rank===0?!1:e===4?t.researchesExtra[1][2]>=2:!0;if(n===4)return e===1?t.collapse.stars[0]>0||t.researchesExtra[5][0]>=1:e===2?(t.collapse.stars[0]>0||t.researchesExtra[5][0]>=1)&&t.strangeness[4][2]>=2:e===3?(t.collapse.stars[1]>0||t.researchesExtra[5][0]>=1)&&t.strangeness[4][9]>=2:!0;if(n===5&&e===0)return(t.inflation.vacuum||t.milestones[4][1]>=8)&&t.strangeness[5][3]>=1;break;case"researchesAuto":{let o=r.researchesAutoInfo.autoStage[e][t.researchesAuto[e]];return o===n||o===4&&n===5?e===0||e===1?t.inflation.vacuum:!0:!1}case"ASR":return n===1?t.upgrades[1][5]>=1:n===3?t.accretion.rank!==0:!0;case"elements":return e>=29?t.upgrades[4][4]===1&&t.buildings[6][1].true>=e-29:e>=27?t.upgrades[4][3]===1:e>=11?t.upgrades[4][2]===1&&(t.collapse.stars[1]>0||t.researchesExtra[5][0]>=1):e>=6?t.upgrades[4][2]===1:t.upgrades[4][1]===1&&e>0;case"strangeness":if(r.strangenessInfo[n].maxActive<e+1)return!1;if(t.inflation.vacuum){if(n===1){if(e===7)return t.challenges.void[1]>=1;if(e===8)return t.challenges.void[1]>=2;if(e===9)return t.challenges.void[4]>=2}else if(n===2){if(e===7)return t.challenges.void[1]>=3;if(e===8)return t.challenges.void[2]>=1;if(e===9)return t.challenges.void[2]>=2}else if(n===3){if(e===8)return t.challenges.void[4]>=4;if(e===9)return t.challenges.void[5]>=2}else if(n===4){if(e===8)return t.challenges.void[4]>=3;if(e===9)return t.challenges.void[5]>=1}else if(n===5){if(e===4)return t.challenges.void[4]>=1;if(e===8)return t.challenges.void[3]>=5;if([0,1,5,7].includes(e))return t.strangeness[5][3]>=1}return!0}if((n===1||n===2)&&e<6||(n===3||n===4)&&e<7)return!0;if(t.milestones[4][0]<8)return!1;if(n===5){if(e===2)return t.milestones[5][0]>=8;if(e===4)return t.milestones[4][1]>=8;if([0,1,3,5].includes(e))return t.milestones[2][0]>=7||t.milestones[3][0]>=7}return!0;case"inflation":return t.stage.true>=7}return!1},Ee=(e,n,s)=>{switch(s){case"structures":if(n===5)return e!==3;if(n===6)return e<1;break;case"upgrades":if(n===1)return e!==5;if(n===2)return e!==2;if(n===4)return!1;if(n===5)return e!==3;break;case"researches":if(n===1)return e!==3;break;case"researchesExtra":if(n===1)return e!==2;if(n===2)return e>1;if(n===4||n===5)return e!==0;break;case"elements":return![26,29,30].includes(e)}return!0},Tt=(e,n)=>{if(n===1){if(e===0)return t.buildings[1][0].total;if(e===1)return t.discharge.energy}else if(n===2){if(e===0)return t.buildings[2][1].total;if(e===1)return t.buildings[2][2].current}else if(n===3){if(e===0)return t.buildings[3][0].total;if(e===1)return t.buildings[3][4].true}else if(n===4){if(e===0)return t.buildings[4][0].total;if(e===1)return r.collapseInfo.newMass}else if(n===5){if(e===0)return r.collapseInfo.trueStars;if(e===1)return t.buildings[5][3].true}throw new TypeError(`Milestone s${n}-i${e} doesn't exist`)},Dt=(e,n)=>{let s=r.milestonesInfo[n];return t.inflation.vacuum||s.max[e]<=t.milestones[n][e]||t.stage.true<7&&t.stage.resets<4||n===5&&t.milestones[4][e]<8||t.inflation.tree[4]<1&&s.time[e]/(t.inflation.tree[0]>=1?4:1)<t.time.stage?!1:s.need[e].lessOrEqual(Tt(e,n))};var Te=(e,n)=>{let{dischargeInfo:s}=r,{energyStage:o,energyType:i}=s,{buildings:c,discharge:f}=t;if(e==="galaxy"){let{elements:l}=t;for(let u=1;u<w.elements.length;u++)Ee(u,4,"elements")&&(l[u]=0,de(u,4,"elements"));Ce(),t.collapse.mass=.01235,t.collapse.stars=[0,0,0]}let g=0;for(let l of n){l===2?(r.vaporizationInfo.trueResearch0=0,r.vaporizationInfo.trueResearch1=0,r.vaporizationInfo.trueResearchRain=0):l===4&&(r.collapseInfo.trueStars=0),g+=o[l],o[l]=0;let u=c[l];u[0].current.setValue(w.buildings[l][0].current),u[0].total.setValue(w.buildings[l][0].current);for(let S=1;S<r.buildingsInfo.maxActive[l];S++){if(!Ee(S,l,"structures")){if(!t.inflation.vacuum)continue;let T=i[l][S]*u[S].true;o[l]+=T,g-=T;continue}u[S].true=0,u[S].current.setValue("0"),u[S].total.setValue("0")}if(e==="discharge")continue;let m=t.upgrades[l];for(let S=0;S<r.upgradesInfo[l].maxActive;S++)Ee(S,l,"upgrades")&&(m[S]=0,de(S,l,"upgrades"));if(Me(l),e==="vaporization")continue;let h=t.researches[l];for(let S=0;S<r.researchesInfo[l].maxActive;S++)Ee(S,l,"researches")&&(h[S]=0,D(S,l,"researches"),pe(S,l,"researches"));if(le("researches",l),e==="rank")continue;let b=t.researchesExtra[l];for(let S=0;S<r.researchesExtraInfo[l].maxActive;S++)Ee(S,l,"researchesExtra")&&(b[S]=0,D(S,l,"researchesExtra"),pe(S,l,"researchesExtra"));le("researchesExtra",l),t.stage.active===4&&Ie()}if(t.inflation.vacuum){let l=s.energyTrue-f.energy-g;for(let u=2;u<=5;u++){if(n.includes(u))continue;let m=c[u];for(let h=r.buildingsInfo.maxActive[u]-1;h>=1;h--)if(Ee(h,u,"structures")){if(l>0){let b=Math.min(Math.ceil(l/i[u][h]),m[h].true);b>0&&(m[h].true-=b,l-=b*i[u][h],o[u]-=b*i[u][h],u===4&&(r.collapseInfo.trueStars-=b))}m[h].current.setValue(m[h].true),m[h].total.setValue(m[h].true)}u!==5&&(m[0].current.setValue(w.buildings[u][0].current),m[0].total.setValue(w.buildings[u][0].current)),u===2&&(r.vaporizationInfo.trueResearch0=0,r.vaporizationInfo.trueResearch1=0,r.vaporizationInfo.trueResearchRain=0,ke())}f.energy+=l,s.energyTrue=f.energy}else e==="discharge"&&(f.energy=0,s.energyTrue=0);Q(),!r.paused&&n.includes(t.stage.active)&&(ue(),J())},Le=(e,n="normal",s=!0)=>{for(let o of e){let i=t.buildings[o],c=w.buildings[o][0].current;if(i[0].current.setValue(c),i[0].total.setValue(c),i[0].trueTotal.setValue(c),o!==6){for(let f=1;f<r.buildingsInfo.maxActive[o];f++)i[f].true=0,i[f].current.setValue("0"),i[f].total.setValue("0"),i[f].trueTotal.setValue("0");r.dischargeInfo.energyStage[o]=0}if(t.upgrades[o]=B(w.upgrades[o]),t.researches[o]=B(w.researches[o]),t.researchesExtra[o]=B(w.researchesExtra[o]),Me(o),r.lastUpgrade[o][0]=null,o===1)t.strangeness[1][5]<1&&(t.ASR[1]=0),t.discharge.current=0,t.discharge.energy=0,r.dischargeInfo.energyTrue=0;else if(o===2)t.strangeness[2][5]<1&&(t.ASR[2]=0),t.vaporization.clouds.setValue("0");else if(o===3)t.strangeness[3][5]<1&&(t.ASR[3]=0),t.inflation.vacuum?t.accretion.rank=1:(t.accretion.rank=0,i[0].current.setValue("5.9722e27"));else if(o===4){t.strangeness[4][5]<1&&(t.ASR[4]=0),r.collapseInfo.trueStars=0,t.collapse.mass=.01235,t.collapse.stars=[0,0,0],t.elements=B(w.elements),t.elements[0]=t.strangeness[4][8]>=1?1:0,Ce();for(let f=0;f<w.elements.length;f++)de(f,4,"elements");r.lastElement=null}else o===5&&(t.strangeness[5][5]<1&&(t.ASR[5]=0),t.merge.reward=[0],t.merge.resets=0)}t.stage.active===4&&Ie();for(let o of e){for(let i=0;i<r.researchesInfo[o].maxActive;i++)R(i,o,"researches");for(let i=0;i<r.researchesExtraInfo[o].maxActive;i++)R(i,o,"researchesExtra");R(0,o,"ASR"),le("researches",o),le("researchesExtra",o)}if(s){let{strangeness:o,researchesAuto:i}=t;if(t.time.stage=0,t.stage.time=0,t.stage.peak=0,r.debug.timeLimit=!1,i[0]=o[3][6],i[1]=o[4][6],t.inflation.vacuum){i[2]=o[1][4]<1?0:o[3][4]<1?1:o[2][4]<1?2:o[4][4]<1?3:4;for(let c=0;c<w.researchesAuto.length;c++)D(c,0,"researchesAuto")}else i[2]=o[Math.min(t.stage.current,4)][4]>=1?1:0,D(2,0,"researchesAuto")}if(Q(),n!==!1&&(_(ge(r.tab)?r.tab:"stage"),G(n),n==="soft")){let o=t.stage.active;for(let i=0;i<r.upgradesInfo[o].maxActive;i++)de(i,o,"upgrades")}},Je=()=>{let e=r.milestonesInfoS6.active;for(let n=1;n<=6;n++){let s=t.buildings[n],o=w.buildings[n][0].current;if(s[0].current.setValue(o),s[0].total.setValue(o),s[0].trueTotal.setValue(o),n!==6){for(let i=1;i<w.buildings[n].length;i++)s[i].true=0,s[i].current.setValue("0"),s[i].total.setValue("0"),s[i].trueTotal.setValue("0");r.dischargeInfo.energyStage[n]=0,t.strangeness[n]=B(w.strangeness[n]),t.milestones[n]=B(w.milestones[n]),t.ASR[n]=0}t.upgrades[n]=B(w.upgrades[n]),t.researches[n]=B(w.researches[n]),t.researchesExtra[n]=B(w.researchesExtra[n])}t.researchesAuto=B(w.researchesAuto),t.discharge.energy=0,t.discharge.energyMax=0,t.discharge.current=0,r.dischargeInfo.energyTrue=0,t.vaporization.clouds.setValue("0"),t.vaporization.cloudsMax.setValue("0"),t.inflation.vacuum?t.accretion.rank=1:(t.accretion.rank=0,t.buildings[3][0].current.setValue("5.9722e27")),r.collapseInfo.trueStars=0,t.collapse.mass=.01235,t.collapse.massMax=.01235,t.collapse.stars=[0,0,0],t.elements=B(w.elements),t.merge.resets=0,t.merge.reward=[0],t.challenges.void=B(w.challenges.void),t.challenges.active=null,r.historyStorage.stage=[],t.history.stage.best=[31556952e9,0,0,0],r.strangeInfo.bestHistoryRate=0,t.stage.current=1,t.stage.resets=0,t.stage.peak=0,t.stage.time=0,t.time.stage=0;for(let n=0;n<w.strange.length;n++)t.time.export[n+1]=0,t.strange[n].current=0,t.strange[n].total=0;e[0]&&(t.strange[0].current=t.buildings[6][1].true,t.strange[0].total=t.buildings[6][1].true,t.strangeness[1][8]=2),e[1]&&(t.strangeness[5][4]=1),e[2]&&(t.strangeness[3][6]=3,t.strangeness[4][6]=2,t.researchesAuto[0]=3,t.researchesAuto[1]=2),Q(),X[1](),X[0](),$e(),Ye();for(let n=1;n<=5;n++){for(let s=0;s<r.researchesInfo[n].maxActive;s++)R(s,n,"researches");for(let s=0;s<r.researchesExtraInfo[n].maxActive;s++)R(s,n,"researchesExtra");R(0,n,"ASR"),e[1]&&(t.ASR[n]=r.ASRInfo.max[n],t.strangeness[n][5]=1);for(let s=0;s<r.strangenessInfo[n].maxActive;s++)R(s,n,"strangeness");for(let s=0;s<w.milestones[n].length;s++)Ge(s,n)}for(let n=0;n<w.researchesAuto.length;n++)R(n,0,"researchesAuto");G("reload")};var ve=e=>{let{buildings:n}=w,{buildingsInfo:s,upgradesInfo:o,researchesInfo:i,researchesExtraInfo:c,strangenessInfo:f}=r,g=C("#star3Effect > span:last-of-type"),l,u,m,h,b,S,T,E,k,I,$,N,H,q;if(e)a("mergeResetText").innerHTML='<span class="darkvioletText">Merge</span> does a <span class="grayText">Galaxy</span> reset, while also converting self-made <span class="grayText">Galaxies</span> into non self-made.',M.footerStatsHTML[1][0]=["Energy%20mass.png","stage1borderImage cyanText","Mass"],s.hoverText[2][0]="Tritium",s.hoverText[3][0]="Preons hardcap",n[1][0].current.setValue("5.476e-3"),n[2][0].current.setValue("0"),n[3][0].current.setValue("9.76185667392e-36"),l=[6,7,6,6],s.name[1][0]!=="Mass"&&(M.buildingHTML[1].unshift("Preon.png","Quarks.png"),s.name[1].unshift("Mass","Preons"),s.hoverText[1].unshift("Mass","Preons")),s.startCost[1]=[0,.005476,6,3,24,3],s.type[2][0]="improving",s.type[3][0]="delaying",g.textContent="Boost to Solar mass gain and delay to Preons hardcap",u=[40,60,100,120,180,360,1200,3600,12e3,8e4],o[2].startCost[0]=10,o[5].startCost[3]=1e160,o[2].maxActive=9,o[4].maxActive=5,m=[1600,4800,16e3,32e3,16e3,24e3],h=[400,1200,8e3,4e4,16e3,16e3],i[2].scaling[2]=100,i[2].scaling[3]=1e3,i[4].maxActive=6,c[1].maxActive=5,c[2].maxActive=4,c[3].maxActive=5,c[4].maxActive=4,r.elementsInfo.startCost[27]=1e54,r.elementsInfo.startCost[28]=1e58,r.ASRInfo.costRange[1]=[2e3,8e3,16e3,32e3,56e3],r.ASRInfo.costRange[3][3]=245576045e23,b=[1,1,1,2,12,2,24],S=[2.46,2,6,6,400,1,1],T=[1,1,2,2,12,4,24],E=[2.46,2,3,3.4,800,1,1],k=[1,2,2,24,12,4,4,24],I=[2,3.4,3,1,100,1,1.74,1],$=[1,2,4,2,12,6,6,24],N=[2,3.4,3,6,1900,1,1.74,1],H=[24,36,6,24,15600,24,96,120],q=[2,2,3.4,1,1,1,1,1],f[1].maxActive=10,f[2].maxActive=10,f[3].maxActive=10,f[4].maxActive=10,f[5].maxActive=9,C("#toggleAuto0Main label > span").textContent="Stage",C("#stageHistory > h3").textContent="Stage resets:",a("preonCap").style.display="",a("molesProduction").style.display="",a("massProduction").style.display="",a("dustCap").style.display="",a("mainCapS5").style.display="",a("element0").style.display="",a("strangeletsEffect1Allowed").style.display="",a("strange7Stage1").style.display="",a("strange7Stage2").style.display="",a("strange8Stage3").style.display="",a("strange8Stage4").style.display="",a("strange3Stage5").style.display="",a("strange4Stage5").style.display="",a("collapseCapped").style.display="",a("strangeletsEffect1Disabled").style.display="none",a("stageInstant").style.display="none";else{M.footerStatsHTML[1][0]=["Quarks.png","stage1borderImage cyanText","Quarks"],s.hoverText[2][0]="Moles",s.hoverText[3][0]="Mass",n[1][0].current.setValue("3"),n[2][0].current.setValue("2.7753108348135e-3"),n[3][0].current.setValue("1e-19"),s.name[1][0]==="Mass"&&(M.buildingHTML[1].splice(0,2),s.name[1].splice(0,2),s.hoverText[1].splice(0,2)),l=[4,6,5,5],s.startCost[1]=[0,3,24,3],s.type[2][0]="producing",s.type[3][0]="producing",g.textContent="Boost to Solar mass gain",u=[0,0,12,36,120,240,480,1600,3200,20800],o[2].startCost[0]=1e4,o[5].startCost[3]=1e150,o[1].maxActive=10,o[2].maxActive=8,o[3].maxActive=13,o[4].maxActive=4,o[5].maxActive=4,m=[600,2e3,4e3,4e3,6e3,6e3],h=[200,400,2e3,12e3,4e3,6e3],i[2].scaling[2]=1e3,i[2].scaling[3]=100,i[1].maxActive=6,i[2].maxActive=6,i[3].maxActive=9,i[4].maxActive=5,i[5].maxActive=2,c[1].maxActive=0,c[2].maxActive=3,c[3].maxActive=4,c[4].maxActive=3,c[5].maxActive=1,r.elementsInfo.startCost[27]=1e52,r.elementsInfo.startCost[28]=1e54,r.ASRInfo.costRange[1]=[2e3,8e3,16e3],r.ASRInfo.costRange[3][3]=2e30,b=[1,1,1,2,4,2,24],S=[1,.75,1.5,3,0,0,0],T=[1,1,2,2,4,2,24],E=[.5,.75,2,2,0,0,0],k=[1,1,2,6,4,2,6,24],I=[.75,1.5,2,0,0,0,3,0],$=[1,1,3,2,4,2,4,24],N=[1,2,2.5,2,0,0,68,0],H=[20,24,240,24,6e3,24,20,120],q=[20,24,240,0,0,0,220,0],f[1].maxActive=7,f[2].maxActive=7,f[3].maxActive=8,f[4].maxActive=8,f[5].maxActive=8,C("#toggleAuto0Main label > span").textContent="Interstellar Stage",C("#stageHistory > h3").textContent="Interstellar Stage resets:",a("strange8Stage5").style.display="",a("milestonesProgressArea").style.display="",a("stageInstant").style.display="",a("rankStat0").style.display="",a("preonCap").style.display="none",a("molesProduction").style.display="none",a("massProduction").style.display="none",a("dustCap").style.display="none",a("submersionBoost").style.display="none",a("mainCap").style.display="none",a("mainCapS5").style.display="none",a("mergeEffects").style.display="none",a("researchAuto1").style.display="none",a("researchAuto2").style.display="none",a("collapseCapped").style.display="none",a("element0").style.display="none";for(let O=1;O<f.length;O++)for(let F=f[O].maxActive+1;F<=f[O].startCost.length;F++)a(`strange${F}Stage${O}`).style.display="none";a("energyGainStage1Build1Name").style.display="none",a("energyGainStage1Build2Name").style.display="none",a("energyGainStage1Build1").style.display="none",a("energyGainStage1Build2").style.display="none";for(let O=2;O<=5;O++)a(`energyGainStage${O}`).style.display="none"}s.maxActive.splice(1,l.length,...l),o[1].startCost.splice(0,u.length,...u),i[1].startCost.splice(0,m.length,...m),i[1].scaling.splice(0,h.length,...h),f[1].startCost.splice(0,b.length,...b),f[1].scaling.splice(0,S.length,...S),f[2].startCost.splice(0,T.length,...T),f[2].scaling.splice(0,E.length,...E),f[3].startCost.splice(0,k.length,...k),f[3].scaling.splice(0,I.length,...I),f[4].startCost.splice(0,$.length,...$),f[4].scaling.splice(0,N.length,...N),f[5].startCost.splice(0,H.length,...H),f[5].scaling.splice(0,q.length,...q),v.SRSettings[0]&&(g.textContent=` (${g.textContent})`);for(let O=1;O<=3;O++){let F=n[O][0].current;n[O][0].total.setValue(F),n[O][0].trueTotal.setValue(F)}},Vt=()=>{t.inflation.vacuum||(t.stage.true>=7?(t.cosmon.current+=1,t.cosmon.total+=1,r.historyStorage.vacuum.unshift([t.time.universe,!1,1]),r.historyStorage.vacuum.length>100&&(r.historyStorage.vacuum.length=100),1/t.time.universe>t.history.vacuum.best[2]/t.history.vacuum.best[0]&&(t.history.vacuum.best=[t.time.universe,!1,1])):(t.stage.true=6,t.collapse.show=0,ce(6)),(t.toggles.normal[0]&&r.tab!=="inflation"||t.stage.active!==6)&&Z(1),t.inflation.vacuum=!0,t.inflation.resets++,ve(!0),Je())};var y={dischargeBase:(e=t.researches[1][4])=>{let n=(4+e)/2;return t.challenges.active===0&&(n**=.5),n},S1Upgrade6:()=>10+3*t.researches[1][0],S1Upgrade7:(e=!1)=>{let n=2+t.researches[1][1];return e&&(n*=1.6),(n+100)/100},S1Research2:()=>20+t.strangeness[1][1]*(t.inflation.vacuum?1.5:1),S1Research5:()=>{let e=r.dischargeInfo.total;return t.inflation.vacuum?e>7?e+14:e*3:e>5?e+15:e*4},S1Extra1:(e=t.researchesExtra[1][1])=>e>=4?1.1:e>=3?1.2:(20-3*e)/10,S1Extra3:(e=t.researchesExtra[1][3])=>e/20,S1Extra4:()=>(100+r.dischargeInfo.base+Math.max(t.discharge.energy,1)**.1)/100,clouds:(e=!1)=>{let n=new p(t.vaporization.clouds).plus("1");return e&&n.plus(r.vaporizationInfo.get),n.moreThan("1e4")&&n.minus("1e4").power(.7).plus("1e4"),n},S2Upgrade1:()=>{let e=t.buildings[2][2],n=Math.min(e.true,200);return new p("1.02").power((e.current.toNumber()-n)**.7+n)},S2Upgrade2:()=>1e10/(t.inflation.vacuum?2.5:2)**t.strangeness[2][3],S2Upgrade3:(e=t.researches[2][2])=>(1+e/2)/100,S2Upgrade4:(e=t.researches[2][3])=>(1+e/2)/100,S2Upgrade5:()=>1+t.researches[2][4],S2Upgrade6:()=>1+t.researches[2][5],S2Extra1:(e,n=!1)=>{if(e<=0)return 1;let s=new p(t.vaporization.clouds);return n&&s.plus(r.vaporizationInfo.get),Math.max(new p(s).power(e/60).multiply(s.min("1e6").power(e/30)).toNumber(),1)},S2Extra2:(e,n=t.researchesExtra[2][2])=>n>=1?(e-1)/32+1:1,submersion:()=>{let e=new p(t.buildings[2][1].current).plus("1");return new p(e).power(.6).divide(e.min("1e10").power(.4)).plus("1").log(2).toNumber()},S3Upgrade0:()=>(101+t.researches[3][1])/100,S3Upgrade1:(e=t.researchesExtra[3][3])=>{let n=(11+e)/100;return Math.max(new p(t.buildings[3][1].current).power(n).multiply((t.buildings[3][1].true+1)**n).toNumber(),1)},S3Upgrade3:()=>(204+t.researches[3][4])/200,S3Research6:(e=t.researches[3][6])=>{let n=new p(t.buildings[3][0].current).max("1");return new p(n).power(e/120).multiply(n.min("1e21").power(e/60)).toNumber()},S3Extra1:(e=t.researchesExtra[3][1])=>(100+11*e)/100,S3Extra4:(e=t.researchesExtra[3][4])=>e>0?8**((t.accretion.rank+e)/8):1,mass:(e=!1)=>{let n=t.collapse.mass;return e&&r.collapseInfo.newMass>n&&(n=r.collapseInfo.newMass),n>1&&(t.elements[21]>=1&&(n**=1.1),t.challenges.active===0&&(n**=.2)),n},star:[(e=!1)=>{let n=t.collapse.stars[0]+1;return e&&(n+=r.collapseInfo.starCheck[0]),t.elements[27]>=1&&(n+=t.buildings[4][3].true),t.elements[6]>=1&&(n**=y.element6()),n},(e=!1)=>{let n=t.collapse.stars[1]*(1+t.strangeness[4][8]);e&&(n+=r.collapseInfo.starCheck[1]*(1+t.strangeness[4][8]),t.elements[22]>=1&&(n+=r.collapseInfo.starCheck[0])),t.elements[22]>=1&&(n+=t.collapse.stars[0]);let s=(n+1)**(.5+t.strangeness[4][8]/8);return t.elements[12]>=1&&(s*=We(n+4,4)),s},(e=!1)=>{let n=t.collapse.stars[2];e&&(n+=r.collapseInfo.starCheck[2]);let s=t.elements[18]>=1?3:2;return(n+1)/We(n+s,s)}],S4Research0_base:(e=t.researches[4][2])=>(14+e)/10,S4Research0:e=>{let n=t.researches[4][0];return t.elements[19]>=1&&n++,e**n},S4Research1:(e=t.researches[4][1],n=t.researchesExtra[4][1])=>{let s=e>0?1+Math.min(e,4):0;return e>4&&(s+=.5),e>5&&(s+=Math.min(e-5,2)/4),e>7&&(s+=(e-7)/8),1+(n>=1?.006:.005)*s},S4Research4:(e=!1,n=t.researches[4][4])=>{if(n<1)return 1;let s=t.collapse.stars[2],o=t.collapse.mass;e&&(s+=r.collapseInfo.starCheck[2],r.collapseInfo.newMass>o&&(o=r.collapseInfo.newMass));let i=n>=2?2:3,c=We(s+i,i);return t.elements[23]>=1&&o>1&&(c*=o**.1),c},S4Extra1:()=>(10+t.researches[4][1])/10,reward:[()=>t.merge.reward[0]+1],S5Upgrade0:()=>3*(t.inflation.vacuum?1.6:1.8)**t.strangeness[5][1],S5Upgrade1:()=>2*(t.inflation.vacuum?1.6:1.8)**t.strangeness[5][1],S5Upgrade2:(e=!1,n=t.upgrades[5][2])=>{if(n<1)return 0;let s=t.collapse.mass;return e&&r.collapseInfo.newMass>s&&(s=r.collapseInfo.newMass),s=Math.log10(Math.max(s/1e5,1))/4+.25,t.inflation.vacuum||(s*=2),Math.min(s,1)},element6:()=>t.researchesExtra[4][2]>=1?2:1.5,element24:()=>t.elements[27]>=1?.02:.01,element26:()=>{if(t.stage.true<6&&t.strange[0].total<1)return 0;let e=new p(t.buildings[4][0].trueTotal).log(10).toNumber()-48;return t.elements[29]>=1&&(e=(199+e)*e/200),Math.max(e,0)},S2Strange9:()=>new p(t.vaporization.clouds).plus("1").log(10).toNumber()/80+1,inflation1:(e=t.inflation.tree[1])=>new p(t.buildings[6][0].current).plus("1").power(e/32).toNumber(),strangeGain:(e,n=0)=>{if(n===1&&e<4)return 0;let s=n===1?0:t.inflation.vacuum?t.strangeness[5][3]>=1?5:4:t.milestones[1][0]>=6?2:1;return e>=4&&(s=(s+y.element26())*(t.buildings[5][3].current.toNumber()+1),t.inflation.vacuum&&t.strangeness[2][9]>=1&&(s*=y.S2Strange9())),n===0?s*=1.4**t.strangeness[5][2]*1.4**t.inflation.tree[2]:n===1&&(t.inflation.tree[3]>=1&&t.strangeness[5][8]>=1&&(s*=1.4**t.strangeness[5][2]),t.inflation.tree[3]>=2&&(s*=1.4**t.inflation.tree[2])),s*r.strangeInfo.strangeletsInfo[1]}},Q=()=>{let{buildings:e,upgrades:n,researches:s,researchesExtra:o,elements:i,strangeness:c}=t,{dischargeInfo:f}=r,g=r.buildingsInfo.producing,l=r.strangeInfo.stageBoost,u=r.stageInfo.activeAll,m=t.inflation.vacuum,h=t.challenges.active===0,b=Math.max(t.discharge.energy,1),S=n[2][3]===1?new p(e[2][0].current).max("1").power(y.S2Upgrade3()).toNumber():1,T=n[2][4]===1?new p(e[2][1].current).max("1").power(y.S2Upgrade4()).toNumber():1;if(u.includes(1)){let E=m?3:1,k=m?4:2,I=m?5:3;f.total=t.discharge.current+c[1][3]/2,f.base=y.dischargeBase();let $=(m?2:1.8)**c[1][0];n[1][5]===1&&($*=f.base**f.total),c[1][6]>=1&&($*=l[1]),h&&($/=4);let N=y.S1Upgrade7(),H=[e[1][I].current],q=.2*$;n[1][4]===1&&(q*=4),n[1][7]===1&&H.push(new p(N).power(e[1][I].true)),g[1][I].setValue(q).multiply(...H);let O=y.S1Research2()**s[1][2]*y.S1Research5()**s[1][5];n[1][9]===1&&(O*=b**.5),f.tritium.setValue(g[1][I]).plus("1").log(y.S1Extra1()).multiply(O);let F=[e[1][k].current],ze=(m?.8:.4)*$;n[1][3]===1&&(ze*=m?6:4),n[1][7]===1&&F.push(new p(N).power(e[1][k].true)),g[1][k].setValue(ze).multiply(...F);let Fe=[e[1][E].current],we=(m?.2:1.6)*$;if(n[1][0]===1&&(we*=8),n[1][7]===1&&Fe.push(new p(N).power(e[1][E].true)),g[1][E].setValue(we).multiply(...Fe),m){let x=[e[1][2].current];n[1][7]===1&&x.push(new p(N).power(e[1][2].true)),g[1][2].setValue(.4*$).multiply(...x);let z=[],ie=new p(e[1][1].current).minus(e[1][1].true);if(ie.moreThan("1")?z.push(ie.power(.11).plus(e[1][1].true)):z.push(e[1][1].current),n[1][7]===1){let Bt=y.S1Upgrade7(!0);z.push(new p(N/Bt).power((e[1][1].true-1)/1e3).multiply(Bt).power(e[1][1].true))}g[1][1].setValue(6e-4*$).multiply(...z)}}if(u.includes(2)){let{vaporizationInfo:E}=r;E.trueResearchRain!==o[2][1]&&(E.trueResearchRain=o[2][2]>=1?o[2][1]:Math.min(o[2][1],new p(e[2][1].total).divide(1e12/999).plus("1").log(1e3).toNumber()));let k=y.S2Extra1(E.trueResearchRain),I=1.24**c[2][7];if(e[2][6].true>=1?g[2][6].setValue(n[2][8]===1?"1.1":"1.08").power(e[2][6].true).multiply(I):g[2][6].setValue("1"),g[2][5].setValue(2*y.S2Extra2(k)*I).multiply(e[2][5].current,g[2][6]).max("1"),g[2][4].setValue(2*I).multiply(e[2][4].current,g[2][5]).max("1"),g[2][3].setValue(2*I).multiply(e[2][3].current,g[2][4]).max("1"),E.trueResearch1!==s[2][1]&&(E.trueResearch1=Math.min(s[2][1],new p(e[2][1].total).divide("1e2").plus("1").log(5).toNumber())),e[2][2].current.lessThan("1"))g[2][2].setValue(y.S2Extra1(o[2][1])-1);else{let H=[e[2][2].current,g[2][3],y.clouds()],q=(h?6e-4:4.8)*S*T*2**E.trueResearch1*k*(m?1.8:1.6)**c[2][1];n[2][1]===1&&H.push(y.S2Upgrade1()),m&&(q*=y.S3Extra4(),i[1]>=1&&(q*=2)),c[2][6]>=1&&(q*=l[2]),g[2][2].setValue(q).multiply(...H)}let $=new p(e[2][1].current);if(h)$.min(1);else if(m){let H=new p($).minus(e[2][1].true);H.moreThan("1")&&$.setValue(H.power(.2).plus(e[2][1].true))}let N=[$];n[2][0]===1&&N.push(new p(m?"1.02":"1.04").power(e[2][1].true)),E.trueResearch0!==s[2][0]&&(E.trueResearch0=Math.min(s[2][0],Math.max(new p(e[2][1].total).divide("1e1").log(1.366).toNumber()+1,new p(e[2][1].total).divide(10/.366).plus("1").log(1.366).toNumber()))),g[2][1].setValue((m?2:8e-4)*3**E.trueResearch0*2**c[2][0]).multiply(...N)}else m&&g[2][1].setValue("1");if(u.includes(3)){let{accretionInfo:E}=r,k=(m?1.48:1.6)**c[3][1];g[3][5].setValue("1.1").power(e[3][5].true),g[3][4].setValue(n[3][12]===1?"1.14":"1.1").power(e[3][4].true).multiply(g[3][5]);let I=c[3][3]<1?new p("1"):new p(g[3][4]).power(m?.1:.2),$=[e[3][3].current,g[3][4]],N=.4*k;o[3][2]>=1&&(N*=2),n[3][7]===1&&$.push(new p("1.02").power(e[3][3].true)),g[3][3].setValue(N).multiply(...$);let H=[e[3][2].current,I],q=3**s[3][2]*k;n[3][3]===1&&H.push(new p(y.S3Upgrade3()).power(e[3][2].true)),n[3][4]===1&&(q*=3),s[3][6]>=1&&(q*=y.S3Research6()),g[3][2].setValue(q).multiply(...H);let O=[e[3][1].current,I],F=(m?2:8e-20)*3**s[3][0]*2**s[3][3]*3**s[3][5]*1.11**o[3][0]*y.S3Extra1()**t.accretion.rank*1.8**c[3][0];m&&(F*=y.submersion(),i[4]>=1&&(F*=1.4),i[14]>=1&&(F*=1.4)),n[3][0]===1&&O.push(new p(y.S3Upgrade0()).power(e[3][1].true)),n[3][1]===1&&(F*=y.S3Upgrade1()),n[3][2]===1&&(F*=2),n[3][5]===1&&(F*=3),n[3][6]===1&&(F*=2*1.5**s[3][7]),n[3][9]===1&&(F*=2),n[3][10]===1&&(F*=8*2**s[3][8]),g[3][1].setValue(F).multiply(...O),h?E.dustSoft=t.accretion.rank>=5?.8:.9:t.accretion.rank>=5?E.dustSoft=m||g[3][1].moreThan("1")?.9:1.1:E.dustSoft=1,g[3][1].power(E.dustSoft)}else m&&g[3][1].setValue("1");if(u.includes(4)){let{collapseInfo:E}=r;E.neutronEffect=y.star[1]();let k=y.mass(),I=[new p(y.S4Research1()).power(E.trueStars)],$=y.S4Research0(y.S4Research0_base())*k*E.neutronEffect*y.S4Research4()*1.6**c[4][0];i[4]>=1&&($*=1.4),i[14]>=1&&($*=1.4),i[24]>=1&&($*=new p(e[4][0].current).max("1").power(y.element24()).toNumber()),m&&(o[1][4]>=1&&($*=y.S1Extra4()**f.total),o[2][3]>=1&&($*=S),o[2][3]>=3?$*=T:o[2][3]>=2&&($*=T**.5)),c[4][7]>=1&&($*=l[4]),h&&($/=8e3);let N=new p($).multiply(...I);g[4][5].setValue(h?"0":"2e11").multiply(e[4][5].current,N),g[4][4].setValue("6e9").multiply(e[4][4].current,N),g[4][3].setValue("6e7").multiply(e[4][3].current,N),g[4][2].setValue(1200*y.star[0]()*2**s[4][3]).multiply(e[4][2].current,N);let H=40;i[1]>=1&&(H*=2),i[19]>=1&&k>1&&(H*=k),g[4][1].setValue(H).multiply(e[4][1].current,N)}if(u.includes(5)){let E=g[5][2],k=(m?2:6)+y.S5Upgrade2();g[5][3].setValue(k).power(e[5][3].true);let I=e[5][3].current.toNumber();I>0&&g[5][3].multiply((I+1)/(e[5][3].true+1)*y.reward[0]()),r.mergeInfo.galaxyBase=k;let $=(m?1.4:1.6)**t.strangeness[5][0],N=[e[5][2].current,g[5][3]],H=2*2**s[5][1]*$;n[5][1]===1&&(H*=y.S5Upgrade1()),E.setValue(H).multiply(...N).max("1");let q=[e[5][1].current,g[5][3]],O=6*2**s[5][0]*$;n[5][0]===1&&(O*=y.S5Upgrade0()),g[5][1].setValue(O).multiply(...q),m?(g[4][5].multiply(E),s[5][1]>=1&&E.moreThan("2")&&g[4][4].multiply(E).divide("2"),s[5][1]>=2&&E.moreThan("4")&&g[4][3].multiply(E).divide("4"),s[5][1]>=3&&E.moreThan("8")&&g[4][2].multiply(E).divide("8"),s[5][1]>=4&&E.moreThan("16")&&g[4][1].multiply(E).divide("16")):(g[4][4].multiply(E),s[5][1]>=1&&E.moreThan("2")&&g[4][3].multiply(E).divide("2"),s[5][1]>=2&&E.moreThan("4")&&g[4][2].multiply(E).divide("4"),s[5][1]>=3&&E.moreThan("8")&&g[4][1].multiply(E).divide("8"))}if(u.includes(6)&&(e[6][1].current.moreThan("0")?g[6][1].setValue(e[6][1].current).power(e[6][1].true):g[6][1].setValue("0")),m){let E=r.inflationInfo,k=b**y.S1Extra3();E.preonTrue.setValue(g[1][1].multiply(k)),E.dustTrue.setValue(g[3][1].max("1")),f.tritium.multiply(g[2][1].max("1"));let I=_t();E.dustCap.setValue((t.accretion.rank>=5?1e48:8e46)*I*1.4**c[3][8]),g[3][1].moreThan(E.dustCap)&&g[3][1].setValue(E.dustCap);let $=y.star[2]();i[10]>=1&&($*=2),o[4][1]>=1&&($*=y.S4Extra1()),E.preonCap.setValue(1e14*k*$).multiply(g[3][1]),g[1][1].moreThan(E.preonCap)&&g[1][1].setValue(E.preonCap),E.massCap=.01235*I*$,c[5][7]>=1&&(E.massCap*=l[5])}},ne=(e,n=t.stage.active,s=null,o=!1)=>{if(!Pt(e,n)||!o&&r.paused)return;let i=t.buildings[n][e],c,f,g=!1,l=!0,u="";n===1?(c=t.buildings[1][e-1],e===1&&t.inflation.vacuum&&(g=t.researchesExtra[1][2]>=1&&t.strangeness[1][8]>=1)):n===2?e===1&&t.inflation.vacuum?(u="Moles",c=t.buildings[1][5],f=new p(c.current).divide("6.02214076e23")):c=t.buildings[2][e===1?0:1]:n===3?t.inflation.vacuum?(u="Mass",c=t.buildings[1][0],f=new p(c.current).multiply("1.78266192e-33")):c=t.buildings[3][0]:n===6?(c=t.buildings[6][e-1],f=t.merge.reward[0],u="Universe",l=!1):(c=t.buildings[4][0],n===5&&e===3&&(u="Galaxy",f=t.collapse.mass,l=!1)),f===void 0&&(f=new p(c.current));let m=new p(f);o&&i.true>=1&&!g&&l&&(u==="Mass"&&t.strangeness[1][8]>=2&&r.inflationInfo.dustTrue.moreOrEqual(r.inflationInfo.dustCap)?m.minus(r.inflationInfo.massCap*198847e28):m.divide(t.stage.true>=3?t.toggles.shop.wait[n]:"2"));let h=Se(e,n);if(h.moreThan(m))return;let b=1;if(s===null&&(s=r.hotkeys.shift?1:r.hotkeys.ctrl?10:t.toggles.shop.input),s!==1&&l){let S=r.buildingsInfo.increase[n][e];if(g){if(b=Math.floor(m.divide(h).log(S).toNumber())+1,s>0){if(b<s)return;b=s}}else{if(b=Math.floor(m.multiply(S-1).divide(h).plus("1").log(S).toNumber()),s>0){if(b<s)return;b=s}b>1&&h.multiply(new p(S).power(b).minus("1").divide(S-1))}}if(i.true+=b,i.current.plus(b),i.total.plus(b),i.trueTotal.plus(b),typeof f=="object")g||(f.minus(h),u==="Moles"?(c.current=f.multiply("6.02214076e23"),t.buildings[2][0].current.setValue(c.current).divide("6.02214076e23")):u==="Mass"?(c.current=f.divide("1.78266192e-33"),t.buildings[3][0].current.setValue(c.current).multiply("1.78266192e-33")):c.current=f),(t.inflation.vacuum||n===1)&&Ft(b,e,n),n===1?e===5&&t.upgrades[1][8]===0&&t.inflation.vacuum&&t.buildings[2][0].current.setValue(i.current).divide("6.02214076e23"):n===2?e!==1&&ke():n===3?e>=4&&ae(1,3):n===4&&(r.collapseInfo.trueStars+=b),Q(),o||(J(),v.SRSettings[0]&&(a("SRMain").textContent=`Made ${d(b)} '${r.buildingsInfo.name[n][e]}'`));else if(u==="Galaxy")Te("galaxy",t.inflation.vacuum?[1,2,3,4,5]:[4,5]),R(0,4,"researches"),R(1,4,"researches"),R(2,4,"researches"),Ae(5),ae(1,5),!o&&v.SRSettings[0]&&(a("SRMain").textContent=`Caused Galaxy reset to gain ${d(b)} new 'Galaxies'`);else if(u==="Universe"){t.stage.true<7&&(t.stage.true=7),(t.toggles.normal[0]&&r.tab!=="inflation"||t.stage.active!==6)&&Z(1);let S=t.time.universe,T=i.true;t.cosmon.current+=T,t.cosmon.total+=T,t.inflation.vacuum=!1,t.inflation.age=0,t.time.universe=0,t.inflation.resets++;let E=r.milestonesInfoS6,k=E.active.indexOf(!1);if(k>=0)for(let I=k;I<E.requirement.length;I++)E.active[I]=i.current.moreOrEqual(E.requirement[I]);ve(!1),Je(),r.historyStorage.vacuum.unshift([S,!0,T]),r.historyStorage.vacuum.length>100&&(r.historyStorage.vacuum.length=100),T/S>t.history.vacuum.best[2]/t.history.vacuum.best[0]&&(t.history.vacuum.best=[S,!0,T]),!o&&v.SRSettings[0]&&(a("SRMain").textContent=`Caused Universe reset to gain ${d(b)} new 'Universes'`)}},Ft=(e,n,s)=>{let{discharge:o}=t,{dischargeInfo:i}=r,c=i.energyType[s][n]*e;i.energyStage[s]+=c,i.energyTrue+=c,o.energy+=c,o.energyMax<o.energy&&(o.energyMax=o.energy)},Se=(e,n)=>{let s=r.buildingsInfo,o=s.startCost[n][e];if(n===1){let i=140;t.upgrades[1][6]===1&&(i-=y.S1Upgrade6()),s.increase[1][e]=i/100,e===1?!t.inflation.vacuum&&t.upgrades[1][2]===1&&(o/=8):e===3?t.upgrades[1][1]===1&&(o/=16):e===4&&(t.upgrades[1][2]===1&&(o/=8),t.researchesExtra[1][0]>=1&&(o/=16))}else if(n===3)t.strangeness[3][7]>=1&&(o/=r.strangeInfo.stageBoost[3]),e===4&&(s.increase[3][4]=t.upgrades[3][11]===1?5:10);else if(n===4){let i=125+15*e;t.elements[2]>=1&&(i-=10),t.elements[8]>=1&&(i-=5),s.increase[4][e]=i/100,o/=2**t.strangeness[4][1],t.researchesExtra[4][3]>=1&&(o/=r.collapseInfo.neutronEffect),t.elements[13]>=1&&(o/=100)}return new p(s.increase[n][e]).power(t.buildings[n][e].true).multiply(o)},ke=()=>{let e=t.buildings[2],n=t.upgrades[2],s=e[5].true,o=e[4].true,i=e[3].true,c=e[2].true;n[8]===1&&(s+=e[6].true),n[7]===1&&(o+=s),n[6]===1&&(i+=o*y.S2Upgrade6()),n[5]===1&&(c+=i*y.S2Upgrade5()),e[5].current.setValue(s),e[4].current.setValue(o),e[3].current.setValue(i),e[2].current.setValue(c)},ee=(e,n,s)=>{let o=n,i=new p(s);if(n===1&&e===5?(i.multiply(r.dischargeInfo.tritium),t.inflation.vacuum||(e=3)):n===5?(i.multiply(r.buildingsInfo.producing[5][1]).divide(4**e),o=4,e++):(i.multiply(r.buildingsInfo.producing[n][e+1]),n===4&&(e=0)),i.lessOrEqual("0"))return;if(!i.isFinite()){r.debug.errorGain&&(r.debug.errorGain=!1,P(`Error while gaining ${i} '${r.buildingsInfo.name[o][e]}'`),setTimeout(()=>{r.debug.errorGain=!0},6e4));return}let c=t.buildings[o][e];c.current.plus(i),c.total.plus(i),c.trueTotal.plus(i),n===1?t.inflation.vacuum&&(e===0?(t.buildings[3][0].current.setValue(c.current).multiply("1.78266192e-33"),ae(0,3)):e===5&&t.buildings[2][0].current.setValue(c.current).divide("6.02214076e23")):n===3&&e===0&&(t.accretion.rank<5&&c.current.moreThan("1e30")&&c.current.setValue("1e30"),ae(0,3))},X=[()=>{let e=t.inflation.vacuum,n=r.strangeInfo.stageBoost,s=t.strange[0].current+1;n[1]=s**(e?.26:.22),n[2]=s**(e?.22:.18),n[3]=s**(e?.68:.76),n[4]=s**(t.elements[26]>=1?.32:.16),n[5]=s**.06},()=>{let e=r.strangeInfo.strangeletsInfo,n=t.strange[1].current;e[0]=(Math.log2(n+2)-1)/100,e[1]=n**.4/80+1}],dn=e=>{let n=t.strange[0],s=r.strangeInfo.strangeletsInfo[0]*(r.strangeInfo.quarksGain/t.time.stage)*e;if(!(s<=0)){if(!isFinite(s)){r.debug.errorGain&&(r.debug.errorGain=!1,P(`Error while gaining ${s} '${r.strangeInfo.name[0]}'`),setTimeout(()=>{r.debug.errorGain=!0},6e4));return}n.current+=s,n.total+=s,X[0]()}},Gt=()=>{let e=y.inflation1();t.inflation.tree[0]>=1&&(e*=2),r.inflationInfo.globalSpeed=e},te=(e,n,s,o=!1)=>{if(!o&&(!be(e,n,s)||r.paused)){if(s==="researchesAuto"&&t.researchesAuto[e]<r.researchesAutoInfo.max[e]){let f=r.researchesAutoInfo.autoStage[e][t.researchesAuto[e]];f===n||f===4&&n===5||xe(f,n)}return!1}let i=!1,c;if(n===1?(c=new p(t.discharge.energy),t.inflation.vacuum&&(i=t.accretion.rank>=6&&t.strangeness[1][9]>=1)):n===2?c=new p(t.buildings[2][1].current):n===3?c=t.inflation.vacuum?new p(t.buildings[1][0].current).multiply("1.78266192e-33"):new p(t.buildings[3][0].current):n===6?c=new p(t.buildings[6][0].current):c=new p(t.buildings[4][0].current),s==="upgrades"){if(t.upgrades[n][e]>=1)return!1;let f=r.upgradesInfo[n],g=f.startCost[e];if(c.lessThan(g))return!1;t.upgrades[n][e]++,i||c.minus(g),n===2?e>=5&&ke():n===4&&e===1&&r.tab==="upgrade"&&_("upgrade"),!o&&v.SRSettings[0]&&(a("SRMain").textContent=`New upgrade '${f.name[e]}', has been created`)}else if(s==="researches"||s==="researchesExtra"){let f=r[`${s}Info`][n],g=t[s][n];if(g[e]>=f.max[e])return!1;let l=f.cost[e];if(c.lessThan(l))return!1;let u=1;if((o||t.toggles.max[0]&&t.stage.true>=4)&&f.max[e]>1){let m=f.scaling[e];if(n===1)if(i)u=Math.min(Math.floor((c.toNumber()-l)/m+1),f.max[e]-g[e]);else{let h=l-m/2;u=Math.min(Math.floor(((h**2+2*m*c.toNumber())**.5-h)/m),f.max[e]-g[e]),u>1&&(l=u*(u*m/2+h))}else u=Math.min(Math.floor(new p(c).multiply(m-1).divide(l).plus("1").log(m).toNumber()),f.max[e]-g[e]),u>1&&(l=new p(m).power(u).minus("1").divide(m-1).multiply(l).toNumber())}if(g[e]+=u,i||c.minus(l),s==="researches")n===2?e>=4&&ke():n===4&&(e===2||e===3)&&R(0,4,"researches",!0);else if(s==="researchesExtra")if(n===1){if(e===2){let m="soft";t.stage.current<4&&(t.stage.current=t.researchesExtra[1][2]>1?2:3,t.toggles.normal[0]&&t.stage.active<4&&(Z(t.stage.current),m="normal")),G(m),Ae(1)}}else n===4&&(e===2||e===3)&&(R(1,4,"researches",!0),t.stage.active===4&&Ie());!o&&v.SRSettings[0]&&(a("SRMain").textContent=`Level increased ${g[e]>=f.max[e]?"and maxed at":"to"} ${d(g[e])} for '${f.name[e]}' ${s==="researches"?"Stage":["","Energy","Cloud","Rank","Collapse","Galaxy"][t.stage.active]} Research`)}else if(s==="researchesAuto"||s==="ASR"){s==="ASR"&&(e=n);let f=r[`${s}Info`],g=t[s];if(g[e]>=f.max[e])return!1;let l=f.costRange[e][Math.max(g[e]-(s==="researchesAuto"&&e===1&&t.strangeness[4][6]>=1?1:0),0)];if(c.lessThan(l))return!1;if(g[e]++,i||c.minus(l),s==="researchesAuto")if(e===1)for(let u=1;u<w.elements.length&&(u=t.elements.indexOf(.5,u),!(u<1));u++)te(u,4,"elements",!0);else e===2&&t.inflation.vacuum&&(g[e]=Math.max(g[e]<=1&&t.strangeness[3][4]<1?1:g[e]<=2&&t.strangeness[2][4]<1?2:g[e]<=3&&t.strangeness[4][4]<1?3:4,g[e]));!o&&v.SRSettings[0]&&(a("SRMain").textContent=`Level increased ${g[e]>=f.max[e]?"and maxed at":"to"} ${d(g[e])} for '${s==="ASR"?f.name:f.name[e]}' automatization Research`)}else if(s==="elements"){let f=t.elements[e];if(f>=1)return!1;if(f===0){let g=r.elementsInfo.startCost[e];if(c.lessThan(g))return!1;c.minus(g)}else if(!o)return!1;f=t.researchesAuto[1]>=1||f===.5?1:.5,t.elements[e]=f,t.collapse.show<e&&(t.collapse.show=e),f===1&&(e===7||e===16||e===20||e===25||e===28?R(1,4,"researches",!0):e===9||e===17?R(0,4,"researches",!0):e===11?R(2,4,"researches",!0):e===26&&(t.stage.current=5,t.stage.true<5&&(t.stage.true=5,t.events[0]=!1,He()),t.toggles.normal[0]&&t.stage.active===4&&(!t.inflation.vacuum||t.strangeness[5][3]>=1)?(Z(5),G()):G("soft"),X[0](),Ae(5))),!o&&v.SRSettings[0]&&(a("SRMain").textContent=`New Element '${r.elementsInfo.name[e]}' ${t.elements[e]>=1?"obtained":"awaiting activation"}`)}if(!i)if(n===1)t.discharge.energy=Math.round(c.toNumber());else if(n===2){let f=t.buildings[2][1],g=f.true;f.current=c,f.current.lessThan(g)&&t.buildings[2][2].current.lessThan("1")&&(f.true=Math.floor(f.current.toNumber()),t.inflation.vacuum?Ft(f.true-g,1,2):f.current.lessOrEqual("0")&&t.buildings[2][0].current.max("2.7753108348135e-3"))}else n===3?t.inflation.vacuum?(t.buildings[1][0].current=c.divide("1.78266192e-33"),t.buildings[3][0].current.setValue(t.buildings[1][0].current).multiply("1.78266192e-33")):t.buildings[3][0].current=c:n===6?t.buildings[6][0].current=c:t.buildings[4][0].current=c;return Q(),s==="upgrades"||s==="elements"?de(e,n,s):(s!=="researchesAuto"&&s!=="ASR"&&pe(e,n,s),D(e,n,s)),o||J(),!0},Qe=(e,n,s,o=!1)=>{if(!o&&(!be(e,n,s)||r.paused))return!1;if(s==="strangeness"){let i=r.strangenessInfo[n];if(t.strangeness[n][e]>=i.max[e]||t.strange[0].current<i.cost[e])return!1;if(t.strangeness[n][e]++,t.strange[0].current-=i.cost[e],n===1)e===4?t.researchesAuto[2]<1&&(t.inflation.vacuum||t.stage.current===1)&&(t.researchesAuto[2]=t.inflation.vacuum?t.strangeness[3][4]<1?1:t.strangeness[2][4]<1?2:t.strangeness[4][4]<1?3:4:1,D(2,0,"researchesAuto")):e===5?(t.ASR[1]=r.ASRInfo.max[1],D(0,1,"ASR")):e===7&&rt();else if(n===2)e===2?(R(4,2,"researches",!0),R(5,2,"researches",!0)):e===4?(t.inflation.vacuum?t.researchesAuto[2]===2&&t.strangeness[1][4]>=1&&t.strangeness[3][4]>=1:t.researchesAuto[2]<1&&t.stage.current===2)&&(t.researchesAuto[2]=t.inflation.vacuum?t.strangeness[4][4]<1?3:4:1,D(2,0,"researchesAuto")):e===5?(t.ASR[2]=r.ASRInfo.max[2],D(0,2,"ASR")):e===8&&(R(2,2,"researches",!0),R(3,2,"researches",!0));else if(n===3)e===2?(R(0,3,"researchesExtra",!0),R(1,3,"researchesExtra",!0)):e===4?(t.inflation.vacuum?t.researchesAuto[2]===1&&t.strangeness[1][4]>=1:t.researchesAuto[2]<1&&t.stage.current===3)&&(t.researchesAuto[2]=t.inflation.vacuum?t.strangeness[2][4]<1?2:t.strangeness[4][4]<1?3:4:1,D(2,0,"researchesAuto")):e===5?(t.ASR[3]=r.ASRInfo.max[3],D(0,3,"ASR")):e===6?t.researchesAuto[0]<t.strangeness[3][6]&&(t.researchesAuto[0]=t.strangeness[3][6],D(0,0,"researchesAuto")):e===9&&(r.debug.rankUpdated=null,$e());else if(n===4)if(e===4)(t.inflation.vacuum?t.researchesAuto[2]===3&&t.strangeness[1][4]>=1&&t.strangeness[3][4]>=1&&t.strangeness[2][4]>=1:t.researchesAuto[2]<1&&t.stage.current>=4)&&(t.researchesAuto[2]=t.inflation.vacuum?4:1,D(2,0,"researchesAuto"));else if(e===5)t.ASR[4]=r.ASRInfo.max[4],D(0,4,"ASR");else if(e===6){t.researchesAuto[1]<t.strangeness[4][6]&&(t.researchesAuto[1]=t.strangeness[4][6],D(1,0,"researchesAuto"));for(let c=1;c<w.elements.length&&(c=t.elements.indexOf(.5,c),!(c<1));c++)te(c,4,"elements",!0)}else e===8&&t.elements[0]<1&&(t.elements[0]=1,de(0,4,"elements"));else n===5&&(e===3?t.inflation.vacuum&&G("soft"):e===4?t.strangeness[5][5]>=1&&(t.ASR[5]=r.ASRInfo.max[5],D(0,5,"ASR")):e===5&&(t.ASR[5]=t.strangeness[5][4]>=1?r.ASRInfo.max[5]:2,D(0,5,"ASR")));X[0](),!o&&v.SRSettings[0]&&(a("SRMain").textContent=`Level increased ${t.strangeness[n][e]>=i.max[e]?"and maxed at":"to"} ${d(t.strangeness[n][e])} for '${i.name[e]}' Strangeness from ${r.stageInfo.word[n]} section`)}else if(s==="inflation"){let i=r.inflationTreeInfo;if(t.inflation.tree[e]>=i.max[e]||t.cosmon.current<i.cost[e])return!1;t.inflation.tree[e]++,t.cosmon.current-=i.cost[e],v.SRSettings[0]&&(a("SRMain").textContent=`Strength of Inflation Research '${i.name[e]}' increased ${t.inflation.tree[e]>=i.max[e]?"and maxed at":"to"} ${d(t.inflation.tree[e])}`)}return Q(),pe(e,n,s),s==="inflation"?Pe(e):D(e,n,s),o||J(),!0},qt=async()=>{let{tree:e}=t.inflation,n=t.cosmon;if(!(n.current===n.total&&e[0]<1||!await j(`This will cause Stage reset to refund spended Cosmon
Continue?`))){Qt(),n.current=n.total;for(let s=0;s<w.inflation.tree.length;s++)e[s]=0,pe(s,0,"inflation");Pe(),v.SRSettings[0]&&(a("SRMain").textContent="Cosmon has been refunded")}},pe=(e,n,s)=>{if(s==="researches"||s==="researchesExtra"){let o=r[`${s}Info`][n];o.cost[e]=n===1?o.startCost[e]+o.scaling[e]*t[s][n][e]:o.startCost[e]*o.scaling[e]**t[s][n][e]}else if(s==="strangeness"){let o=r.strangenessInfo[n];o.cost[e]=t.inflation.vacuum?Math.floor(Math.round(o.startCost[e]*o.scaling[e]**t.strangeness[n][e]*100)/100):Math.floor(Math.round((o.startCost[e]+o.scaling[e]*t.strangeness[n][e])*100)/100)}else if(s==="inflation"){let o=r.inflationTreeInfo;o.cost[e]=Math.floor(Math.round((o.startCost[e]+o.scaling[e]*t.inflation.tree[e])*100)/100)}},R=(e,n,s,o=!1)=>{let i=null;s==="researches"?n===2?e===2?(i=4,t.strangeness[2][8]>=1&&(i+=3)):e===3?(i=4,t.strangeness[2][8]>=2&&i++):e===4?(i=2,t.strangeness[2][2]>=1&&i++):e===5&&(i=1,t.strangeness[2][2]>=2&&i++):n===4?e===0?(i=3+3*t.researches[4][2]+3*t.researches[4][3],t.elements[9]>=1&&(i+=12),t.elements[17]>=1&&(i+=24)):e===1?(i=2+t.researchesExtra[4][2]+t.researchesExtra[4][3],t.elements[7]>=1&&(i+=2),t.elements[16]>=1&&i++,t.elements[20]>=1&&i++,t.elements[25]>=1&&i++,t.elements[28]>=1&&i++):e===2&&(i=1,t.elements[11]>=1&&i++):n===5&&(e===0?i=t.inflation.vacuum?4:3:e===1&&(i=t.inflation.vacuum?4:3)):s==="researchesExtra"?n===3&&(e===0?(i=14+2*t.accretion.rank,t.strangeness[3][2]>=1&&(i+=6)):e===1?(i=6,t.strangeness[3][2]>=2&&(i+=2)):e===4&&(i=t.accretion.rank-2)):s==="researchesAuto"?e===2&&(i=t.inflation.vacuum?4:1):s==="ASR"?n===1?i=t.inflation.vacuum?5:3:n===2?i=t.inflation.vacuum?6:5:n===3?i=t.inflation.vacuum?5:4:n===4&&(i=t.inflation.vacuum?5:4):s==="strangeness"&&(n===1?e===0?(i=6,t.inflation.vacuum&&(i+=Math.min(t.challenges.void[3],4))):e===3?(i=2,t.inflation.vacuum&&(i+=Math.min(t.challenges.void[3],4))):e===4&&(i=t.inflation.vacuum&&t.challenges.void[4]>=1?2:1):n===2?e===1?(i=8,t.inflation.vacuum&&(i+=Math.min(t.challenges.void[3],4))):e===3?(i=2,t.inflation.vacuum&&(i+=Math.min(t.challenges.void[3],4))):e===4&&(i=t.inflation.vacuum&&t.challenges.void[4]>=1?2:1):n===3?e===0?(i=8,t.inflation.vacuum&&(i+=Math.min(t.challenges.void[3],4))):e===1?(i=4,t.inflation.vacuum&&(i+=Math.min(t.challenges.void[3],4))):e===4&&(i=t.inflation.vacuum&&t.challenges.void[4]>=1?2:1):n===4?e===0?(i=8,t.inflation.vacuum&&(i+=Math.min(t.challenges.void[3],4))):e===1?(i=4,t.inflation.vacuum&&(i+=Math.min(t.challenges.void[3],4))):e===4?i=t.inflation.vacuum&&t.challenges.void[4]>=1?2:1:e===6&&(i=t.inflation.vacuum||r.milestonesInfoS6.active[2]||t.milestones[4][0]>=8?2:1):n===5&&(e===2?(i=2,t.inflation.vacuum&&(i+=Math.min(t.challenges.void[3],4))):e===6&&(i=!t.inflation.vacuum&&t.milestones[5][0]>=8?2:1))),i!==null&&(i<0&&(i=0),s==="researchesAuto"||s==="ASR"?r[`${s}Info`].max[s==="ASR"?n:e]=i:r[`${s}Info`][n].max[e]=i),s!=="researchesAuto"&&s!=="ASR"&&pe(e,n,s),D(e,n,s),o&&(s==="researches"||s==="researchesExtra")&&le(s,[n,e])},Me=e=>{if(!t.toggles.auto[5])return;let n=r.automatization.autoU,s=t.upgrades,o=r.upgradesInfo;if(e==="all")for(let i=1;i<=5;i++){n[i]=[];for(let f=0;f<o[i].maxActive;f++)s[i][f]<1&&n[i].push(f);let c=o[i].startCost;n[i].sort((f,g)=>c[f]-c[g])}else if(typeof e=="number"){n[e]=[];for(let c=0;c<o[e].maxActive;c++)s[e][c]<1&&n[e].push(c);let i=o[e].startCost;n[e].sort((c,f)=>i[c]-i[f])}},Ne=e=>{if(!t.toggles.auto[5]||t.researchesAuto[0]<1)return;let n=r.automatization.autoU[e];for(let s=0;s<n.length;s++){let o=n[s];if(be(o,e,"upgrades"))if(te(o,e,"upgrades",!0),t.upgrades[e][o]>=1)n.splice(s,1),s--;else break}},le=(e,n)=>{if(!t.toggles.auto[e==="researches"?6:7])return;let s=r.automatization[e==="researches"?"autoR":"autoE"],o=t[e],i=r[`${e}Info`];if(n==="all")for(let c=1;c<=5;c++){s[c]=[];let{max:f,cost:g}=i[c];for(let l=0;l<i[c].maxActive;l++)o[c][l]<f[l]&&s[c].push(l);s[c].sort((l,u)=>g[l]-g[u])}else if(typeof n=="number"){s[n]=[];let{max:c,cost:f}=i[n];for(let g=0;g<i[n].maxActive;g++)o[n][g]<c[g]&&s[n].push(g);s[n].sort((g,l)=>f[g]-f[l])}else{let[c,f]=n;if(i[c].max[f]>o[c][f]){let{cost:g}=i[c],l;for(let u=0;u<s[c].length;u++){if(s[c][u]===f)return;l===void 0&&g[f]<g[s[c][u]]&&(l=u)}l!==void 0?s[c].splice(l,0,f):s[c].push(f)}}},fe=(e,n)=>{if(e==="researches"){if(!t.toggles.auto[6]||t.researchesAuto[0]<2)return}else if(!t.toggles.auto[7]||t.researchesAuto[0]<3)return;let s=r.automatization[e==="researches"?"autoR":"autoE"][n],o=r[`${e}Info`][n],i=!1;for(let c=0;c<s.length;c++){if(!be(s[c],n,e))continue;let f=te(s[c],n,e,!0);if(t[e][n][s[c]]>=o.max[s[c]])s.splice(c,1),c--;else if(!f){if(o.cost[s[c]]>o.cost[s[c+1]]){i=!0;continue}break}}i&&s.sort((c,f)=>o.cost[c]-o.cost[f])},Ce=()=>{if(!t.toggles.auto[8])return;let e=[],n=t.elements;for(let s=1;s<(t.inflation.vacuum?r.elementsInfo.startCost.length:29);s++)n[s]<1&&e.push(s);r.automatization.elements=e},Wt=()=>{if(!t.toggles.auto[8]||t.researchesAuto[1]<2)return;let e=r.automatization.elements,n=t.elements;for(let s=0;s<e.length;s++){let o=e[s];if(!be(o,4,"elements"))break;if(te(o,4,"elements",!0),n[o]>0)e.splice(s,1),s--;else break}},K=(e,n,s=!1)=>{let o=n==="buildings"?t.toggles.buildings[t.stage.active]:t.toggles[n];if(s){if(r.paused)return;if(n==="buildings"){let f=w.buildings[t.stage.active].length;if(e===0){o[0]=!o[0];for(let g=1;g<f;g++)o[g]=o[0],K(g,"buildings")}else{if(e>=f)return;let g=!1;o[e]=!o[e];for(let l=1;l<=t.ASR[t.stage.active];l++)if(o[l]){g=!0;break}o[0]!==g&&(o[0]=g,K(0,"buildings"))}}else o[e]=!o[e]}let i,c;n==="buildings"?(c=a(`toggleBuilding${e}`),i=e===0?"All ":"Auto "):n==="hover"?(c=a(`toggleHover${e}`),i="Hover to create "):n==="max"?(c=a(`toggleMax${e}`),i="Max create "):n==="auto"?(c=a(`toggleAuto${e}`),i="Auto "):(c=a(`toggleNormal${e}`),i=""),o[e]?(c.style.color="",c.style.borderColor="",c.textContent=`${i}ON`):(c.style.color="var(--red-text)",c.style.borderColor="crimson",c.textContent=`${i}OFF`)},st=(e,n=!1)=>{let s=t.toggles.confirm;n&&(s[e]=s[e]==="Safe"?"None":"Safe");let o=a(`toggleConfirm${e}`);o.textContent=s[e],s[e]==="Safe"?(o.style.color="",o.style.borderColor=""):(o.style.color="var(--red-text)",o.style.borderColor="crimson")},mn=()=>{r.strangeInfo.quarksGain=y.strangeGain(5)},se=(e,n=null)=>{if(e===5){if(mn(),t.elements[26]<1)return!1;if(n!==null){let{stage:s}=t,o=r.strangeInfo.quarksGain/t.time.stage;if(s.peak<o&&(s.peak=o),t.strange[1].current>0&&dn(n),!t.toggles.auto[0]||t.strangeness[5][6]<(t.inflation.vacuum?1:2)||t.challenges.active!==null||s.input[0]<=0&&s.input[1]<=0||s.input[0]>r.strangeInfo.quarksGain||s.input[1]>t.time.stage)return!1;Re(e)}return!0}else if(e===3){if(t.buildings[3][0].current.lessThan("2.45576045e31"))return!1}else if(e===2){if(t.buildings[2][1].current.lessThan("1.19444e29"))return!1}else if(e===1){if(t.buildings[1][3].current.lessThan("1.67133125e21"))return!1}else return!1;if(n!==null){if(t.strangeness[5][6]<1)return!1;Re(e)}return!0},Ue=async()=>{if(r.paused)return;let e=t.inflation.vacuum||t.stage.active===4&&t.events[0]?5:t.stage.active;if(se(e)){if(t.toggles.confirm[0]!=="None"){let n="";if(t.upgrades[5][3]===1){ut();let s=Se(1,6);s.lessOrEqual(t.merge.reward[0]+(ct()<t.merge.resets?r.mergeInfo.checkReward[0]:0))&&(n+=`can create an Universe${s.moreThan(t.merge.reward[0])?" after Merge":""}`)}if(t.researchesExtra[5][0]>=1){Ct();let s=Se(3,5);s.lessOrEqual(Math.max(t.collapse.mass,r.collapseInfo.newMass))&&(n!==""&&(n+=`
Also `),n+=`can afford a Galaxy${s.moreThan(t.collapse.mass)?" after Collapse":""}`)}if(t.challenges.active!==null&&(n!==""&&(n+=`
Also `),n+=`currently inside the ${r.challengesInfo.name[t.challenges.active]}`),n!==""){if(!await j(`Prevented Stage reset because ${n}
Reset anyway?`))return;if(!se(e))return P("Stage reset canceled, requirements are no longer met")}}if(v.SRSettings[0]){let n;if(t.stage.true>=5){let s=e<4?y.strangeGain(e):r.strangeInfo.quarksGain;n=`Caused Stage reset for ${d(s)} Strange quarks`;let o=t.strangeness[5][8]>=1||t.inflation.tree[3]>=1?y.strangeGain(e,1):0;o>0&&(n+=` and ${d(o)} Strangelets`)}else n=`${r.stageInfo.word[t.stage.true]} Stage ended, but new one started`;a("SRMain").textContent=n}Re(e)}},Re=e=>{let{stage:n}=t;n.resets++;let s=!0,o="normal",i=t.inflation.vacuum?[1,2,3,4,5]:[e];if(t.inflation.vacuum)n.active===1?o="soft":n.active<6&&Z(1),n.current=1,n.true>=7?i.push(6):n.resets<2&&ce(7);else if(e===n.current){if(e<4){let c=n.current===n.active;n.current++,n.current===2&&t.milestones[2][1]>=7&&n.current++,n.current===3&&t.milestones[3][1]>=7&&n.current++,c?Z(n.current):o="soft",n.current>n.true&&(n.true=n.current,t.events[0]=!1,He())}else n.current=t.milestones[1][1]<6?1:t.milestones[2][1]<7?2:t.milestones[3][1]<7?3:4,n.active===4&&n.current!==4||n.active===5?Z(n.current):o="soft",i.unshift(4);n.true>=7&&i.push(6)}else o=e===n.active?"soft":!1,s=!1;if(n.true>=5){let{strange:c}=t,f=t.time.export,g=e<4?y.strangeGain(e):r.strangeInfo.quarksGain,l=t.strangeness[5][8]>=1||t.inflation.tree[3]>=1?y.strangeGain(e,1):0;if(c[0].current+=g,c[0].total+=g,l>0&&(c[1].current+=l,c[1].total+=l,l>f[2]&&(f[2]=l),X[1]()),g>f[1]&&(f[1]=g),i.includes(4)&&(t.elements[26]=0),X[0](),e>=4){let u=t.time.stage;r.historyStorage.stage.unshift([u,g,l,0]),r.historyStorage.stage.length>100&&(r.historyStorage.stage.length=100),g/u>r.strangeInfo.bestHistoryRate&&(t.history.stage.best=[u,g,l,0],r.strangeInfo.bestHistoryRate=g/u)}}Le(i,o,s)},Qt=()=>{let e=t.inflation.vacuum,n=e?5:t.stage.current;if(e||(n!==1&&t.milestones[1][1]>=6&&(se(1)?Re(1):Le([1],!1,!1)),n!==2&&t.milestones[2][1]>=7&&(se(2)?Re(2):Le([2],!1,!1)),n!==3&&t.milestones[3][1]>=7&&(se(3)?Re(3):Le([3],!1,!1))),se(n))Re(n);else{let s=e?[1,2,3,4,5]:[n];t.stage.true>=7&&s.push(6);let o="soft";e&&(t.stage.active!==1&&t.stage.active<6&&(Z(1),o="normal"),t.stage.current=1),Le(s,o)}},xe=(e,n=e)=>{if(r.stageInfo.activeAll.includes(e)){if(t.stage.active===e){r.trueActive!==e&&(r.trueActive=e,a(`${r.stageInfo.word[e]}Switch`).style.textDecoration="underline");return}Z(e,n),G()}},Z=(e,n=e)=>{a(`${r.stageInfo.word[t.stage.active]}Switch`).style.textDecoration="",t.stage.active=e,r.trueActive=n,a(`${r.stageInfo.word[e]}Switch`).style.textDecoration="underline"+(r.trueActive!==e?" dashed":""),r.tab==="inflation"?e!==6&&_("upgrade"):r.tab==="Elements"&&e!==4&&e!==5&&_("upgrade"),r.tab==="upgrade"&&r.subtab.upgradeCurrent==="Elements"&&e!==4&&e!==5&&_("upgrade","Upgrades")},at=()=>(20-4*t.researches[1][3]-t.strangeness[1][2])/2,Ot=()=>{r.dischargeInfo.next=Math.round(at()**t.discharge.current)},Ye=()=>{if(!t.inflation.vacuum){r.dischargeInfo.energyType[1]=[0,1,5,20];return}let e=[[],[0,1,3,5,10,20],[0,20,30,40,50,60,120],[0,20,40,60,120,160],[0,80,160,240,320,400],[0,400,400,2e3]];for(let n=1;n<=5;n++)for(let s=1;s<e[n].length;s++){let o=e[n][s];n===1?s===1&&(o+=t.strangeness[1][7]*2):t.challenges.active===0&&(o/=2),e[n][s]=o}r.dischargeInfo.energyType=e},rt=()=>{Ye();let{dischargeInfo:e}=r;e.energyTrue=0;for(let n=1;n<=(t.inflation.vacuum?5:1);n++){let s=0,o=t.buildings[n],i=e.energyType[n];for(let c=1;c<i.length;c++)s+=i[c]*o[c].true;e.energyStage[n]=s,e.energyTrue+=s}},Xe=(e=!1)=>{if(Ot(),t.upgrades[1][5]!==1)return!1;let n=r.dischargeInfo,s=t.discharge.energy,o=t.strangeness[1][4];if(e){if(o>=2&&s>=n.next){if(kt(!0),!t.toggles.auto[1])return!1;Ot()}else if(!t.toggles.auto[1]||o<1&&(t.researchesAuto[2]<1||!t.inflation.vacuum&&t.stage.current!==1))return!1;return s>=n.energyTrue&&(o>=2||s<n.next)?!1:(kt(),!0)}return s<n.energyTrue||o<2&&s>=n.next},ot=async()=>{if(!(r.paused||!Xe())){if(t.toggles.confirm[1]!=="None"&&t.stage.active!==1){if(!await j(`Prevented Discharge because current active Stage isn't Microworld
Reset anyway?`))return;if(!Xe())return P("Discharge canceled, requirements are no longer met")}v.SRSettings[0]&&(a("SRMain").textContent=`Caused Discharge to reset spent Energy${t.discharge.energy>=r.dischargeInfo.next?", also reached new goal":""}`),kt()}},kt=(e=!1)=>{t.discharge.energy>=r.dischargeInfo.next&&(t.discharge.current++,e||(t.discharge.energy-=r.dischargeInfo.next)),Ae(1),e||Te("discharge",[1])},Ze=()=>{let e=t.challenges.active===0?.4:t.inflation.vacuum?.5:.6;r.vaporizationInfo.get.setValue(t.vaporization.clouds).power(1/e).plus(new p(t.buildings[2][1][t.researchesExtra[2][0]>=1?"total":"current"]).divide(y.S2Upgrade2())).power(e).minus(t.vaporization.clouds)},et=(e=null)=>{if(Ze(),t.upgrades[2][2]<1||r.vaporizationInfo.get.lessOrEqual("0"))return!1;if(e!==null){let n=t.strangeness[2][4];if(n>=2){if(Mt(e),!t.toggles.auto[2]||t.toggles.normal[1])return!1;Ze()}else if(!t.toggles.auto[2]||n<1&&(t.inflation.vacuum?t.researchesAuto[2]<3:t.researchesAuto[2]<1||t.stage.current!==2))return!1;if(t.vaporization.input[1]>0&&t.vaporization.clouds.moreOrEqual(t.vaporization.input[1]))return!1;let s=y.S2Extra1(t.researchesExtra[2][1]),o=y.S2Extra1(t.researchesExtra[2][1],!0),i=y.S2Extra2(o)/y.S2Extra2(s);if(y.clouds(!0).divide(y.clouds()).multiply(o/s*i).lessThan(t.vaporization.input[0]))return!1;Mt()}return!0},it=async()=>{if(!(r.paused||!et())){if(t.toggles.confirm[2]!=="None"){let e="";t.strangeness[2][4]>=2&&(e+="already gaining Clouds without needing to reset");let n=y.S2Extra1(t.researchesExtra[2][1]),s=y.S2Extra1(t.researchesExtra[2][1],!0),o=y.S2Extra2(s)/y.S2Extra2(n);if(y.clouds(!0).divide(y.clouds()).multiply(s/n*o).lessThan("2")&&(e!==""&&(e+=`
Also `),e+="boost from doing it is bellow 2x"),t.stage.active!==2&&(e!==""&&(e+=`
Also `),e+="current active Stage isn't Submerged"),e!==""){if(!await j(`Prevented Vaporization because ${e}
Reset anyway?`))return;if(!et())return P("Vaporization canceled, requirements are no longer met")}}v.SRSettings[0]&&(a("SRMain").textContent=`Caused Vaporization for ${d(r.vaporizationInfo.get)} Clouds, +${d(t.vaporization.clouds.moreThan("0")?new p(r.vaporizationInfo.get).divide(t.vaporization.clouds).multiply("1e2"):100)}%`),Mt()}},Mt=(e=null)=>{let n=t.vaporization;e!==null?n.clouds.plus(new p(r.vaporizationInfo.get).multiply(e/40)):n.clouds.plus(r.vaporizationInfo.get),n.cloudsMax.lessThan(n.clouds)&&n.cloudsMax.setValue(n.clouds),Ae(2),e===null&&Te("vaporization",t.inflation.vacuum?[1,2]:[2])},$e=()=>{t.inflation.vacuum?r.accretionInfo.maxRank=t.strangeness[3][9]>=1?7:6:r.accretionInfo.maxRank=t.stage.true>=4||t.stage.true===3&&t.events[0]?5:4},tt=(e=!1)=>{let n=t.accretion.rank;if(n>=r.accretionInfo.maxRank)return!1;let s=t.strangeness[3][4];if((t.inflation.vacuum?new p(t.buildings[1][0][s>=2?"total":"current"]).multiply("1.78266192e-33"):t.buildings[3][0][s>=2?"total":"current"]).lessThan(r.accretionInfo.rankCost[n]))return!1;if(e){if(s<1&&(t.inflation.vacuum?t.researchesAuto[2]<2:t.researchesAuto[2]<1||t.stage.current!==3))return!1;Kt()}return!0},lt=async()=>{if(!(r.paused||!tt())){if(t.toggles.confirm[3]!=="None"&&t.accretion.rank!==0){let e="";if(t.inflation.vacuum&&(t.researchesExtra[2][1]<=0||t.vaporization.clouds.lessOrEqual("0"))&&t.accretion.rank>=4&&(e+=`current ${t.researchesExtra[2][1]<=0?"level for Cloud Research 'Rain Clouds'":"Cloud amount"} is 0, which could make next Rank slow`),t.stage.active!==3&&(e!==""&&(e+=`
Also `),e+="current active Stage isn't Accretion"),e!==""){if(!await j(`Prevented Rank increase because ${e}
Reset anyway?`))return;if(!tt())return P("Rank increase canceled, requirements are no longer met")}}Kt(),v.SRSettings[0]&&(a("SRMain").textContent=`Rank increased to '${r.accretionInfo.rankName[t.accretion.rank]}' (Rank number is ${t.accretion.rank})`)}},Kt=()=>{t.accretion.rank++,t.accretion.rank===6&&(t.stage.current=4,t.toggles.normal[0]&&t.stage.active<4?(Z(4),G()):G("soft")),Ae(3),Te("rank",t.inflation.vacuum?[1,2,3]:[3]),R(0,3,"researchesExtra",!0),R(4,3,"researchesExtra",!0)},_t=()=>{let e=t.elements,n=.004;return e[3]>=1&&(n+=.002),e[5]>=1&&(n+=2e-4*t.buildings[4][1].true),n*=e[15]>=1?r.collapseInfo.trueStars:t.buildings[4][1].true,t.inflation.vacuum?n=n*(t.challenges.active===0?48:96)+1:(e[10]>=1&&(n*=2),t.researchesExtra[4][1]>=1&&(n*=y.S4Extra1()),n*=y.star[2](),t.strangeness[5][7]>=1&&(n*=r.strangeInfo.stageBoost[5])),n},Ct=()=>{r.collapseInfo.newMass=t.inflation.vacuum?Math.min(new p(t.buildings[1][0].current).multiply("8.96499278339628e-67").toNumber(),r.inflationInfo.massCap):_t()},pn=()=>{let e=t.buildings[4],n=r.collapseInfo.starCheck,s=t.collapse.stars;n[0]=e[2].trueTotal.moreThan("0")?Math.max(e[2].true+Math.floor(e[1].true*t.strangeness[4][3]/10)-s[0],0):0,n[1]=Math.max(e[3].true-s[1],0),n[2]=Math.max(e[4].true+e[5].true*t.researches[4][5]-s[2],0)},nt=(e=!1)=>{if(pn(),Ct(),t.upgrades[4][0]<1)return!1;let n=r.collapseInfo,s=t.strangeness[4][4];if(e){if(s>=2&&(n.starCheck[0]>0||n.starCheck[1]>0||n.starCheck[2]>0)){if(qe(!0),!t.toggles.auto[4])return!1;n.starCheck[0]=0,n.starCheck[1]=0,n.starCheck[2]=0,Ct()}else if(!t.toggles.auto[4]||s<1&&(t.inflation.vacuum?t.researchesAuto[2]<4:t.researchesAuto[2]<1||t.stage.current<4))return!1;if(t.strangeness[5][4]>=1&&t.toggles.buildings[5][3]&&t.ASR[5]>=3&&t.researchesExtra[5][0]>=1&&Se(3,5).lessOrEqual(n.newMass))return qe(),!0;if(t.inflation.vacuum){let g=new p(r.inflationInfo.massCap/896499278339628e-81).minus(t.buildings[1][0].current).divide(r.buildingsInfo.producing[1][1]).toNumber()/r.inflationInfo.globalSpeed;if(g<t.collapse.input[1]&&g>0)return!1}let o=y.mass(!0)/y.mass()*(y.S4Research4(!0)/y.S4Research4())*(1+(y.S5Upgrade2(!0)-y.S5Upgrade2())/r.mergeInfo.galaxyBase)**(t.buildings[5][3].true*2);if(o>=t.collapse.input[0])return qe(),!0;if(s>=2)return!1;let i=y.star,c=r.buildingsInfo.producing[4],f=new p(c[1]).plus(c[3],c[4],c[5]);return o*new p(c[2]).multiply(i[0](!0)/i[0]()).plus(f).divide(f.plus(c[2])).replaceNaN("1").toNumber()*(i[1](!0)/i[1]())*(i[2](!0)/i[2]())<t.collapse.input[0]?!1:(qe(),!0)}return n.newMass>t.collapse.mass||s<2&&(n.starCheck[0]>0||n.starCheck[1]>0||n.starCheck[2]>0)||t.elements.includes(.5,1)},Ke=async()=>{if(!(r.paused||!nt())){if(t.toggles.confirm[4]!=="None"){let e="";if(t.inflation.vacuum){let n=t.researchesExtra[5][0]>=1,s=!n||Se(3,5).moreThan(r.collapseInfo.newMass),o=new p(r.inflationInfo.massCap/896499278339628e-81).minus(t.buildings[1][0].current).divide(r.buildingsInfo.producing[1][1]).toNumber();o>0&&o<1e6&&s&&(e+=`Solar mass isn't hardcapped, but can be soon hardcapped${n?", also can't afford new Galaxy":""}`),(t.researchesExtra[2][1]<=0||t.vaporization.clouds.lessOrEqual("0"))&&(e!==""&&(e+=`
Also `),e+=`current ${t.researchesExtra[2][1]<=0?"level for Cloud Research 'Rain Clouds'":"Cloud amount"} is 0, which could make recovering from Collapse really slow`)}if(t.stage.active!==4&&t.stage.active!==5&&(e!==""&&(e+=`
Also `),e+="current active Stage isn't Interstellar"),e!==""){if(!await j(`Prevented Collapse because ${e}
Reset anyway?`))return;if(!nt())return P("Collapse canceled, requirements are no longer met")}}if(v.SRSettings[0]){let{starCheck:e,newMass:n}=r.collapseInfo,s=0;for(let i=1;i<w.elements.length&&(i=t.elements.indexOf(.5,i),!(i<1));i++)s++;let o=`Caused Collapse to${s>0?` activate ${d(s)} new Elements and`:""} ${n>t.collapse.mass?`increase Solar mass to ${d(n)}`:""}`;(e[0]>0||e[1]>0||e[2]>0)&&(o+=n>t.collapse.mass?", also gained":"gain",e[0]>0&&(o+=` ${d(e[0])} Red giants`),e[1]>0&&(o+=`, ${d(e[1])} Neutron stars`),e[2]>0&&(o+=`, ${d(e[2])} Black holes`)),a("SRMain").textContent=o}qe()}},qe=(e=!1)=>{let n=r.collapseInfo,s=t.collapse;if(s.stars[0]+=n.starCheck[0],s.stars[1]+=n.starCheck[1],s.stars[2]+=n.starCheck[2],!e){n.newMass>s.mass&&(s.mass=n.newMass,s.massMax<s.mass&&(s.massMax=s.mass));for(let o=1;o<w.elements.length&&(o=t.elements.indexOf(.5,o),!(o<1));o++)te(o,4,"elements",!0);Te("collapse",t.inflation.vacuum?[1,2,3,4]:t.strangeness[5][3]<1?[4,5]:[4]),R(0,4,"researches"),R(1,4,"researches")}Ae(4)},ut=()=>{r.mergeInfo.checkReward[0]=Math.max(Math.floor(t.buildings[5][3].current.toNumber()/40)-t.merge.reward[0],0)},ct=()=>{let e=1;return t.elements[30]>=1&&(e+=t.buildings[6][1].true),e},zt=()=>t.upgrades[5][3]!==1?!1:t.inflation.vacuum?t.merge.resets>=ct()||t.buildings[5][3].true<1?!1:(ut(),!0):t.buildings[5][3].true>=22+2*t.buildings[6][1].true,ft=async()=>{if(!(r.paused||!zt())){if(t.toggles.confirm[5]!=="None"&&t.stage.active!==5){if(!await j(`Prevented Merge because current active Stage isn't Intergalactic
Reset anyway?`))return;if(!zt())return P("Merge canceled, requirements are no longer met")}if(hn(),v.SRSettings[0]){let{checkReward:e}=r.mergeInfo;a("SRMain").textContent=t.inflation.vacuum?`Tryed to Merge Galaxies and ${e[0]>0?`created ${d(e[0])} Galaxy Groups`:"resetted self-made Galaxies"}`:"Vacuum decayed into its true state"}}},hn=()=>{if(!t.inflation.vacuum)return Vt();t.events[1]||ce(8,1),t.merge.resets++,t.buildings[5][3].true=0,t.merge.reward[0]+=r.mergeInfo.checkReward[0],Te("galaxy",t.inflation.vacuum?[1,2,3,4,5]:[4,5]),R(0,4,"researches"),R(1,4,"researches"),R(2,4,"researches"),t.stage.current<6&&(t.stage.current=6,G("soft")),t.toggles.normal[0]&&t.stage.active>=5&&Se(1,6).lessOrEqual(t.merge.reward[0])&&(Z(6),G())},Ge=(e,n)=>{let s=r.milestonesInfo[n],o=t.milestones[n][e];if(!t.inflation.vacuum){let i=o/(s.max[e]-1);n===1?s.time[e]=14400/(i*(e===1?11:3)+1)**i:n===2?s.time[e]=28800/(i*(e===1?23:7)+1)**i:n===3?s.time[e]=43200/(i*(e===1?35:11)+1)**i:n===4?s.time[e]=57600/(i*(e===1?47:15)+1)**i:n===5&&e===0&&(s.time[e]=3600/(i*2+1)),s.need[e].setValue(s.scaling[e][o])}},ae=(e,n,s=0)=>{if(!Dt(e,n)){s>0&&(t.strange[0].current+=s,t.strange[0].total+=s,X[0](),P(`Milestone '${r.milestonesInfo[n].name[e]}' new tier completed${!t.inflation.vacuum&&t.milestones[n][e]>=r.milestonesInfo[n].max[e]?", maxed":""}`),t.inflation.vacuum||(n===4?e===0&&t.milestones[4][0]>=8&&R(6,4,"strangeness",!0):n===5&&e===0&&t.milestones[5][0]>=8&&R(6,5,"strangeness",!0)));return}t.milestones[n][e]++,Ge(e,n),ae(e,n,s+1)},Ae=e=>{if(t.challenges.active!==0)return;let n=t.challenges.void[e],s=1;if(e===1?s+=t.researchesExtra[1][2]:e===2?t.vaporization.clouds.moreThan("1e4")&&s++:e===3?s=Math.min(t.accretion.rank-1,5):e===4?(t.collapse.stars[0]>=1&&s++,t.collapse.stars[1]>=1&&s++,t.collapse.stars[2]>=1&&s++):e===5&&t.buildings[5][3].true>=1&&s++,n>=s)return;let o=t.time.stage>(t.inflation.tree[0]>=1&&t.inflation.tree[4]<1?900:3600);if(t.challenges.voidCheck[e]<s){if(o)return;t.challenges.voidCheck[e]=s}else if(o&&t.inflation.tree[4]<1)return;t.challenges.void[e]=s;for(let i=n;i<s;i++)P(`New Void reward achieved
Reward: ${r.challengesInfo.rewardText[0][e][i]}`);e===3?n<4&&(R(0,1,"strangeness",!0),R(3,1,"strangeness",!0),R(1,2,"strangeness",!0),R(3,2,"strangeness",!0),R(0,3,"strangeness",!0),R(1,3,"strangeness",!0),R(0,4,"strangeness",!0),R(1,4,"strangeness",!0),R(2,5,"strangeness",!0)):e===4&&n<1&&(R(4,1,"strangeness",!0),R(4,2,"strangeness",!0),R(4,3,"strangeness",!0),R(4,4,"strangeness",!0)),r.lastChallenge[0]===0&&(Be(0),r.lastChallenge[1]===e&&gt(e))},jt=async e=>{if(r.paused)return;let n=t.challenges.active;if(n===e){if(!await j(`Leave the '${r.challengesInfo.name[n]}'?`))return;t.challenges.active=null,a("currentChallenge").style.display="none",v.SRSettings[0]&&(a("SRMain").textContent=`You left the '${r.challengesInfo.name[n]}'`),e===0&&rt()}else{if(!t.inflation.vacuum||!await j(`Enter the '${r.challengesInfo.name[e]}'?`))return;t.challenges.active=e,a("currentChallenge").style.display="";let s=C("#currentChallenge > span");s.textContent=r.challengesInfo.name[e],s.style.color=`var(--${r.challengesInfo.color[e]}-text)`,v.SRSettings[0]&&(a("SRMain").textContent=`'${r.challengesInfo.name[e]}' is now active`),Qt(),(n===0||e===0)&&Ye()}Be(e)};var _=(e,n=null)=>{if(n===null){let o=r.tab;a(`${o}Tab`).style.display="none",a(`${o}TabBtn`).classList.remove("tabActive");for(let c of r.tabList[`${o}Subtabs`])a(`${o}SubtabBtn${c}`).style.display="none";r.tab=e;let i=0;a(`${e}Tab`).style.display="",a(`${e}TabBtn`).classList.add("tabActive");for(let c of r.tabList[`${e}Subtabs`])ge(e,c)?(a(`${e}SubtabBtn${c}`).style.display="",i++):r.subtab[`${e}Current`]===c&&_(e,r.tabList[`${e}Subtabs`][0]);a("subtabs").style.display=i>1?"":"none",v.SRSettings[0]&&(a("SRTab").textContent=`Current tab is '${e}'${i>1?` and subtab is '${r.subtab[`${e}Current`]}'`:""}`)}else{let o=r.subtab[`${e}Current`];if(a(`${e}Subtab${o}`).style.display="none",a(`${e}SubtabBtn${o}`).classList.remove("tabActive"),r.subtab[`${e}Current`]=n,a(`${e}Subtab${n}`).style.display="",a(`${e}SubtabBtn${n}`).classList.add("tabActive"),r.tab!==e)return;v.SRSettings[0]&&(a("SRTab").textContent=`Current subtab is '${n}', part of '${e}' tab`)}let s=t.stage.active;if(e==="upgrade"&&r.subtab.upgradeCurrent==="Elements"||e==="Elements"){if(s!==4&&s!==5){Z(r.trueActive===5?5:4,r.trueActive),G();return}}else if(e==="inflation"){if(s!==6){Z(6,r.trueActive),G();return}}else if(r.trueActive!==s){xe(r.trueActive);return}ue(),J()},mt=(e=0,n=.2)=>{let{time:s,ASR:o}=t,{auto:i,buildings:c}=t.toggles,{maxActive:f}=r.buildingsInfo,{autoU:g,autoR:l,autoE:u}=r.automatization,m=r.stageInfo.activeAll,h=t.inflation.vacuum,b;if(e>0){let T=Math.min(n,e);b=T,e-=T}else{let T=Date.now();if(b=(T-s.updated)/1e3,s.updated=T,s.export[0]+=b,r.lastSave+=b,b>.2){if(b>600)return void _e(b);e=b-.2,b=.2}else if(b<=0){s.offline+=b;return}s.online+=b}let S=b;if(s.stage+=S,s.universe+=S,Gt(),b*=r.inflationInfo.globalSpeed,t.stage.time+=b,t.inflation.age+=b,(h||m.includes(4))&&se(5,S),Q(),m.includes(6)&&ee(0,6,b),m.includes(5)){(t.strangeness[5][3]>=1||r.milestonesInfoS6.active[2])&&(g[5].length!==0&&Ne(5),l[5].length!==0&&fe("researches",5),u[5].length!==0&&fe("researchesExtra",5));for(let E=f[5]-1;E>=1;E--)c[5][E]&&o[5]>=E&&ne(E,5,0,!0);ee(0,5,b);let T=t.researches[5][0];T>=1&&ee(1,5,b),T>=2&&ee(2,5,b),T>=3&&ee(3,5,b),T>=4&&t.challenges.active!==0&&ee(4,5,b),Q()}if(m.includes(4)){r.automatization.elements.length!==0&&Wt(),g[4].length!==0&&Ne(4),l[4].length!==0&&fe("researches",4),u[4].length!==0&&fe("researchesExtra",4);for(let T=f[4]-1;T>=1;T--)c[4][T]&&o[4]>=T&&ne(T,4,0,!0),ee(T-1,4,b);ae(0,5),ae(0,4),nt(!0),ae(1,4)}if(m.includes(3)){!h&&i[0]&&se(3,0),i[3]&&tt(!0),g[3].length!==0&&Ne(3),l[3].length!==0&&fe("researches",3),u[3].length!==0&&fe("researchesExtra",3);for(let T=1;T<f[3];T++)c[3][T]&&o[3]>=T&&ne(T,3,0,!0);ee(2,3,b),Q(),ee(1,3,b),Q(),h||(ee(0,3,b),Q())}if(m.includes(2)){!h&&i[0]&&se(2,0),et(S),g[2].length!==0&&Ne(2),l[2].length!==0&&fe("researches",2),u[2].length!==0&&fe("researchesExtra",2);for(let T=f[2]-1;T>=1;T--)c[2][T]&&o[2]>=T&&ne(T,2,0,!0);ee(1,2,b),Q(),h||(ee(0,2,b),Q()),ae(1,2),ae(0,2)}if(m.includes(1)){!h&&i[0]&&se(1,0),g[1].length!==0&&Ne(1),l[1].length!==0&&fe("researches",1),u[1].length!==0&&fe("researchesExtra",1),t.upgrades[1][8]===1&&(ee(5,1,b),Q());for(let T=f[1]-1;T>=1;T--)c[1][T]&&o[1]>=T&&ne(T,1,0,!0),ee(T-1,1,b),Q();ae(1,1),ae(0,1),Xe(!0)}e>0&&mt(e,n)},J=()=>{let{tab:e,subtab:n}=r,s=t.stage.active,o=t.buildings[s],i=t.inflation.vacuum;if(!r.debug.timeLimit){let c=0;if(i)t.challenges.active===0&&(c=3600);else if(t.inflation.tree[4]<1&&(t.stage.true>=7||t.stage.resets>=4)){let f=Math.min(t.stage.current,4),g=r.milestonesInfo;for(let l=0;l<g[f].need.length;l++){if(t.milestones[f][l]>=g[f].max[l]){f===4&&t.milestones[5][l]<g[5].max[l]&&(c=Math.max(g[5].time[l],c));continue}c=Math.max(g[f].time[l],c)}}c>0?(t.inflation.tree[0]>=1&&t.inflation.tree[4]<1&&(c/=4),t.time.stage>c&&(P(`Time limit had been reached for ${i?"Void":"all Milestones"}`),r.debug.timeLimit=!0)):r.debug.timeLimit=!0}if(r.footer)if(s===1)a("footerStat1Span").textContent=d(o[0].current,{padding:!0}),a("footerStat2Span").textContent=d(t.discharge.energy,{padding:"exponent"});else if(s===2)a("footerStat1Span").textContent=d(o[0].current,{padding:!0}),a("footerStat2Span").textContent=d(o[1].current,{padding:!0}),a("footerStat3Span").textContent=d(t.vaporization.clouds,{padding:!0});else if(s===3)a("footerStat1Span").textContent=d(o[0].current,{padding:!0});else if(s===4||s===5){let c=t.buildings[4];a("footerStat1Span").textContent=d(t.collapse.mass,{padding:!0}),a("footerStat2Span").textContent=d(c[0].current,{padding:!0}),s===5&&(a("footerStat3Span").textContent=d(new p(c[1].current).plus(c[2].current,c[3].current,c[4].current,c[5].current),{padding:!0}))}else s===6&&(a("footerStat1Span").textContent=d(o[0].current,{padding:!0}),a("footerStat2Span").textContent=d(t.cosmon.current,{padding:!0}));if(e==="stage"){if(n.stageCurrent==="Structures"){let{buildingsInfo:c}=r,f=r.hotkeys.shift?1:r.hotkeys.ctrl?10:t.toggles.shop.input;for(let l=1;l<c.maxActive[s];l++){let u=a(`building${l}True`);a(`building${l}Cur`).textContent=d(o[l].current,{padding:u.style.display!=="none"}),a(`building${l}Prod`).textContent=d(c.producing[s][l],{padding:!0}),u.textContent=`[${d(o[l].true)}]`;let m;if(s===3?l>1&&t.upgrades[3][r.accretionInfo.unlockA[l-2]]!==1&&(m="Unlocked with Upgrade"):s===4&&(l===5&&t.challenges.active===0?m="Can't be created inside Void":t.researchesExtra[5][0]<1&&t.collapse.mass<r.collapseInfo.unlockB[l]&&(m=`Unlocked at ${d(r.collapseInfo.unlockB[l])} Mass`)),m!==void 0){a(`building${l}`).classList.remove("availableBuilding"),a(`building${l}Btn`).textContent=m,a(`building${l}BuyX`).textContent="Locked";continue}let h,b,S=!1,T=!0;if(s===6)h="Groups",b=t.merge.reward[0],T=!1;else if(s===5&&l===3)h="Mass",b=t.collapse.mass,T=!1;else{let I=l-1,$=s;s===1?l===1&&i&&(S=t.researchesExtra[1][2]>=1&&t.strangeness[1][8]>=1):s===2?l!==1&&(I=1):s>=3&&(I=0,s===5&&($=4)),h=c.name[$][I],b=t.buildings[$][I].current}let E=1,k=Se(l,s);if(f!==1&&T){let I=c.increase[s][l];S?(E=f<=0?Math.max(Math.floor(new p(b).divide(k).log(I).toNumber())+1,1):f,E>1&&k.multiply(new p(I).power(E-1))):(E=f<=0?Math.max(Math.floor(new p(b).multiply(I-1).divide(k).plus("1").log(I).toNumber()),1):f,E>1&&k.multiply(new p(I).power(E).minus("1").divide(I-1)))}a(`building${l}`).classList[k.lessOrEqual(b)?"add":"remove"]("availableBuilding"),a(`building${l}Btn`).textContent=`Need: ${d(k,{padding:!0})} ${h}`,a(`building${l}BuyX`).textContent=d(E,{padding:"exponent"})}if(s===1)a("reset1Button").textContent=`Next goal is ${d(r.dischargeInfo.next,{padding:"exponent"})} Energy`,C("#tritiumEffect > span").textContent=d(r.dischargeInfo.tritium,{padding:!0}),C("#dischargeEffect > span").textContent=d(new p(r.dischargeInfo.base).power(r.dischargeInfo.total),{padding:!0}),C("#energyTrue > span").textContent=d(r.dischargeInfo.energyTrue-t.discharge.energy,{padding:"exponent"}),i&&(C("#preonCap > span").textContent=d(r.inflationInfo.preonCap,{padding:!0}),a("preonCapRatio").textContent=d(new p(r.inflationInfo.preonTrue).divide(r.inflationInfo.preonCap),{padding:!0}));else if(s===2){a("reset1Button").textContent=`Reset for ${d(r.vaporizationInfo.get,{padding:!0})} Clouds`,C("#cloudEffect > span").textContent=d(y.clouds(),{padding:!0}),i&&(C("#molesProduction > span").textContent=d(new p(r.dischargeInfo.tritium).divide("6.02214076e23"),{padding:!0}));let l=y.S2Extra1(t.researchesExtra[2][1]),u=y.S2Extra1(t.researchesExtra[2][1],!0),m=y.S2Extra2(u)/y.S2Extra2(l);C("#vaporizationBoostTotal > span").textContent=d(new p(y.clouds(!0)).divide(y.clouds()).toNumber()*(u/l)*m,{padding:!0})}else if(s===3)C("#dustSoftcap > span").textContent=d(r.accretionInfo.dustSoft),t.accretion.rank<r.accretionInfo.maxRank&&t.strangeness[3][4]>=2&&(i&&o[0].total.setValue(t.buildings[1][0].total).multiply("1.78266192e-33"),a("reset1Button").textContent=`Next Rank is ${d(Math.max(r.accretionInfo.rankCost[t.accretion.rank]-o[0].total.toNumber(),0),{padding:!0})} Mass`),i&&(C("#massProduction > span").textContent=d(new p(c.producing[1][1]).multiply("1.78266192e-33"),{padding:!0}),C("#dustCap > span").textContent=d(r.inflationInfo.dustCap,{padding:!0}),a("dustCapRatio").textContent=d(new p(r.inflationInfo.dustTrue).divide(r.inflationInfo.dustCap),{padding:!0}),C("#submersionBoost > span").textContent=d(y.submersion(),{padding:!0}));else if(s===4||s===5){let{collapseInfo:l}=r,u=y.mass(),m=[y.star[0](),l.neutronEffect,y.star[2]()],h=y.mass(!0)/u*(y.S4Research4(!0)/y.S4Research4())*(1+(y.S5Upgrade2(!0)-y.S5Upgrade2())/r.mergeInfo.galaxyBase)**(t.buildings[5][3].true*2);if(t.strangeness[4][4]<2){let b=r.buildingsInfo.producing[4],S=new p(b[1]).plus(b[3],b[4],b[5]);h*=new p(b[2]).multiply(y.star[0](!0)/y.star[0]()).plus(S).divide(S.plus(b[2])).replaceNaN("1").toNumber()*(y.star[1](!0)/m[1])*(y.star[2](!0)/m[2])}if(s===4){a("reset1Button").textContent=`Collapse is at ${d(l.newMass,{padding:!0})} Mass`,C("#solarMassEffect > span").textContent=d(u,{padding:!0});for(let b=0;b<3;b++)a(`special${b+1}Cur`).textContent=d(t.collapse.stars[b],{padding:"exponent"}),a(`special${b+1}Get`).textContent=d(l.starCheck[b],{padding:"exponent"}),C(`#star${b+1}Effect > span`).textContent=d(m[b],{padding:!0});if(C("#collapseBoostTotal > span").textContent=d(h,{padding:!0}),i){let b=new p(r.inflationInfo.massCap/896499278339628e-81).minus(t.buildings[1][0].current).divide(c.producing[1][1]).toNumber()/r.inflationInfo.globalSpeed;C("#mainCap > span").textContent=d(r.inflationInfo.massCap,{padding:!0}),a("mainCapTill").textContent=isFinite(b)?d(b,{padding:!0}):"Infinity"}}else if(s===5){if(ut(),i){let S=ct()-t.merge.resets;a("reset1Button").textContent=`Can reset ${d(S,{padding:"exponent"})} more time${S!==1?"s":""}`,C("#mainCapS5 > span").textContent=d(r.inflationInfo.massCap,{padding:!0})}else a("reset1Button").textContent=`Requires ${d(22+2*t.buildings[6][1].true,{padding:"exponent"})} Galaxies`;for(let S=0;S<1;S++)a(`special${S+1}Cur`).textContent=d(t.merge.reward[S],{padding:"exponent"}),a(`special${S+1}Get`).textContent=d(r.mergeInfo.checkReward[S],{padding:"exponent"}),C(`#merge${S+1}Effect > span`).textContent=d(y.reward[S](),{padding:!0});let b=r.buildingsInfo.producing[4];C("#elementsProductionS5 > span").textContent=d(new p(b[1]).plus(b[2],b[3],b[4],b[5]),{padding:!0}),C("#collapseBoostTotalS5 > span").textContent=d(h,{padding:!0}),C("#mainCapCurrentS5 > span").textContent=d(l.newMass,{padding:!0})}}else s===6&&(C("#cosmonGain > span").textContent=d(i?o[1].true+1:1,{padding:"exponent"}));let g=i?5:s>=6?t.stage.current:s;g<4?(a("stageReward").textContent=d(y.strangeGain(g),{padding:!0}),s<4&&(a("stageReset").textContent=se(s)?"Requirements are met":`Requires ${s===3?`${d(245576045e23)} Mass`:s===2?`${d(119444e24)} Drops`:`${d(167133125e13)} Molecules`}`)):a("stageReward").textContent=d(r.strangeInfo.quarksGain,{padding:!0}),C("#stageTime > span").textContent=d(t.stage.time,{type:"time"}),C("#stageTimeReal > span").textContent=d(t.time.stage,{type:"time"})}else if(n.stageCurrent==="Advanced"){C("#globalSpeed > span").textContent=d(r.inflationInfo.globalSpeed,{padding:!0}),C("#universeTime > span").textContent=d(t.inflation.age,{type:"time"}),C("#universeTimeReal > span").textContent=d(t.time.universe,{type:"time"});let c=a("challengeTime",!0);c!==null&&(c.textContent=d((t.inflation.tree[0]>=1&&t.inflation.tree[4]<1?900:3600)-t.time.stage,{type:"time"}))}}else if(e==="upgrade"||e==="Elements"){let c=e==="Elements"?e:n.upgradeCurrent;if(c==="Upgrades"){let f=r.lastUpgrade[s];f[0]!==null&&De(f[0],f[1])}else c==="Elements"&&Number(r.lastElement)>=1&&De(r.lastElement,"elements")}else if(e==="strangeness"){if(n.strangenessCurrent==="Matter"){let c=i?5:s>=6?t.stage.current:s,f=c<4?y.strangeGain(c):r.strangeInfo.quarksGain;if(a("strange0Gain").textContent=d(f,{padding:!0}),a("strange1Gain").textContent=d(y.strangeGain(c,1),{padding:!0}),a("strangeRate").textContent=d(f/t.time.stage,{type:"income"}),a("strangePeak").textContent=c<4?"Interstellar Stage only":d(t.stage.peak,{type:"income"}),a("strange0Cur").textContent=d(t.strange[0].current,{padding:!0}),a("strange1Cur").textContent=d(t.strange[1].current,{padding:!0}),a("stageTimeStrangeness").textContent=d(t.time.stage,{type:"time"}),a("stageTimeBestReset").textContent=d(t.history.stage.best[0],{type:"time"}),a("strangeletsEffectsMain").style.display===""){let l=r.strangeInfo.strangeletsInfo;a("strangeletsEffect1Stat0").textContent=d(l[0]*100,{padding:!0}),c>=4&&(a("strangeletsEffect1Stat1").textContent=d(se(5)?l[0]*f/t.time.stage:0,{type:"income"})),a("strangeletsEffect2Stat").textContent=d(l[1],{padding:!0})}if(a("quarksEffectsMain").style.display===""){let{stageBoost:l}=r.strangeInfo,{strangeness:u}=t;a("quarksEffect1Stat").textContent=d(u[1][6]>=1?l[1]:1,{padding:!0}),a("quarksEffect2Stat").textContent=d(u[2][6]>=1?l[2]:1,{padding:!0}),a("quarksEffect3Stat").textContent=d(u[3][7]>=1?l[3]:1,{padding:!0}),a("quarksEffect4Stat").textContent=d(u[4][7]>=1?l[4]:1,{padding:!0}),a("quarksEffect5Stat").textContent=d(u[5][7]>=1?l[5]:1,{padding:!0})}let g=r.lastStrangeness;g[0]!==null&&dt(g[0],g[1],"strangeness")}else if(n.strangenessCurrent==="Milestones"){let{milestonesInfo:c,lastMilestone:f}=r,g=t.time.stage,l=t.inflation.tree;for(let u=1;u<c.length;u++)for(let m=0;m<c[u].need.length;m++)a(`milestone${m+1}Stage${u}Current`).textContent=d(Tt(m,u),{padding:!0}),a(`milestone${m+1}Stage${u}Required`).textContent=!i&&t.milestones[u][m]>=c[u].max[m]?"Maxed":(i?(l[0]>=1&&l[4]<1?900:3600)<g:l[4]<1&&c[u].time[m]/(l[0]>=1?4:1)<g)?"No time":d(c[u].need[m],{padding:!0});f[0]!==null&&dt(f[0],f[1],"milestones")}}else if(e==="inflation")n.inflationCurrent==="Researches"&&r.lastInflation!==null&&De(r.lastInflation,"inflation");else if(e==="settings"){if(n.settingsCurrent==="Settings"){let c=t.time.export,f=Math.min(c[0]/86400,1);a("exportQuarks").textContent=d((c[1]/2.5+1)*f,{padding:!0}),a("exportStrangelets").textContent=d(c[2]/2.5*f,{padding:!0}),r.lastSave>=1&&(a("isSaved").textContent=`${d(r.lastSave,{type:"time"})} ago`)}else if(n.settingsCurrent==="Stats"){a("firstPlayAgo").textContent=d((Date.now()-t.time.started)/1e3,{type:"time"}),a("onlineTotal").textContent=d(t.time.online,{type:"time"}),C("#stageResets > span").textContent=d(t.stage.resets,{padding:"exponent"});let c=t.time.export;if(a("exportQuarksMax").textContent=d(c[1]/2.5+1,{padding:!0}),a("exportStrangeletsMax").textContent=d(c[2]/2.5,{padding:!0}),a("exportTimeToMax").textContent=d(86400-c[0],{type:"time"}),s===1){C("#dischargeStat > span").textContent=d(r.dischargeInfo.total,{padding:"exponent"}),a("dischargeStatTrue").textContent=` [${d(t.discharge.current,{padding:"exponent"})}]`;for(let f=1;f<=(i?5:1);f++){let g=t.buildings[f],l=r.dischargeInfo.energyType[f];for(let u=1;u<r.buildingsInfo.maxActive[f];u++)C(`#energyGainStage${f}Build${u+(i?0:2)} > span`).textContent=d(l[u]*g[u].true,{padding:"exponent"}),a(`energyGainStage${f}Build${u+(i?0:2)}Per`).textContent=d(l[u])}C("#maxEnergyStat > span").textContent=d(t.discharge.energyMax,{padding:"exponent"})}else if(s===2){let f=new p(y.clouds(!0)).divide(y.clouds()).toNumber();C("#cloudStat > span").textContent=d(f,{padding:!0});let g=y.S2Extra1(t.researchesExtra[2][1]),l=y.S2Extra1(t.researchesExtra[2][1],!0),u=l/g,m=y.S2Extra2(l)/y.S2Extra2(g);if(C("#rainStat > span").textContent=d(u,{padding:!0}),C("#stormStat > span").textContent=d(m,{padding:!0}),a("cloudEffectTotal").textContent=d(f*u*m,{padding:!0}),C("#maxCloudStat > span").textContent=d(t.vaporization.cloudsMax,{padding:!0}),i){let h=t.buildings[1][5];o[0].total.setValue(h.total).divide("6.02214076e23"),o[0].trueTotal.setValue(h.trueTotal).divide("6.02214076e23")}}else if(s===3){if(a("currentRank").textContent=`${t.accretion.rank}`,i){let f=t.buildings[1][0];o[0].total.setValue(f.total).multiply("1.78266192e-33"),o[0].trueTotal.setValue(f.trueTotal).multiply("1.78266192e-33")}}else if(s===4||s===5){if(C("#maxSolarMassStat > span").textContent=d(t.collapse.massMax,{padding:!0}),s===4){let f=t.strangeness[4][4]>=2,g=y.mass(!0)/y.mass();C("#solarMassStat > span").textContent=d(g,{padding:!0});let l=1;if(!f){let S=r.buildingsInfo.producing[4],T=new p(S[1]).plus(S[3],S[4],S[5]);l=new p(S[2]).multiply(y.star[0](!0)/y.star[0]()).plus(T).divide(T.plus(S[2])).replaceNaN("1").toNumber()}let u=f?1:y.star[1](!0)/r.collapseInfo.neutronEffect,m=f?1:y.star[2](!0)/y.star[2]();f||(C("#star1Stat > span").textContent=d(l,{padding:!0}),C("#star2Stat > span").textContent=d(u,{padding:!0}),C("#star3Stat > span").textContent=d(m,{padding:!0}));let h=y.S4Research4(!0)/y.S4Research4();C("#gammaRayStat > span").textContent=d(h,{padding:!0});let b=(1+(y.S5Upgrade2(!0)-y.S5Upgrade2())/r.mergeInfo.galaxyBase)**t.buildings[5][3].true;C("#quasarStat > span").textContent=d(b,{padding:!0}),a("starTotal").textContent=d(g*l*u*m*h*b**2,{padding:!0})}else if(s===5){a("trueStarsStat").textContent=d(r.collapseInfo.trueStars,{padding:"exponent"});let f=t.buildings[4];o[0].current.setValue(f[1].current).plus(f[2].current,f[3].current,f[4].current,f[5].current),o[0].total.setValue(f[1].total).plus(f[2].total,f[3].total,f[4].total,f[5].total),o[0].trueTotal.setValue(f[1].trueTotal).plus(f[2].trueTotal,f[3].trueTotal,f[4].trueTotal,f[5].trueTotal)}}else s===6&&(a("vacuumResets").textContent=d(t.inflation.resets,{padding:"exponent"}));for(let f=0;f<r.buildingsInfo.maxActive[s];f++)a(`building${f}StatTotal`).textContent=d(o[f].total,{padding:!0}),a(`building${f}StatTrueTotal`).textContent=d(o[f].trueTotal,{padding:!0});a("strange0StatTotal").textContent=d(t.strange[0].total,{padding:!0}),a("strange1StatTotal").textContent=d(t.strange[1].total,{padding:!0}),a("cosmonStatTotal").textContent=d(t.cosmon.total,{padding:"exponent"})}}},ue=()=>{let{tab:e,subtab:n}=r,{active:s,true:o}=t.stage,i=t.inflation.vacuum;if(t.events[0]||(o===5?s===5&&(ce(5,0),G("soft")):o===4?t.collapse.stars[1]>=1&&ce(4,0):o===3?t.buildings[3][0].current.moreOrEqual("5e29")&&(ce(3,0),$e(),r.debug.rankUpdated=null):o===2?(Ze(),new p(r.vaporizationInfo.get).plus(t.vaporization.clouds).moreThan("1e4")&&ce(2,0)):o===1&&t.upgrades[1][9]===1&&ce(1,0)),r.footer&&(v.toggles[1]&&(a("ElementsTabBtn").style.display=t.upgrades[4][1]===1?"":"none"),s===1?o<2&&(a("footerStat2").style.display=t.discharge.energyMax>=12?"":"none",a("upgradeTabBtn").style.display=t.discharge.energyMax>=12?"":"none"):s===2&&(a("footerStat3").style.display=t.upgrades[2][2]===1?"":"none")),v.MDSettings[0]){let c=e==="stage"||e==="upgrade"||e==="Elements"||e==="inflation";a("structuresFooter").style.display=c?"":"none",c&&(s===1?c=t.upgrades[1][5]===1:s===2?c=t.upgrades[2][2]===1:s===4?c=t.upgrades[4][0]===1:s===5?c=t.upgrades[5][3]===1:s===6&&(c=!1)),s===4?a("resetGalaxyFooter").style.display=c&&t.researchesExtra[5][0]>=1?"":"none":s===5&&(a("resetCollapseFooter").style.display=c?"":"none"),a("reset1Footer").style.display=c?"":"none",a("stageFooter").style.display=e==="stage"&&(o>=2||t.upgrades[1][9]===1)||e==="strangeness"?"":"none"}if(e==="stage")if(n.stageCurrent==="Structures"){let c=t.buildings[s],f=t.ASR[s];a("stageTimeReal").style.display=t.stage.time!==t.time.stage?"":"none",a("exportMaxed").style.display=t.time.export[0]>=86400&&(t.stage.true>=7||t.strange[0].total>0)?"":"none",o<2&&(a("toggleBuilding0").style.display=f>=1?"":"none");for(let g=1;g<r.buildingsInfo.maxActive[s];g++)a(`building${g}True`).style.display=c[g].current.notEqual(c[g].true)?"":"none",a(`toggleBuilding${g}`).style.display=f>=g?"":"none";if(s===1)a("reset1Main").style.display=t.upgrades[1][5]===1?"":"none",a("building2").style.display=c[1].trueTotal.moreOrEqual(i?"5":"18")?"":"none",a("building3").style.display=c[2].trueTotal.moreOrEqual("2")?"":"none",i&&(a("building4").style.display=c[3].trueTotal.moreOrEqual("18")?"":"none",a("building5").style.display=c[4].trueTotal.moreOrEqual("2")?"":"none"),a("stageInfo").style.display=t.upgrades[1][5]===1?"":"none",a("tritiumEffect").style.display=t.upgrades[1][8]===1?"":"none",o<7&&(o<2&&(a("resetStage").style.display=t.upgrades[1][9]===1?"":"none"),a("resets").style.display=t.stage.resets>=1||t.upgrades[1][5]===1?"":"none");else if(s===2)a("reset1Main").style.display=t.upgrades[2][2]===1?"":"none",a("building2").style.display=c[1].trueTotal.moreOrEqual("4e2")?"":"none",a("building3").style.display=c[1].trueTotal.moreOrEqual("8e6")?"":"none",a("building4").style.display=c[1].trueTotal.moreOrEqual("8e17")?"":"none",a("building5").style.display=c[1].trueTotal.moreOrEqual("8e22")?"":"none",a("cloudEffect").style.display=t.upgrades[2][2]===1?"":"none",a("vaporizationBoostTotal").style.display=t.upgrades[2][2]===1?"":"none",i?a("building6").style.display=c[1].trueTotal.moreOrEqual("2e25")?"":"none":a("stageInfo").style.display=t.upgrades[2][2]===1?"":"none";else if(s===3){let g=t.upgrades[3];a("buildings").style.display=t.accretion.rank>=1?"":"none",a("building2").style.display=g[2]===1||c[2].trueTotal.moreThan("0")?"":"none",a("building3").style.display=g[4]===1||c[3].trueTotal.moreThan("0")?"":"none",a("building4").style.display=g[8]===1||c[4].trueTotal.moreThan("0")?"":"none",a("dustSoftcap").style.display=r.accretionInfo.dustSoft!==1?"":"none",i?(a("building5").style.display=g[11]===1||c[5].trueTotal.moreThan("0")?"":"none",a("submersionBoost").style.display=t.researchesExtra[1][2]>=2?"":"none"):a("stageInfo").style.display=r.accretionInfo.dustSoft!==1?"":"none",yn()}else if(s===4){let g=t.researchesExtra[4][0];a("reset1Main").style.display=t.upgrades[4][0]===1?"":"none",a("specials").style.display=c[2].trueTotal.moreThan("0")?"":"none",a("special2").style.display=c[3].trueTotal.moreThan("0")?"":"none",a("special3").style.display=c[4].trueTotal.moreThan("0")?"":"none",a("building2").style.display=g>=1?"":"none",a("building3").style.display=g>=2?"":"none",a("building4").style.display=g>=3?"":"none",a("star1Effect").style.display=c[2].trueTotal.moreThan("0")?"":"none",a("star2Effect").style.display=c[3].trueTotal.moreThan("0")?"":"none",a("star3Effect").style.display=c[4].trueTotal.moreThan("0")?"":"none",a("collapseBoostTotal").style.display=t.upgrades[4][0]===1?"":"none",i&&(a("building5").style.display=t.elements[26]>=1?"":"none",a("mainCap").style.display=t.upgrades[4][0]===1?"":"none")}else s===5&&(a("reset1Main").style.display=t.upgrades[5][3]===1?"":"none",i?(a("specials").style.display=t.upgrades[5][3]===1?"":"none",a("mergeEffects").style.display=t.upgrades[5][3]===1?"":"none"):(a("buildings").style.display=t.milestones[2][0]>=7||t.milestones[3][0]>=7?"":"none",a("building1").style.display=t.milestones[2][0]>=7?"":"none",a("building2").style.display=t.milestones[3][0]>=7?"":"none"),a("building3").style.display=t.researchesExtra[5][0]>=1?"":"none")}else n.stageCurrent==="Advanced"&&(a("globalSpeed").style.display=r.inflationInfo.globalSpeed!==1?"":"none",a("universeTimeReal").style.display=t.inflation.age!==t.time.universe?"":"none");else if(e==="upgrade"||e==="Elements"){let c=e==="Elements"?e:n.upgradeCurrent;if(c==="Upgrades")if(i&&(a("researchAuto1").style.display=t.researchesExtra[1][2]>=2?"":"none",a("researchAuto2").style.display=t.accretion.rank>=6?"":"none"),s===1){let f=t.upgrades[1][5]===1;a("upgrade7").style.display=f?"":"none",a("upgrade8").style.display=f?"":"none",a("upgrade9").style.display=f?"":"none",a("upgrade10").style.display=f?"":"none",a("researches").style.display=f?"":"none",i&&(a("researchExtra2").style.display=t.researchesExtra[1][2]>=2?"":"none",a("researchExtra4").style.display=t.researchesExtra[1][2]>=1?"":"none",a("researchExtra5").style.display=t.accretion.rank>=6?"":"none")}else if(s===2){let f=t.buildings[2];a("upgrade2").style.display=f[2].trueTotal.moreThan("0")?"":"none",a("upgrade3").style.display=f[3].trueTotal.moreThan("0")?"":"none",a("upgrade4").style.display=f[2].trueTotal.moreThan("0")?"":"none",a("upgrade5").style.display=f[2].trueTotal.moreThan("0")?"":"none",a("upgrade6").style.display=f[3].trueTotal.moreThan("0")?"":"none",a("upgrade7").style.display=f[4].trueTotal.moreThan("0")?"":"none",a("upgrade8").style.display=t.strangeness[2][2]>=3&&f[5].trueTotal.moreThan("0")?"":"none",i&&(a("upgrade9").style.display=t.strangeness[2][8]>=3&&f[6].trueTotal.moreThan("0")?"":"none",a("researchExtra4").style.display=t.accretion.rank>=6?"":"none"),a("research2").style.display=f[2].trueTotal.moreThan("0")?"":"none",a("research3").style.display=f[2].trueTotal.moreThan("0")?"":"none",a("research4").style.display=f[2].trueTotal.moreThan("0")?"":"none",a("research5").style.display=f[3].trueTotal.moreThan("0")?"":"none",a("research6").style.display=f[4].trueTotal.moreThan("0")?"":"none",a("extraResearches").style.display=t.upgrades[2][2]===1?"":"none",a("researchExtra3").style.display=f[5].trueTotal.moreThan("0")?"":"none"}else if(s===3){let f=t.accretion.rank,g=t.buildings[3][2].trueTotal.moreThan("0");a("upgrade3").style.display=f>=2?"":"none",a("upgrade4").style.display=g?"":"none",a("upgrade5").style.display=f>=3?"":"none",a("upgrade6").style.display=f>=4||t.upgrades[3][4]===1?"":"none",a("upgrade7").style.display=f>=4?"":"none",a("upgrade8").style.display=f>=4&&t.strangeness[3][2]>=3?"":"none",a("upgrade9").style.display=f>=4?"":"none",a("upgrade10").style.display=f>=4?"":"none",a("upgrade11").style.display=f>=5?"":"none",a("upgrade12").style.display=f>=5?"":"none",a("upgrade13").style.display=f>=5?"":"none",a("research3").style.display=g?"":"none",a("research4").style.display=g?"":"none",a("research5").style.display=f>=3?"":"none",a("research6").style.display=f>=3?"":"none",a("research7").style.display=f>=4||t.upgrades[3][4]===1?"":"none",a("research8").style.display=f>=4?"":"none",a("research9").style.display=f>=5?"":"none",a("extraResearches").style.display=f>=2?"":"none",a("researchExtra2").style.display=f>=3?"":"none",a("researchExtra3").style.display=f>=4?"":"none",a("researchExtra4").style.display=f>=5?"":"none",i?a("researchExtra5").style.display=f>=3&&t.researchesExtra[1][2]>=2?"":"none":(a("upgrades").style.display=f>=1?"":"none",a("stageResearches").style.display=f>=1?"":"none")}else if(s===4){let{strangeness:f}=t,g=t.collapse.stars,l=t.researchesExtra[5][0]>=1;a("upgrade4").style.display=f[4][2]>=3?"":"none",a("upgrade5").style.display=f[4][9]>=1?"":"none",a("research4").style.display=(l||g[0]>0)&&f[4][2]>=1?"":"none",a("research5").style.display=l||g[2]>0?"":"none",a("research6").style.display=(l||g[2]>0)&&f[4][9]>=3?"":"none",a("researchExtra2").style.display=l||g[0]>0?"":"none",a("researchExtra3").style.display=(l||g[0]>0)&&f[4][2]>=2?"":"none",a("researchExtra4").style.display=(l||g[1]>0)&&f[4][9]>=2?"":"none"}else if(s===5){if(!i){let f=t.milestones[2][0]>=7,g=t.milestones[3][0]>=7;a("upgrades").style.display=f||g?"":"none",a("upgrade1").style.display=f?"":"none",a("upgrade2").style.display=g?"":"none",a("stageResearches").style.display=f||g?"":"none",a("research1").style.display=f?"":"none",a("research2").style.display=g?"":"none",a("extraResearches").style.display=t.milestones[4][1]>=8?"":"none"}a("upgrade3").style.display=t.researchesExtra[5][0]>=1?"":"none",a("upgrade4").style.display=t.researchesExtra[5][0]>=1&&(i?t.accretion.rank>=7:t.milestones[5][1]>=8)?"":"none"}else s===6&&(a("upgrades").style.display="none",a("stageResearches").style.display="none");else if(c==="Elements"){let f=t.upgrades[4],g=t.upgrades[4][2]===1&&(t.collapse.stars[1]>0||t.researchesExtra[5][0]>=1),l=17-(f[3]===1?0:2)-(f[4]===1?0:1);a("elementsGrid").style.display=f[2]===1?"":"flex";for(let u=6;u<=10;u++)a(`element${u}`).style.display=f[2]===1?"":"none";for(let u=11;u<=26;u++)a(`element${u}`).style.display=g?"":"none";if(!g)l=8;else if(t.collapse.show<23){for(let u=26;u>Math.max(t.collapse.show+3,10);u--)a(`element${u}`).style.display="none";l=Math.max(t.collapse.show-9,8)}a("element27").style.display=f[3]===1?"":"none",a("element28").style.display=f[3]===1?"":"none";for(let u=29;u<r.elementsInfo.name.length;u++)a(`element${u}`).style.display=f[4]===1&&t.buildings[6][1].true>=u-29?"":"none";document.documentElement.style.setProperty("--elements-columns",`${l}`)}}else if(e==="strangeness"){if(n.strangenessCurrent==="Matter"){let c=t.strangeness[5][8]>=1||t.inflation.tree[3]>=1;if(a("strange1").style.display=c||t.cosmon.total>=2?"":"none",a("strange1Unlocked").style.display=c?"":"none",i){let f=t.strangeness[5][3]>=1,g=t.challenges.void;a("strange8Stage1").style.display=g[1]>=1?"":"none",a("strange9Stage1").style.display=g[1]>=2||r.milestonesInfoS6.active[0]?"":"none",a("strange10Stage1").style.display=g[4]>=2?"":"none",a("strange8Stage2").style.display=g[1]>=3?"":"none",a("strange9Stage2").style.display=g[2]>=1?"":"none",a("strange10Stage2").style.display=g[2]>=2?"":"none",a("strange9Stage3").style.display=g[4]>=4?"":"none",a("strange10Stage3").style.display=g[5]>=2?"":"none",a("strange9Stage4").style.display=g[4]>=3?"":"none",a("strange10Stage4").style.display=g[5]>=1?"":"none",a("strange1Stage5").style.display=f?"":"none",a("strange2Stage5").style.display=f?"":"none",a("strange5Stage5").style.display=f&&(g[4]>=1||r.milestonesInfoS6.active[1])?"":"none",a("strange6Stage5").style.display=f?"":"none",a("strange8Stage5").style.display=f?"":"none",a("strange9Stage5").style.display=g[3]>=5?"":"none"}else{let{milestones:f}=t,g=f[4][0]>=8,l=f[2][0]>=7||f[3][0]>=7;a("strange7Stage1").style.display=g?"":"none",a("strange7Stage2").style.display=g?"":"none",a("strange8Stage3").style.display=g?"":"none",a("strange8Stage4").style.display=g?"":"none",a(`strangeness${v.MDSettings[0]?"Page":"Section"}5`).style.display=g?"":"none",a("strange1Stage5").style.display=l?"":"none",a("strange2Stage5").style.display=l?"":"none",a("strange3Stage5").style.display=f[5][0]>=8?"":"none",a("strange4Stage5").style.display=l?"":"none",a("strange5Stage5").style.display=f[4][1]>=8?"":"none",a("strange6Stage5").style.display=l?"":"none"}}else if(n.strangenessCurrent==="Milestones"&&!i){let c=t.milestones[4];a("milestone1Stage5Div").style.display=c[0]>=8?"":"none",a("milestone2Stage5Div").style.display=c[1]>=8?"":"none",r.stageInfo.activeAll.includes(4)&&(a("milestonesStage5Progress").style.display=c[0]>=8?"":"none"),r.stageInfo.activeAll.includes(5)&&(a("milestone2Stage5Progress").style.display=c[1]>=8?"":"none")}}else if(e==="inflation"){if(n.inflationCurrent==="Milestones"){let c=r.milestonesInfoS6.active;for(let f=0;f<c.length;f++)a(`inflationMilestone${f+1}`).classList[c[f]?"add":"remove"]("completed")}}else if(e==="settings"){if(n.settingsCurrent==="Settings"){let{researchesAuto:c,strangeness:f}=t;a("exportStrangeletsUnlocked").style.display=f[5][8]>=1||t.inflation.tree[3]>=1?"":"none",a("toggleAuto0").style.display=f[5][6]>=1?"":"none",a("toggleAuto0Main").style.display=f[5][6]>=(i?1:2)?"":"none",a("autoTogglesUpgrades").style.display=c[0]>=1||c[1]>=2?"":"none",a("autoToggle5").style.display=c[0]>=1?"":"none",a("autoToggle6").style.display=c[0]>=2?"":"none",a("autoToggle7").style.display=c[0]>=3?"":"none",a("autoToggle8").style.display=c[1]>=2?"":"none",a("toggleAuto1").style.display=f[1][4]>=1||c[2]>=1&&(i||t.stage.current===1)?"":"none";let g=f[2][4]>=1||(i?c[2]>=3:c[2]>=1&&t.stage.current===2);a("toggleAuto2").style.display=g?"":"none",a("toggleAuto2Main").style.display=g?"":"none",a("toggleAuto3").style.display=f[3][4]>=1||(i?c[2]>=2:c[2]>=1&&t.stage.current===3)?"":"none";let l=f[4][4]>=1||(i?c[2]>=4:c[2]>=1&&t.stage.current>=4);if(a("toggleAuto4").style.display=l?"":"none",a("toggleAuto4Main").style.display=l?"":"none",o<7){let u=a("stageHotkey",!0);o<2&&(a("resetToggles").style.display=t.upgrades[1][5]===1?"":"none",a("stageToggleReset").style.display=t.upgrades[1][9]===1?"":"none",u!==null&&(u.style.display=t.upgrades[1][9]===1?"":"none",a("dischargeHotkey").style.display=t.upgrades[1][5]===1?"":"none")),o<3&&(a("vaporizationToggleReset").style.display=t.upgrades[2][2]===1?"":"none",u!==null&&(a("vaporizationHotkey").style.display=t.upgrades[2][2]===1?"":"none")),o<5&&(a("collapseToggleReset").style.display=t.upgrades[4][0]===1?"":"none",a("elementsAsTab").style.display=t.upgrades[4][1]===1?"":"none",u!==null&&(a("collapseHotkey").style.display=t.upgrades[4][0]===1?"":"none")),o<6&&(a("saveFileNameGalaxy").style.display=t.milestones[4][1]>=8?"":"none",u!==null&&(a("galaxyHotkey").style.display=t.milestones[4][1]>=8?"":"none")),a("vaporizationExtra").style.display=t.challenges.void[4]>=1?"":"none",a("exportReward").style.display=t.stage.resets>=(i?1:4)?"":"none",a("mergeToggleReset").style.display=i&&t.upgrades[5][3]===1?"":"none",u!==null&&(a("mergeHotkey").style.display=t.upgrades[5][3]===1?"":"none")}}else if(n.settingsCurrent==="History")bn(),vn();else if(n.settingsCurrent==="Stats"){let{strangeness:c}=t,f=t.buildings[s];a("firstPlay").textContent=new Date(t.time.started).toLocaleString(),a("exportStrangeletsMaxUnlocked").style.display=c[5][8]>=1||t.inflation.tree[3]>=1?"":"none",o<7&&(a("exportStats").style.display=t.stage.resets>=(i?1:4)?"":"none");for(let g=1;g<r.buildingsInfo.maxActive[s];g++)a(`building${g}Stats`).style.display=f[g].trueTotal.moreThan("0")?"":"none";if(a("strangeAllStats").style.display=t.strange[0].total>0?"":"none",a("strange1Stats").style.display=t.strange[1].total>0?"":"none",a("maxSolarMassStat").style.display=s===4||s===5?"":"none",s===1){a("dischargeStat").style.display=t.upgrades[1][5]===1?"":"none",a("dischargeStatTrue").style.display=t.discharge.current!==r.dischargeInfo.total?"":"none";for(let g=1;g<=(i?5:1);g++){let l=!1;for(let u=1;u<r.buildingsInfo.maxActive[g];u++){let m=t.buildings[g][u].trueTotal.moreThan("0");l||(l=m),a(`energyGainStage${g}Build${u+(i?0:2)}Name`).style.display=m?"":"none",a(`energyGainStage${g}Build${u+(i?0:2)}`).style.display=m?"":"none"}a(g===1?"energyGainStats":`energyGainStage${g}`).style.display=l?"":"none"}o<2&&(a("maxEnergyStat").style.display=t.discharge.energyMax>=12?"":"none")}else if(s===2)a("vaporizationBoost").style.display=t.upgrades[2][2]===1?"":"none",a("rainStat").style.display=t.researchesExtra[2][1]>=1?"":"none",a("stormStat").style.display=t.researchesExtra[2][2]>=1?"":"none",a("maxCloudStat").style.display=t.upgrades[2][2]===1?"":"none";else if(s===3){i&&(a("rankStat0").style.display=c[2][9]>=1?"":"none");for(let g=1;g<r.accretionInfo.rankImage.length;g++)a(`rankStat${g}`).style.display=t.accretion.rank>=g?"":"none"}else if(s===4){let g=c[4][4]>=2;a("star1Stat").style.display=!g&&f[2].trueTotal.moreThan("0")?"":"none",a("star2Stat").style.display=!g&&f[3].trueTotal.moreThan("0")?"":"none",a("star3Stat").style.display=!g&&f[4].trueTotal.moreThan("0")?"":"none",a("gammaRayStat").style.display=t.elements[26]>=1||t.researches[4][4]>=1?"":"none",a("quasarStat").style.display=t.researchesExtra[5][0]>=1?"":"none"}else if(s===6){let g=a("vacuumState");g.textContent=i?"True":"False",g.style.color=`var(--${i?"green":"red"}-text)`}}}},He=()=>{let e=t.stage.true,n=a("stageHotkey",!0);if(t.inflation.vacuum||(a("mergeResetText").innerHTML=`Attempt to <span class="darkvioletText">Merge</span> <span class="grayText">Galaxies</span> together${e>=7?', which will result in <span class="orchidText">Vacuum</span> decaying into its true state':" to create even bigger Structures. Might have severe consequences"}.`),a("stageRewardOld").style.display=e<5?"":"none",a("stageRewardNew").style.display=e>=5?"":"none",a("autoWaitMain").style.display=e>=3?"":"none",a("researchAuto3").style.display=e>=7?"":"none",a(v.MDSettings[0]?"toggleHover0":"researchToggles").style.display=e>=2?"":"none",a("toggleMax0").style.display=e>=4?"":"none",a("themeArea").style.display=e>=2?"":"none",a("switchTheme3").style.display=e>=3?"":"none",a("switchTheme4").style.display=e>=4?"":"none",a("switchTheme5").style.display=e>=5?"":"none",a("switchTheme6").style.display=e>=7?"":"none",a("saveFileNameStrange").style.display=e>=5?"":"none",a("saveFileNameVacuum").style.display=e>=6?"":"none",a("saveFileNameUniverse").style.display=e>=7?"":"none",a("saveFileNameCosmon").style.display=e>=7?"":"none",a("autoStageSwitch").style.display=e>=5?"":"none",a("stageResets").style.display=e>=2?"":"none",a("cosmonStat").style.display=e>=7?"":"none",a("vacuumHistory").style.display=e>=7?"":"none",n!==null&&(a("stageRightHotkey").style.display=e>=5?"":"none",a("stageLeftHotkey").style.display=e>=5?"":"none"),e>=2&&(a("resetStage").style.display="",a("toggleBuilding0").style.display="",a("resetToggles").style.display="",a("stageToggleReset").style.display="",a("maxEnergyStat").style.display="",a("upgradeTabBtn").style.display="",n!==null&&(n.style.display="")),e>=5&&(a("elementsAsTab").style.display=""),e>=6){a("saveFileNameGalaxy").style.display="";for(let s=2;s<=5;s++)a(`strangeness${v.MDSettings[0]?"Page":"Section"}${s}`).style.display="",a(`milestone1Stage${s}Div`).style.display="",a(`milestone2Stage${s}Div`).style.display=""}e>=7&&(a("vaporizationExtra").style.display="",a("dischargeToggleReset").style.display="",a("vaporizationToggleReset").style.display="",a("rankToggleReset").style.display="",a("collapseToggleReset").style.display="",a("mergeToggleReset").style.display=t.inflation.vacuum?"":"none",a("strangenessTabBtn").style.display="",a("exportReward").style.display="",a("exportStats").style.display="")},De=(e,n)=>{if(n==="inflation"){let i=r.inflationTreeInfo;a("inflationText").textContent=`${i.name[e]}. (Level ${d(t.inflation.tree[e])} out of ${d(i.max[e])})`,a("inflationEffect").textContent=i.effectText[e](),a("inflationCost").textContent=t.inflation.tree[e]>=i.max[e]?"Fully activated.":`${d(i.cost[e])} Cosmon.`;return}if(n==="elements"){let i=r.elementsInfo;a("elementText").textContent=`${i.name[e]}.`,a("elementEffect").textContent=t.elements[e]>=1||t.collapse.show>=e&&e!==0?i.effectText[e]():"Effect is not yet known.",a("elementCost").textContent=t.elements[e]>=1?"Obtained.":t.elements[e]>0?"Awaiting Collapse.":e===0?"Unknown.":`${d(i.startCost[e])} Elements.`;return}let s=t.stage.active,o=s===1?"Energy":s===2?"Drops":s===3?"Mass":s===6?"Dark matter":"Elements";if(n==="upgrades"){let i=r[`${n}Info`][s];a("upgradeText").textContent=`${i.name[e]}.`,a("upgradeEffect").textContent=i.effectText[e](),a("upgradeCost").textContent=t.upgrades[s][e]===1?"Created.":s===4&&r.collapseInfo.unlockU[e]>t.collapse.mass&&t.researchesExtra[5][0]<1?`Unlocked at ${d(r.collapseInfo.unlockU[e])} Mass.`:`${d(i.startCost[e])} ${o}.`}else if(n==="researches"||n==="researchesExtra"){let i=r[`${n}Info`][s],c=t[n][s][e];if(n==="researchesExtra"&&s===4&&e===0&&(i.name[0]=["Nova","Supernova","Hypernova"][Math.min(c,2)]),a("upgradeText").textContent=`${i.name[e]}.`,a("upgradeEffect").textContent=i.effectText[e](),c>=i.max[e])a("upgradeCost").textContent="Maxed.";else if(s===4&&n==="researches"&&r.collapseInfo.unlockR[e]>t.collapse.mass&&t.researchesExtra[5][0]<1)a("upgradeCost").textContent=`Unlocked at ${d(r.collapseInfo.unlockR[e])} Mass.`;else{let f=1,g=i.cost[e];if(t.toggles.max[0]&&t.stage.true>=4&&i.max[e]>1){let l=i.scaling[e];if(s===1)if(t.accretion.rank>=6&&t.strangeness[1][9]>=1)f=Math.min(Math.max(Math.floor((t.discharge.energy-g)/l+1),1),i.max[e]-c),f>1&&(g+=(f-1)*l);else{let u=g-l/2;f=Math.min(Math.max(Math.floor(((u**2+2*l*t.discharge.energy)**.5-u)/l),1),i.max[e]-c),f>1&&(g=f*(f*l/2+u))}else{let u=s===2?t.buildings[2][1].current:s===3?t.buildings[3][0].current:t.buildings[4][0].current;f=Math.min(Math.max(Math.floor(new p(u).multiply(l-1).divide(g).plus("1").log(l).toNumber()),1),i.max[e]-c),f>1&&(g=new p(l).power(f).minus("1").divide(l-1).multiply(g).toNumber())}}a("upgradeCost").textContent=`${d(g)} ${o}.${f>1?` [x${d(f)}]`:""}`}}else if(n==="researchesAuto"){let i=r.researchesAutoInfo,c=t.researchesAuto[e];if(a("upgradeText").textContent=`${i.name[e]}.`,a("upgradeEffect").textContent=i.effectText[e](),c>=i.max[e])a("upgradeCost").textContent="Maxed.";else{let f=i.autoStage[e][c];a("upgradeCost").textContent=f===s||s===5&&f===4?`${d(i.costRange[e][Math.max(c-(e===1&&t.strangeness[4][6]>=1?1:0),0)])} ${o}.`:`This level can only be created while inside '${r.stageInfo.word[f]}'.`}}else if(n==="ASR"){let i=r.ASRInfo,c=t.ASR[s];a("upgradeText").textContent=`${i.name}.`,a("upgradeEffect").textContent=i.effectText(),a("upgradeCost").textContent=c>=i.max[s]?"Maxed.":s===3&&t.accretion.rank<1?"Cannot be created at 'Ocean world' Rank.":`${d(i.costRange[s][c])} ${o}.`}},dt=(e,n,s)=>{let o=a(`${s}Stage`);if(o.style.color=`var(--${r.stageInfo.textColor[n]}-text)`,o.textContent=`${r.stageInfo.word[n]}. `,s==="strangeness"){let i=r.strangenessInfo[n];a("strangenessText").textContent=`${i.name[e]}.`,a("strangenessEffect").textContent=i.effectText[e](),a("strangenessCost").textContent=t.strangeness[n][e]>=i.max[e]?"Maxed.":`${d(i.cost[e])} Strange quarks.`}else{let i=r.milestonesInfo[n],c=t.milestones[n][e],f=a("milestonesMultiline"),g;if(a("milestonesText").textContent=`${i.name[e]}. (${d(c)})`,c<i.max[e]){let u=r.stageInfo.activeAll.includes(Math.min(n,4));g=`<p class="orchidText">Requirement: <span class="greenText">${i.needText[e]()}</span></p>
            <p class="blueText">Time limit: <span class="greenText">${d(i.time[e]/(t.inflation.tree[0]>=1?4:1)-(u&&t.inflation.tree[4]<1?t.time.stage:0),{type:"time"})} ${u?"remains ":""}to complete this tier within ${u?"current":r.stageInfo.word[e===0&&n===5?4:n]} Stage.</span></p>
            <p class="darkvioletText">Unlock: <span class="greenText">Main reward unlocked after ${i.max[e]-c} more completions.</span></p>`}else g=`<p class="darkvioletText">Reward: <span class="greenText">${i.rewardText[e]()}</span></p>`;f.innerHTML!==g&&(f.innerHTML=g);let l=f.parentElement;l.style.minHeight=`${l.offsetHeight}px`}},Be=e=>{let n;if(e===null)n='<p class="whiteText">Hover to see</p>';else{let s=t.challenges.active===e,o=r.challengesInfo,i=`${o.color[e]}Text`;n=`<h3 class="${i} bigWord">${o.name[e]}${s?', <span class="greenText">active</span>':""}</h3>
        <p class="whiteText">${o.description[e]()}</p>
        <div><h4 class="${i} bigWord">Effect:</h4>
        <p>${o.effectText[e]()}</p>
        <p class="blueText">${s?"Time will run out in":"Has a time limit of"} <span${s?' id="challengeTime"':""} class="cyanText">${d((t.inflation.tree[0]>=1&&t.inflation.tree[4]<1?900:3600)-(s?t.time.stage:0),{type:"time"})}</span></p></div>`,M.cache.idMap.delete("challengeTime")}if(e===0){let s=t.challenges.voidCheck;a("voidRewards").style.display="",a("voidRewardSubmerged").style.display=s[1]>=3?"":"none",a("voidRewardAccretion").style.display=s[1]>=2?"":"none",a("voidRewardInterstellar").style.display=s[3]>=5?"":"none",a("voidRewardIntergalactic").style.display=s[4]>=4?"":"none"}else a("voidRewards").style.display="none";a("challengeMultiline").innerHTML=n},gt=e=>{let n=r.challengesInfo.needText[0][e],s=r.challengesInfo.rewardText[0][e],o=t.challenges.void[e],i=t.challenges.voidCheck[e],c=t.inflation.tree,f="";for(let g=0;g<n.length;g++){let l=o>g;f+=`<div><p><span class="${l?"greenText":"redText"}">\u2192</span> ${n[g]()}${!l&&!(i>g&&c[4]>=1)&&t.time.stage>(c[0]>=1&&c[4]<1?900:3600)?' <span class="redText">(Failed)</span>':""}</p>
        <p><span class="${l?"greenText":"redText"}">Reward:</span> ${i>g?`${s[g]}${!l&&v.SRSettings[0]?" (Not yet unlocked)":""}`:"Not yet unlocked"}</p></div>`}a("voidRewardsDivText").innerHTML=f},de=(e,n,s)=>{if(s==="upgrades"){if(n!==t.stage.active)return;let o="",i=a(`upgrade${e+1}`);t.upgrades[n][e]===1?(n===1?o="green":n===2?o="darkgreen":n===3?o="#0000b1":n===4?o="#1f1f8f":n===5?o="#990000":n===6&&(o="white"),i.tabIndex=v.SRSettings[0]&&v.SRSettings[1]?0:-1):i.tabIndex=0,i.style.backgroundColor=o}else if(s==="elements"){let o=a(`element${e}`);t.elements[e]>=1?(o.classList.remove("awaiting"),o.classList.add("created"),o.tabIndex=v.SRSettings[0]&&v.SRSettings[1]?0:-1):t.elements[e]>0?(o.classList.add("awaiting"),o.classList.remove("created"),o.tabIndex=0):(o.classList.remove("awaiting"),o.classList.remove("created"),o.tabIndex=0)}},D=(e,n,s)=>{let o,i,c,f;if(s==="researches"||s==="researchesExtra"){if(n!==t.stage.active)return;o=r[`${s}Info`][n].max[e],i=t[s][n][e];let g=s==="researches"?"":"Extra";c=a(`research${g}${e+1}Level`),a(`research${g}${e+1}Max`).textContent=`${o}`,f=a(`research${g}${e+1}Image`)}else if(s==="researchesAuto")o=r.researchesAutoInfo.max[e],i=t.researchesAuto[e],c=a(`researchAuto${e+1}Level`),a(`researchAuto${e+1}Max`).textContent=`${o}`,f=a(`researchAuto${e+1}Image`);else if(s==="ASR"){if(n!==t.stage.active)return;o=r.ASRInfo.max[n],i=t.ASR[n],c=a("ASRLevel"),a("ASRMax").textContent=`${o}`,f=a("ASRImage")}else o=r.strangenessInfo[n].max[e],i=t.strangeness[n][e],c=a(`strange${e+1}Stage${n}Level`),a(`strange${e+1}Stage${n}Max`).textContent=`${o}`,f=a(`strange${e+1}Stage${n}Image`);c.textContent=`${i}`,i>=o?(c.style.color="var(--green-text)",f.tabIndex=v.SRSettings[0]&&v.SRSettings[1]?0:-1):i===0?(c.style.color="",f.tabIndex=0):(c.style.color="var(--orchid-text)",f.tabIndex=0)},Pe=(e=null)=>{let{max:n,startCost:s}=r.inflationTreeInfo,o=t.inflation.tree;if(e!==null&&o[e]<n[e])return;let i=t.cosmon.total,c=v.SRSettings[0]&&v.SRSettings[1];for(let f=0;f<s.length;f++){let g=a(`inflation${f+1}`);g.style.display=i>=s[f]?"":"none",o[f]>=n[f]?(a("inflationCreated").append(g),g.tabIndex=c?0:-1):(a("inflationAvailable").append(g),g.tabIndex=0)}},yn=()=>{let e=t.accretion.rank;if(r.debug.rankUpdated===e)return;let n=r.accretionInfo,s=a("rankName");a("reset1Button").textContent=e>=n.maxRank?"Max Rank achieved":`Next Rank is ${d(n.rankCost[e])} Mass`,a("rankImage").src=`Used_art/${n.rankImage[e]}`,s.textContent=n.rankName[e],s.style.color=`var(--${n.rankColor[e]}-text)`,r.debug.rankUpdated=e},Ie=()=>{if(t.stage.active===4){let e=t.researchesExtra[4][2]>=1;a("special1").title=e?"White dwarfs (Red giants)":"Red giants",C("#special1 > img").src=`Used_art/${e?"White%20dwarf":"Red%20giant"}.png`,a("special1Cur").className=e?"cyanText":"redText";let n=t.researchesExtra[4][3]>=1;a("special2").title=n?"Quark stars (Neutron stars)":"Neutron stars",C("#special2 > img").src=`Used_art/${n?"Missing":"Neutron%20star"}.png`;let s=`Boost${n?" and cost decrease":""} to all Stars`;C("#star2Effect > span:last-of-type").textContent=v.SRSettings[0]?` (${s})`:s}else t.stage.active===5&&(a("special1").title="Galaxy groups",C("#special1 > img").src="Used_art/Missing.png",a("special1Cur").className="grayText")},bn=()=>{if(r.debug.historyStage===t.stage.resets)return;let e=r.historyStorage.stage,n=Math.min(e.length,t.history.stage.input[1]),s="";if(n>0)for(let i=0;i<n;i++)s+=`<li class="whiteText"><span class="greenText">${d(e[i][1],{padding:!0})} Strange quarks</span>${e[i][2]>0?`, <span class="greenText">${d(e[i][2],{padding:!0})} Strangelets</span>`:""}, <span class="blueText">${d(e[i][0],{type:"time"})}</span>, <span class="darkorchidText">${d(e[i][1]/e[i][0],{type:"income"})}</span></li>`;else s='<li class="redText">Reference list is empty</li>';a("stageHistoryList").innerHTML=s;let o=t.history.stage.best;a("stageHistoryBest").innerHTML=`<span class="greenText">${d(o[1],{padding:!0})} Strange quarks</span>${o[2]>0?`, <span class="greenText">${d(o[2],{padding:!0})} Strangelets</span>`:""}, <span class="blueText">${d(o[0],{type:"time"})}</span>, <span class="darkorchidText">${d(r.strangeInfo.bestHistoryRate,{type:"income"})}</span>`,r.debug.historyStage=t.stage.resets},vn=()=>{if(r.debug.historyVacuum===t.inflation.resets)return;let e=r.historyStorage.vacuum,n=Math.min(e.length,t.history.vacuum.input[1]),s="";if(n>0)for(let i=0;i<n;i++)s+=`<li class="whiteText"><span class="darkvioletText">${d(e[i][2],{padding:!0})} Cosmon</span>, <span class="blueText">${d(e[i][0],{type:"time"})}</span>, <span class="darkorchidText">${d(e[i][2]/e[i][0],{type:"income"})}</span>, <span class="${e[i][1]?'greenText">true':'redText">false'} Vacuum</span></li>`;else s='<li class="redText">Reference list is empty</li>';a("vacuumHistoryList").innerHTML=s;let o=t.history.vacuum.best;a("vacuumHistoryBest").innerHTML=`<span class="darkvioletText">${d(o[2],{padding:!0})} Cosmon</span>, <span class="blueText">${d(o[0],{type:"time"})}</span>, <span class="darkorchidText">${d(o[2]/o[0],{type:"income"})}</span>, <span class="${o[1]?'greenText">true':'redText">false'} Vacuum</span>`,r.debug.historyVacuum=t.inflation.resets},d=(e,n={})=>{if(typeof e=="object")return e?.format(n);let s=n.type??"number",o=n.padding,i;if(s==="income"){let u=Math.abs(e);u>=1?i="per second":u>=1/60?(e*=60,i="per minute"):u>=1/3600?(e*=3600,i="per hour"):u>=1/86400?(e*=86400,i="per day"):u>=1/31556952?(e*=31556952,i="per year"):u>=1/31556952e3?(e*=31556952e3,i="per millennium"):u>=1/31556952e6?(e*=31556952e6,i="per megaannum"):(e*=31556952e9,i="per eon"),o===void 0&&(o=!0)}else if(s==="time"){let u=Math.abs(e);if(u<60)i="seconds";else if(u<3600){let m=Math.trunc(e/60),h=Math.trunc(e-m*60);return o===!1&&h===0?`${m} minutes`:`${m} minutes ${h} seconds`}else if(u<86400){let m=Math.trunc(e/3600),h=Math.trunc(e/60-m*60);return o===!1&&h===0?`${m} hours`:`${m} hours ${h} minutes`}else if(u<31556952){let m=Math.trunc(e/86400),h=Math.trunc(e/3600-m*24);return o===!1&&h===0?`${m} days`:`${m} days ${h} hours`}else if(u<31556952e3){let m=Math.trunc(e/31556952),h=Math.trunc(e/86400-m*365.2425);return o===!1&&h===0?`${m} years`:`${m} years ${h} days`}else u<31556952e6?(e/=31556952e3,i="millenniums"):u<31556952e9?(e/=31556952e6,i="megaannums"):(e/=31556952e9,i="eons");o=!(o===!1&&Math.trunc(e)===e)}if(!isFinite(e))return i!==void 0?`${e} ${i}`:`${e}`;let c=Math.abs(e);if(c>=1e6||c<.001&&c>0){let u=Math.floor(Math.log10(c)),m=Math.round(e/10**(u-2))/100;Math.abs(m)===10&&(m/=10,u++),o==="exponent"&&(o=!0);let h=o?m.toFixed(2):`${m}`;return s==="input"?`${h}e${u}`:(h=`${h.replace(".",v.format[0])}e${u}`,i!==void 0?`${h} ${i}`:h)}let f=Math.max(4-Math.floor(Math.log10(Math.max(c,1))),0),g=Math.round(e*10**f)/10**f;o==="exponent"&&(o=!1);let l=o?g.toFixed(f):`${g}`;return s==="input"?l:(l=l.replace(".",v.format[0]),g>=1e3&&(l=l.replace(/\B(?=(\d{3})+(?!\d))/,v.format[1])),i!==void 0?`${l} ${i}`:l)},G=(e="normal")=>{let{stageInfo:n,buildingsInfo:s}=r,{active:o,current:i,true:c,resets:f}=t.stage,g=t.inflation.vacuum,l=t.challenges.active;n.activeAll=[];let u=n.activeAll;g?(u.push(1),t.researchesExtra[1][2]>=2&&u.push(2),i>=2&&u.push(3),i>=4&&u.push(4),i>=5&&t.strangeness[5][3]>=1&&u.push(5)):((i===1||t.milestones[1][1]>=6)&&n.activeAll.push(1),(i===2||t.milestones[2][1]>=7)&&n.activeAll.push(2),(i===3||t.milestones[3][1]>=7)&&n.activeAll.push(3),i>=4&&u.push(4),i>=5&&u.push(5)),(c>=7||i>=6)&&u.push(6);for(let x=1;x<=6;x++){for(let z of $t(`stage${x}Only`))z.style.display=o===x?"":"none";for(let z of $t(`stage${x}Include`))z.style.display=u.includes(x)?"":"none"}let m=a("stageWord");if(m.textContent=n.word[i],m.style.color=`var(--${n.textColor[i]}-text)`,(g||o>=4)&&(a("stageReset").textContent=t.events[0]&&c>=5?i>=5?"Requirements are met":"Requires '[26] Iron' Element":"Requirements are unknown"),a("stageSelect").style.display=u.length>1?"":"none",c<7){let x=g&&f>=1;a("dischargeToggleReset").style.display=x||u.includes(1)?"":"none",a("vaporizationToggleReset").style.display=x||u.includes(2)?"":"none",a("rankToggleReset").style.display=x||u.includes(3)?"":"none",a("collapseToggleReset").style.display=x||u.includes(4)?"":"none",a("strangenessTabBtn").style.display=t.strange[0].total>0||g&&i>=5?"":"none",a("inflationTabBtn").style.display="none"}if(!g){let x=(o>=6?i:o)>=4;if(a("strangeletsEffect1Disabled").style.display=x?"none":"",a("strangeletsEffect1Allowed").style.display=x?"":"none",o>=6&&(a("stageReset").textContent="No Stage resets available"),c<6)for(let z=2;z<=4;z++){let ie=f>=z+3;a(`strangeness${v.MDSettings[0]?"Page":"Section"}${z}`).style.display=ie?"":"none",a(`milestone1Stage${z}Div`).style.display=ie?"":"none",a(`milestone2Stage${z}Div`).style.display=ie?"":"none"}}if(e==="soft"){ue(),J();return}if(v.MDSettings[0]&&(a("reset1Footer").textContent=M.resetHTML[o],e==="reload"&&pt(1)),v.SRSettings[0]){a("reset1Main").ariaLabel=`${M.resetHTML[o]} reset (hotkey ${["","D","V","R","C","Shift + M"][o]})`;for(let x=1;x<s.maxActive[o];x++)a(`building${x}`).ariaLabel=`${s.name[o][x]} (hotkey ${x})`;a("extraResearches").ariaLabel=`${["","Energy","Cloud","Rank","Collapse","Galaxy",""][o]} Researches`,a("SRStage").textContent=`Current active Stage is '${n.word[o]}'`}for(let x of["upgrade","element"])a(`${x}Text`).textContent="Hover to see.",a(`${x}Effect`).textContent="Hover to see.",a(`${x}Cost`).textContent="Resource.";if(e==="reload"){r.trueActive=o,r.debug.timeLimit=!1;for(let x=1;x<=6;x++)a(`${n.word[x]}Switch`).style.textDecoration=o===x?"underline":"",r.lastUpgrade[x][0]=null;r.lastElement=null;for(let x=0;x<r.elementsInfo.startCost.length;x++)de(x,4,"elements");r.lastStrangeness=[null,0],r.lastMilestone=[null,0];for(let x of["strangeness","milestones"])a(`${x}Stage`).textContent="",a(`${x}Text`).textContent="Hover to see.";if(a("strangenessEffect").textContent="Hover to see.",a("strangenessCost").textContent="Strange quarks.",a("milestonesMultiline").innerHTML=`<p class="orchidText">Requirement: <span class="greenText">Hover to see.</span></p><p class="blueText">Time limit: <span class="greenText">Hover to see.</span></p><p class="darkvioletText">${g?"Effect":"Unlock"}: <span class="greenText">Hover to see.</span></p>`,l!==null){a("currentChallenge").style.display="";let x=C("#currentChallenge > span");x.textContent=r.challengesInfo.name[l],x.style.color=`var(--${r.challengesInfo.color[l]}-text)`}else a("currentChallenge").style.display="none";Be(l),Me("all"),le("researches","all"),le("researchesExtra","all"),Ce(),He(),Pe(),_(ge(r.tab)?r.tab:"stage")}let h=r.upgradesInfo[o],b=r.researchesInfo[o],S=r.researchesExtraInfo[o],T=M.footerStatsHTML[o];for(let x=s.maxActive[o];x<M.longestBuilding;x++)a(`building${x}Stats`).style.display="none",a(`building${x}`).style.display="none";for(let x=h.maxActive;x<M.longestUpgrade;x++)a(`upgrade${x+1}`).style.display="none";for(let x=b.maxActive;x<M.longestResearch;x++)a(`research${x+1}`).style.display="none";for(let x=S.maxActive;x<M.longestResearchExtra;x++)a(`researchExtra${x+1}`).style.display="none";for(let x=T.length;x<M.longestFooterStats;x++)a(`footerStat${x+1}`).style.display="none";let E=[],k=[],I=[],$=[];o===1?(E.push(2,3,4,5),k.push(0,1,2,3,4,5),$.push(0,1,2),a("specials").style.display="none",g?(E.push(0,1),I.push(0,2),a("extraResearches").style.display=""):(a("upgrade1").style.display="none",a("upgrade2").style.display="none",a("extraResearches").style.display="none")):o===2?(E.push(0),k.push(0,1),I.push(0,1),$.push(0,1),a("specials").style.display="none",g&&(a("stageInfo").style.display="")):o===3?(E.push(0,1),k.push(0,1),I.push(0),$.push(0),r.debug.rankUpdated=null,a("specials").style.display="none",a("reset1Main").style.display="",g&&(a("stageInfo").style.display="")):o===4?(E.push(0,1,2),k.push(0,1,2),I.push(0),$.push(0,1),a("stageInfo").style.display="",a("extraResearches").style.display="",Ie()):o===5?(I.push(0),$.push(0,1,2),a("stageInfo").style.display="",g?(a("building2").style.display="",E.push(0,1),k.push(0,1),a("extraResearches").style.display="",a("special2").style.display="none",a("special3").style.display="none"):a("specials").style.display="none",Ie()):o===6&&($.push(0,1),a("stageInfo").style.display="",a("reset1Main").style.display="none",a("specials").style.display="none",a("extraResearches").style.display="none"),a("resets").style.display="",a("buildings").style.display="",a("building1").style.display="",a("upgrades").style.display="",a("researches").style.display="",a("stageResearches").style.display="",a("autoWaitInput").value=d(t.toggles.shop.wait[o],{type:"input"});let N=M.buildingHTML[o],H=s.name[o],q=s.type[o],O=s.hoverText[o];for(let x=1;x<s.maxActive[o];x++)C(`#building${x} > img`).src=`Used_art/${N[x-1]}`,C(`#building${x}Stats > h4`).textContent=H[x],a(`building${x}Name`).textContent=H[x],C(`#building${x}ProdDiv > span`).textContent=q[x-1],a(`building${x}ProdDiv`).title=O[x-1],K(x,"buildings");C("#building0Stats > h4").textContent=H[0],K(0,"buildings");let F=M.upgradeHTML[o];for(let x=0;x<h.maxActive;x++){let z=a(`upgrade${x+1}`);E.includes(x)&&(z.style.display=""),z.src=`Used_art/${F[x]}`,z.alt=h.name[x],de(x,o,"upgrades")}let ze=M.researchHTML[o];for(let x=0;x<b.maxActive;x++){let z=a(`research${x+1}`);k.includes(x)&&(z.style.display=""),z.className=ze[x][1];let ie=a(`research${x+1}Image`);ie.src=`Used_art/${ze[x][0]}`,ie.alt=b.name[x],D(x,o,"researches")}let Fe=M.researchExtraHTML[o];for(let x=0;x<S.maxActive;x++){let z=a(`researchExtra${x+1}`);I.includes(x)&&(z.style.display=""),z.className=Fe[x][1];let ie=a(`researchExtra${x+1}Image`);ie.src=`Used_art/${Fe[x][0]}`,ie.alt=S.name[x],D(x,o,"researchesExtra")}C("#extraResearches > div").className=M.researchExtraDivHTML[o][1],C("#extraResearches > img").src=`Used_art/${M.researchExtraDivHTML[o][0]}`,D(0,o,"ASR");for(let x=0;x<T.length;x++)$.includes(x)&&(a(`footerStat${x+1}`).style.display=""),C(`#footerStat${x+1} > img`).src=`Used_art/${T[x][0]}`,C(`#footerStat${x+1} > p`).className=T[x][1],C(`#footerStat${x+1} span`).textContent=T[x][2];let we=document.documentElement.style;we.setProperty("--stage-text",`var(--${n.textColor[o]}-text)`),we.setProperty("--stage-button-border",n.buttonBorder[o]),we.setProperty("--stage-image-borderColor",n.imageBorderColor[o]),we.setProperty("--image-border",`url("Used_art/Stage${o} border.png")`),a("currentSwitch").textContent=n.word[o],ue(),J(),v.theme===null&&It()};var Ve={},Sn={makeAll:()=>he(),stage:e=>{e.repeat&&(t.inflation.vacuum||t.stage.active>=4)||Ue()},discharge:()=>void ot(),vaporization:e=>{e.repeat||it()},rank:()=>void lt(),collapse:e=>{e.repeat||Ke()},galaxy:()=>ne(3,5),pause:e=>{e.repeat||!v.developerMode||Rt()},toggleAll:e=>{e.repeat||K(0,"buildings",!0)},merge:e=>{e.repeat||ft()},universe:()=>ne(1,6),tabRight:e=>{e.repeat||Jt("Right")},tabLeft:e=>{e.repeat||Jt("Left")},subtabUp:e=>{e.repeat||Yt("Up")},subtabDown:e=>{e.repeat||Yt("Down")},stageRight:e=>{e.repeat||Xt("Right")},stageLeft:e=>{e.repeat||Xt("Left")}},Oe=()=>{for(let n in Ve)delete Ve[n];let e=v.toggles[0]?0:1;for(let n in v.hotkeys){let s=v.hotkeys[n][e];s===""||s==null||(Ve[s]!==void 0?v.hotkeys[n]=[]:Ve[s]=n)}},Zt=e=>{let n=Ve[e];return n===void 0?null:(v.hotkeys[n]=[],n)},en=e=>{if(e.code==="Tab"){document.body.classList.remove("noFocusOutline");return}else{let c=document.activeElement?.type;if(c==="text"||c==="number")return;document.body.classList.add("noFocusOutline")}if(r.hotkeys.disabled)return;let{key:n,code:s}=e,{shiftKey:o}=e;if(o&&(r.hotkeys.shift=!0),e.ctrlKey&&(r.hotkeys.ctrl=!0),s==="Escape"){if(e.metaKey||e.ctrlKey||o||e.altKey||M.alert[0]!==null||M.bigWindow!==null)return;let c=M.notifications[0];c!==void 0&&c[1](!0);return}let i=Number(s.replace("Digit","").replace("Numpad",""));if(!isNaN(i)&&s!==""){if(e.metaKey||e.ctrlKey||e.altKey)return;if(isNaN(Number(n))&&(o||(o=!0,e.preventDefault())),o){if(e.repeat)return;K(i,"buildings",!0)}else i!==0?ne(i):he()}else{let c=e.metaKey?"Meta ":"";e.ctrlKey&&(c+="Ctrl "),o&&(c+="Shift "),e.altKey&&(c+="Alt "),c+=v.toggles[0]?n.length===1?n.toUpperCase():n.replace("Arrow","Arrow "):n.length===1?s.replace("Key",""):s.replace("Arrow","Arrow ");let f=Sn[Ve[c]];f!==void 0&&(f(e),e.preventDefault())}},Jt=e=>{let n=r.tabList.tabs,s=n.indexOf(r.tab);if(e==="Left"){do s<=0?s=n.length-1:s--;while(!ge(n[s]));_(n[s])}else{do s>=n.length-1?s=0:s++;while(!ge(n[s]));_(n[s])}},Yt=e=>{let n=r.tab,s=r.tabList[`${n}Subtabs`];if(s.length<2)return;let o=s.indexOf(r.subtab[`${n}Current`]);if(e==="Down"){do o<=0?o=s.length-1:o--;while(!ge(n,s[o]));_(n,s[o])}else{do o>=s.length-1?o=0:o++;while(!ge(n,s[o]));_(n,s[o])}},Xt=e=>{let n=r.stageInfo.activeAll;if(n.length===1)return;let s=n.indexOf(t.stage.active);e==="Left"?(s<=0?s=n.length-1:s--,xe(n[s])):(s>=n.length-1?s=0:s++,xe(n[s]))};var v={intervals:{main:20,numbers:80,visual:1e3,autoSave:2e4},hotkeys:{makeAll:["M","M"],stage:["S","S"],discharge:["D","D"],vaporization:["V","V"],rank:["R","R"],collapse:["C","C"],galaxy:["G","G"],pause:["P","P"],toggleAll:["Shift A","Shift A"],merge:["Shift M","Shift M"],universe:["Shift U","Shift U"],tabRight:["Arrow Right","Arrow Right"],tabLeft:["Arrow Left","Arrow Left"],subtabUp:["Arrow Up","Arrow Up"],subtabDown:["Arrow Down","Arrow Down"],stageRight:["Shift Arrow Right","Shift Arrow Right"],stageLeft:["Shift Arrow Left","Shift Arrow Left"]},toggles:[!1,!1,!1],format:[".",""],theme:null,fontSize:16,MDSettings:[!1,!1],SRSettings:[!1,!1,!1],developerMode:!1},re=()=>{let e=V(v.hotkeys),n=new TextEncoder;for(let o in e){let i=e[o];for(let c=0;c<i.length;c++)i[c]=String.fromCharCode(...n.encode(i[c]))}let s={...v};s.hotkeys=e,localStorage.setItem("fundamentalSettings",btoa(JSON.stringify(s)))},me=(e,n,s=!1,o=!1)=>{let i;if(n==="mobile"?i=v.MDSettings:n==="reader"?i=v.SRSettings:i=v.toggles,s){if(o)return void(async()=>{await j(`Changing this setting will reload game, confirm?
(Game will not autosave)`)&&(r.hotkeys.disabled=!0,r.paused=!0,Y(),i[e]=!i[e],re(),window.location.reload(),W("Awaiting game reload"))})();i[e]=!i[e],re()}let c;n==="mobile"?c=a(`MDToggle${e}`):n==="reader"?c=a(`SRToggle${e}`):c=a(`globalToggle${e}`),i[e]?(c.style.color="var(--red-text)",c.style.borderColor="crimson",c.textContent="ON"):(c.style.color="",c.style.borderColor="",c.textContent="OFF")},M={resetHTML:["","Discharge","Vaporization","Rank","Collapse","Merge"],longestBuilding:7,buildingHTML:[[],["Preon.png","Quarks.png","Particle.png","Atom.png","Molecule.png"],["Drop.png","Puddle.png","Pond.png","Lake.png","Sea.png","Ocean.png"],["Cosmic%20dust.png","Planetesimal.png","Protoplanet.png","Natural%20satellite.png","Subsatellite.png"],["Brown%20dwarf.png","Orange%20dwarf.png","Red%20supergiant.png","Blue%20hypergiant.png","Quasi%20star.png"],["Nebula.png","Star%20cluster.png","Galaxy.png"],["Universe.png"]],longestUpgrade:13,upgradeHTML:[[],["UpgradeQ1.png","UpgradeQ2.png","UpgradeQ3.png","UpgradeQ4.png","UpgradeQ5.png","UpgradeQ6.png","UpgradeQ7.png","UpgradeQ8.png","UpgradeQ9.png","UpgradeQ10.png"],["UpgradeW1.png","UpgradeW2.png","UpgradeW3.png","UpgradeW4.png","UpgradeW5.png","UpgradeW6.png","UpgradeW7.png","UpgradeW8.png","UpgradeW9.png"],["UpgradeA1.png","UpgradeA2.png","UpgradeA3.png","UpgradeA4.png","UpgradeA5.png","UpgradeA6.png","UpgradeA7.png","UpgradeA8.png","UpgradeA9.png","UpgradeA10.png","UpgradeA11.png","UpgradeA12.png","UpgradeA13.png"],["UpgradeS1.png","UpgradeS2.png","UpgradeS3.png","UpgradeS4.png","UpgradeS5.png"],["UpgradeG1.png","UpgradeG2.png","UpgradeG3.png","Missing.png"],[]],longestResearch:9,researchHTML:[[],[["ResearchQ1.png","stage1borderImage"],["ResearchQ2.png","stage1borderImage"],["ResearchQ3.png","stage1borderImage"],["ResearchQ4.png","stage4borderImage"],["ResearchQ5.png","stage4borderImage"],["ResearchQ6.png","stage4borderImage"]],[["ResearchW1.png","stage2borderImage"],["ResearchW2.png","stage2borderImage"],["ResearchW3.png","stage2borderImage"],["ResearchW4.png","stage2borderImage"],["ResearchW5.png","stage2borderImage"],["ResearchW6.png","stage2borderImage"]],[["ResearchA1.png","stage3borderImage"],["ResearchA2.png","stage2borderImage"],["ResearchA3.png","stage3borderImage"],["ResearchA4.png","stage3borderImage"],["ResearchA5.png","stage3borderImage"],["ResearchA6.png","stage3borderImage"],["ResearchA7.png","stage1borderImage"],["ResearchA8.png","stage7borderImage"],["ResearchA9.png","stage1borderImage"]],[["ResearchS1.png","stage5borderImage"],["ResearchS2.png","stage5borderImage"],["ResearchS3.png","stage7borderImage"],["ResearchS4.png","stage5borderImage"],["ResearchS5.png","stage6borderImage"],["Missing.png","stage4borderImage"]],[["ResearchG1.png","stage1borderImage"],["ResearchG2.png","stage6borderImage"]],[]],longestResearchExtra:5,researchExtraDivHTML:[[],["Energy%20Researches.png","stage4borderImage"],["Cloud%20Researches.png","stage2borderImage"],["Rank%20Researches.png","stage6borderImage"],["Collapse%20Researches.png","stage6borderImage"],["Galaxy%20Researches.png","stage3borderImage"],["Missing.png","stage7borderImage"]],researchExtraHTML:[[],[["ResearchEnergy1.png","stage1borderImage"],["ResearchEnergy2.png","stage5borderImage"],["ResearchEnergy3.png","stage3borderImage"],["ResearchEnergy4.png","stage1borderImage"],["ResearchEnergy5.png","stage6borderImage"]],[["ResearchClouds1.png","stage3borderImage"],["ResearchClouds2.png","stage2borderImage"],["ResearchClouds3.png","stage4borderImage"],["ResearchClouds4.png","stage2borderImage"]],[["ResearchRank1.png","stage3borderImage"],["ResearchRank2.png","stage3borderImage"],["ResearchRank3.png","stage3borderImage"],["ResearchRank4.png","stage2borderImage"],["ResearchRank5.png","stage2borderImage"]],[["ResearchCollapse1.png","stage6borderImage"],["ResearchCollapse2.png","stage7borderImage"],["ResearchCollapse3.png","stage1borderImage"],["Missing.png","stage5borderImage"]],[["ResearchGalaxy1.png","stage3borderImage"]],[]],longestFooterStats:3,footerStatsHTML:[[],[["Energy%20mass.png","stage1borderImage cyanText","Mass"],["Energy.png","stage4borderImage orangeText","Energy"]],[["Water.png","stage2borderImage blueText","Moles"],["Drop.png","stage2borderImage blueText","Drops"],["Clouds.png","stage3borderImage grayText","Clouds"]],[["Mass.png","stage3borderImage grayText","Mass"]],[["Main_sequence%20mass.png","stage1borderImage cyanText","Mass"],["Elements.png","stage4borderImage orangeText","Elements"]],[["Main_sequence%20mass.png","stage1borderImage cyanText","Mass"],["Elements.png","stage4borderImage orangeText","Elements"],["Stars.png","stage7borderImage redText","Stars"]],[["Missing.png","stage3borderImage grayText","Matter"],["Missing.png","stage6borderImage darkvioletText","Cosmon"]]],cache:{imagesDiv:document.createElement("div"),idMap:new Map,classMap:new Map,queryMap:new Map},notifications:[],alert:[null,null],bigWindow:null,styleSheet:document.createElement("style")},tn=()=>{let{footerStatsHTML:e,buildingHTML:n,upgradeHTML:s,researchHTML:o,researchExtraHTML:i,researchExtraDivHTML:c}=M,f='<img src="Used_art/Red%20giant.png" loading="lazy"><img src="Used_art/White%20dwarf.png" loading="lazy">';f+='<img src="Used_art/Neutron%20star.png" loading="lazy"><img src="Used_art/Missing.png" loading="lazy">';for(let g=1;g<=6;g++){for(let l=0;l<e[g].length;l++){if(g===2){if(l===2)continue}else if(g===5&&l<2)continue;f+=`<img src="Used_art/${e[g][l][0]}" loading="lazy">`}for(let l=0;l<n[g].length;l++)f+=`<img src="Used_art/${n[g][l]}" loading="lazy">`;for(let l=0;l<s[g].length;l++)f+=`<img src="Used_art/${s[g][l]}" loading="lazy">`;for(let l=0;l<o[g].length;l++)f+=`<img src="Used_art/${o[g][l][0]}" loading="lazy">`;for(let l=0;l<i[g].length;l++)f+=`<img src="Used_art/${i[g][l][0]}" loading="lazy">`;f+=`<img src="Used_art/${c[g][0]}" loading="lazy">`,f+=`<img src="Used_art/Stage${g}%20border.png" loading="lazy">`}M.cache.imagesDiv.innerHTML=f},ht=e=>{e!==null&&(t.stage.true<e&&(e=null),e===6&&t.stage.true<7&&(e=null)),v.theme=e,re(),It(),a("currentTheme").textContent=v.theme===null?"Default":r.stageInfo.word[v.theme]},It=()=>{let e=["upgrade","element","inflation"],n={"--background-color":"#030012","--window-color":"#12121c","--window-border":"cornflowerblue","--footer-color":"darkblue","--button-color":"mediumblue","--button-border":"darkcyan","--button-hover":"#2626ff","--building-afford":"#a90000","--tab-active":"#8b00c5","--tab-elements":"#9f6700","--tab-strangeness":"#00b100","--tab-inflation":"#6c1ad1","--hollow-hover":"#170089","--footerButton-hover":"#181818","--input-border":"#831aa5","--input-text":"#cf71ff","--button-text":"#e3e3e3","--main-text":"var(--cyan-text)","--white-text":"white","--blue-text":"dodgerblue","--orange-text":"darkorange","--gray-text":"#8f8f8f","--orchid-text":"#e14bdb","--darkorchid-text":"#bd24ef","--darkviolet-text":"#8635eb","--red-text":"#eb0000","--green-text":"#00e900","--yellow-text":"#fafa00"};switch(v.theme??t.stage.active){case 1:for(let o of e)a(`${o}Text`).style.color="",a(`${o}Effect`).style.color="",a(`${o}Cost`).style.color="";n["--tab-inflation"]="var(--tab-active)";break;case 2:for(let o of e)a(`${o}Text`).style.color="var(--white-text)",a(`${o}Effect`).style.color="var(--green-text)",a(`${o}Cost`).style.color="var(--cyan-text)";n["--background-color"]="#070026",n["--window-color"]="#000052",n["--window-border"]="blue",n["--footer-color"]="#0000db",n["--button-color"]="#0000eb",n["--button-border"]="#386cc7",n["--button-hover"]="#2929ff",n["--building-afford"]="#b30000",n["--tab-active"]="#990000",n["--hollow-hover"]="#2400d7",n["--input-border"]="#4747ff",n["--input-text"]="dodgerblue",n["--main-text"]="var(--blue-text)",n["--gray-text"]="#9b9b9b",n["--darkorchid-text"]="#c71bff",n["--darkviolet-text"]="#8b6bff",n["--green-text"]="#82cb3b",n["--red-text"]="#f70000";break;case 3:for(let o of e)a(`${o}Text`).style.color="var(--orange-text)",a(`${o}Effect`).style.color="",a(`${o}Cost`).style.color="var(--green-text)";n["--background-color"]="#000804",n["--window-color"]="#2e1200",n["--window-border"]="#31373e",n["--footer-color"]="#221a00",n["--button-color"]="#291344",n["--button-border"]="#424242",n["--button-hover"]="#382055",n["--building-afford"]="#9e0000",n["--tab-active"]="#8d4c00",n["--tab-elements"]="var(--tab-active)",n["--hollow-hover"]="#5a2100",n["--footerButton-hover"]="#1a1a1a",n["--input-border"]="#8b4a00",n["--input-text"]="#e77e00",n["--main-text"]="var(--gray-text)",n["--white-text"]="#dfdfdf",n["--orange-text"]="#f58600",n["--green-text"]="#00db00";break;case 4:for(let o of e)a(`${o}Text`).style.color="var(--blue-text)",a(`${o}Effect`).style.color="var(--green-text)",a(`${o}Cost`).style.color="var(--cyan-text)";n["--background-color"]="#140e04",n["--window-color"]="#4e0000",n["--window-border"]="#894800",n["--footer-color"]="#4e0505",n["--button-color"]="#6a3700",n["--button-border"]="#a35700",n["--button-hover"]="#8a4700",n["--building-afford"]="#007f95",n["--tab-active"]="#008297",n["--tab-elements"]="var(--tab-active)",n["--tab-strangeness"]="#00a500",n["--hollow-hover"]="#605100",n["--footerButton-hover"]="#212121",n["--input-border"]="#008399",n["--input-text"]="#05c3c3",n["--button-text"]="#d9d900",n["--main-text"]="var(--orange-text)",n["--white-text"]="#e5e500",n["--blue-text"]="#2e96ff",n["--gray-text"]="#8b8b8b",n["--darkorchid-text"]="#c71bff",n["--darkviolet-text"]="#9457ff",n["--red-text"]="red",n["--green-text"]="#00e600",n["--yellow-text"]="var(--green-text)";break;case 5:for(let o of e)a(`${o}Text`).style.color="var(--orange-text)",a(`${o}Effect`).style.color="var(--green-text)",a(`${o}Cost`).style.color="var(--red-text)";n["--background-color"]="#060010",n["--window-color"]="#001d42",n["--window-border"]="#35466e",n["--footer-color"]="#2f005c",n["--button-color"]="#4a008f",n["--button-border"]="#8f004c",n["--button-hover"]="#6800d6",n["--building-afford"]="#8603ff",n["--tab-active"]="#8500ff",n["--tab-inflation"]="var(--tab-active)",n["--hollow-hover"]="#3b0080",n["--footerButton-hover"]="#1a1a1a",n["--input-border"]="#3656a1",n["--input-text"]="#6a88cd",n["--button-text"]="#fc9cfc",n["--main-text"]="var(--darkorchid-text)",n["--white-text"]="#ff79ff",n["--orchid-text"]="#ff00f4",n["--darkorchid-text"]="#c000ff",n["--darkviolet-text"]="#9f52ff",n["--yellow-text"]="var(--darkviolet-text)";break;case 6:for(let o of e)a(`${o}Text`).style.color="var(--orchid-text)",a(`${o}Effect`).style.color="var(--orange-text)",a(`${o}Cost`).style.color="var(--red-text)";n["--background-color"]="black",n["--window-color"]="#01003c",n["--window-border"]="#7100ff",n["--footer-color"]="#00007a",n["--button-color"]="#2b0095",n["--button-border"]="#6c1ad1",n["--button-hover"]="#3d00d6",n["--building-afford"]="#b30000",n["--tab-active"]="#8d0000",n["--tab-inflation"]="var(--tab-active)",n["--hollow-hover"]="#490070",n["--input-border"]="#a50000",n["--input-text"]="red",n["--button-text"]="#efe0ff",n["--main-text"]="var(--darkviolet-text)",n["--gray-text"]="#9b9b9b",n["--darkviolet-text"]="#8157ff",n["--white-text"]="#f9f5ff",n["--red-text"]="red",n["--yellow-text"]="var(--green-text)"}let s=document.documentElement.style;s.setProperty("--transition-all","800ms"),s.setProperty("--transition-buttons","600ms");for(let o in n)s.setProperty(o,n[o]);setTimeout(()=>{s.setProperty("--transition-all","0ms"),s.setProperty("--transition-buttons","100ms")},800)},W=async(e,n=0)=>await new Promise(s=>{if(M.alert[0]!==null)if(M.alert[0]<n)M.alert[1](),P(`Alert has been replaced with higher priority one
Old text: ${a("alertText").textContent}`);else{s(),P(`Another Alert is already active
Missed text: ${e}`);return}a("alertText").textContent=e;let o=document.body,i=a("alertMain"),c=a("alertConfirm");i.style.display="",o.style.userSelect="";let f=document.activeElement;c.focus();let g=async u=>{let m=u.code;m==="Escape"||m==="Enter"||m==="Space"?(u.preventDefault(),l()):m==="Tab"&&(u.preventDefault(),c.focus())},l=()=>{o.style.userSelect=v.toggles[2]?"":"none",i.style.display="none",o.removeEventListener("keydown",g),c.removeEventListener("click",l),M.alert=[null,null],f?.focus(),s()};M.alert=[n,l],o.addEventListener("keydown",g),c.addEventListener("click",l)}),j=async(e,n=0)=>await new Promise(s=>{if(M.alert[0]!==null)if(M.alert[0]<n)M.alert[1](),P(`Alert has been replaced with higher priority one
Old text: ${a("alertText").textContent}`);else{s(!1),P(`Another Alert is already active
Missed text: ${e}`);return}a("alertText").textContent=e;let o=document.body,i=a("alertMain"),c=a("alertCancel"),f=a("alertConfirm");i.style.display="",c.style.display="",o.style.userSelect="";let g=document.activeElement;f.focus();let l=!1,u=()=>{l=!0,h()},m=b=>{let S=b.code;if(S==="Escape")b.preventDefault(),h();else if(S==="Enter"||S==="Space"){if(document.activeElement===c)return;b.preventDefault(),u()}else S==="Tab"&&(b.preventDefault(),(document.activeElement===c?f:c).focus())},h=()=>{o.style.userSelect=v.toggles[2]?"":"none",i.style.display="none",c.style.display="none",o.removeEventListener("keydown",m),f.removeEventListener("click",u),c.removeEventListener("click",h),M.alert=[null,null],g?.focus(),s(l)};M.alert=[n,h],o.addEventListener("keydown",m),f.addEventListener("click",u),c.addEventListener("click",h)}),yt=async(e,n="",s=0)=>await new Promise(o=>{if(M.alert[0]!==null)if(M.alert[0]<s)M.alert[1](),P(`Alert has been replaced with higher priority one
Old text: ${a("alertText").textContent}`);else{o(null),P(`Another Alert is already active
Missed text: ${e}`);return}a("alertText").textContent=e;let i=document.body,c=a("alertMain"),f=a("alertInput"),g=a("alertCancel"),l=a("alertConfirm");c.style.display="",g.style.display="",f.style.display="",i.style.userSelect="",f.placeholder=n,f.value="";let u=document.activeElement;f.focus();let m=null,h=()=>{m=f.value===""?f.placeholder:f.value,S()},b=T=>{let E=T.code;if(E==="Escape")T.preventDefault(),S();else if(E==="Enter"||E==="Space"){let k=document.activeElement;if(E==="Space"&&k===f||k===g)return;T.preventDefault(),h()}else E==="Tab"&&(T.shiftKey&&document.activeElement===f?(T.preventDefault(),g.focus()):!T.shiftKey&&document.activeElement===g&&(T.preventDefault(),f.focus()))},S=()=>{i.style.userSelect=v.toggles[2]?"":"none",c.style.display="none",g.style.display="none",f.style.display="none",i.removeEventListener("keydown",b),l.removeEventListener("click",h),g.removeEventListener("click",S),M.alert=[null,null],u?.focus(),o(m)};M.alert=[s,S],i.addEventListener("keydown",b),l.addEventListener("click",h),g.addEventListener("click",S)}),P=e=>{let{notifications:n}=M,s;for(let o=0;o<n.length;o++)if(n[o][0]===e){s=o;break}if(s===void 0){let o=1,i,c=document.createElement("p");c.textContent=e,c.style.animation="hideX 800ms ease-in-out reverse",c.style.pointerEvents="none",v.SRSettings[0]&&(c.role="alert"),a("notifications").append(c);let f=n[n.push([e,(l=!1)=>{if(l)return g();c.textContent=`${e} | x${++o}`,clearTimeout(i),i=setTimeout(g,7200)}])-1],g=()=>{n.splice(n.indexOf(f),1),c.removeEventListener("click",g),c.style.animation="hideX 800ms ease-in-out forwards",c.style.pointerEvents="none",setTimeout(()=>c.remove(),800),clearTimeout(i)};setTimeout(()=>{c.style.animation="",c.style.pointerEvents="",i=setTimeout(g,7200),c.addEventListener("click",g)},800)}else n[s][1]()},bt=()=>{let e=a("hideToggle").dataset;if(e.disabled==="true")return;let n=a("footer"),s=a("footerMain"),o=a("hideArrow"),i=()=>{n.style.animation="",o.style.animation="",e.disabled=""};r.footer=!r.footer,e.disabled="true",r.footer?(s.style.display="",o.style.transform="",n.style.animation="hideY 800ms reverse",o.style.animation="rotate 800ms reverse",C("#hideToggle > p").textContent="Hide",a("stageSelect").classList.add("active"),setTimeout(i,800),ue(),J()):(n.style.animation="hideY 800ms backwards",o.style.animation="rotate 800ms backwards",C("#hideToggle > p").textContent="Show",a("stageSelect").classList.remove("active"),setTimeout(()=>{s.style.display="none",o.style.transform="rotate(180deg)",i()},800))},At=(e=!1)=>{let n=a("customFontSize"),s=Math.min(Math.max(e?v.fontSize:n.value===""?16:Math.floor(Number(n.value)*100)/100,12),24);e||(v.fontSize=s,re(),a("milestonesMultiline").parentElement.style.minHeight=""),document.documentElement.style.fontSize=s===16?"":`${s}px`,n.value=`${s}`,nn(e)},nn=e=>{let n=a("primaryRules").sheet;if(n==null)return e?a("primaryRules").addEventListener("load",()=>{nn(!1)},{once:!0}):P(`Due to ${n} related Error some font size features will not work`);let s=n.cssRules.length-1,o=v.fontSize/16,i=n.cssRules[s-1],c=n.cssRules[s];n.deleteRule(s),n.deleteRule(s-1),n.insertRule(i.cssText.replace(i.conditionText,`screen and (max-width: ${893*o+32}px)`),s-1),n.insertRule(c.cssText.replace(c.conditionText,`screen and (max-width: ${362*o+32}px)`),s)},Lt=e=>{let n=e?a("decimalPoint"):a("thousandSeparator"),s=n.value;s===" "&&(s="\xA0"),(![".","\xB7",",","\xA0","_","'",'"',"`","|"].includes(s)||v.format[e?1:0]===s)&&(e&&v.format[1]==="."&&(a("thousandSeparator").value="",v.format[1]=""),s=e?".":"",n.value=s),v.format[e?0:1]=s,re()},pt=e=>{for(let n=1;n<=5;n++)a(`strangenessSection${n}`).style.display="none";a(`strangenessSection${e}`).style.display=""},sn=async()=>{let e;if(t.stage.true>=6)e=t.events[1]?8:t.stage.resets>=1?7:6;else if(e=t.stage.true-(t.events[0]?0:1),e<1)return void W("There are no unlocked events");let n=`Which event do you want to see again?
Event 1: Stage reset`;e>=2&&(n+=`
Event 2: Clouds softcap`),e>=3&&(n+=`
Event 3: New Rank`),e>=4&&(n+=`
Event 4: New Elements`),e>=5&&(n+=`
Event 5: Intergalactic`),e>=6&&(n+=`
Event 6: True Vacuum`),e>=7&&(n+=`
Event 7: Void unlocked`),e>=8&&(n+=`
Event 8: New Universe`);let s=Number(await yt(n,`${e}`));s>e||ce(s)},ce=(e,n=null)=>{if(M.alert[0]!==null)return P(`Missed Event ${e}, you can replay it from options`);switch(n!==null&&(t.events[n]=!0),e){case 1:return void W("New reset tier has been unlocked. It will allow to reach higher tiers of Structures, but for the price of everything else");case 2:return void W(`Cloud density is too high... Any new Clouds past ${d(1e4)} will be weaker due to softcap`);case 3:return void W("Can't gain any more Mass with current Rank. New one has been unlocked, but reaching it will softcap the Mass production");case 4:return void W("Last explosion not only created first Neutron stars, but also unlocked new Elements through Supernova nucleosynthesis");case 5:return void W(`There are no Structures in Intergalactic yet, but they can be created within previous Stages. Any new Stage reset and export from now on will award Strange quarks, also unlock new effect for '[26] Iron' Element
(Stars in Intergalactic are just Stars from Interstellar)`);case 6:return void W("As Galaxies started to Merge, their combined Gravity pushed Vacuum out of its local minimum into more stable global minimum. New forces and Structures are expected within this new and true Vacuum state");case 7:return void W("With Vacuum decaying remaining matter had rearranged itself in such way that lead to the formation of the 'Void'. Check it out in 'Advanced' subtab");case 8:return void W("Soon there will be enough matter to create first 'Universe' within 'Abyss' Stage. Doing it will require to get at least 40 Galaxies before Merge reset. Creating it will do a Vacuum reset, while also resetting Vacuum state back to false")}},Nt=async()=>{let e=`These hints can explain some parts of the game, write hint of interest into the input bellow
'Safe reset'`;t.stage.true>=5&&(e+=", 'Intergalactic Stage', 'Export reward'"),t.stage.true>=6&&(t.stage.true>=7||t.stage.resets>=1||t.researchesExtra[1][2]>=2)&&(e+=", 'Submerged Stage'");let n=await yt(e);if(n===null||n==="")return;let s=`Hint about '${n}' doesn't exist`,o=n.replaceAll(" ","").toLowerCase();o==="safereset"?s="'Safe' setting for confirmation toggles causes warning to pop up if game considers action to be unwanted. After progressing further, some of them might start getting in a way":o==="exportreward"?s=`Export reward is based on highest Stage reset reward, after collecting it timer will reset to 0 and value will decrease by collected amount
Current value for the Strange quarks is ${d(t.time.export[1])} +1${t.strangeness[5][8]>=1||t.inflation.tree[3]>=1?`, Strangelets is ${d(t.time.export[2])}`:""}`:o==="intergalacticstage"?s="Intergalactic Stage is a direct continuation of Interstellar Stage. Structures for it are unlocked by completing Milestones":o==="submergedstage"&&(s="Submerged Stage in true Vacuum acts like a bonus Stage, its not required for progression, but it will speed it up. Because of it you will not be able to get far into until enough Strangeness is created"),await j(`${s}
View another one?`)&&Nt()},an=()=>{a("closeBigWindow",!0)===null&&(a("bigWindow").innerHTML='<div role="dialog" aria-modal="false"><button type="button" id="closeBigWindow">Close</button></div>',M.styleSheet.textContent+="#bigWindow > div { display: flex; flex-direction: column; align-items: center; width: clamp(20vw, 38em, 80vw); height: clamp(18vh, 36em, 90vh); background-color: var(--window-color); border: 3px solid var(--window-border); border-radius: 12px; padding: 1em 1em 0.8em; row-gap: 1em; }",M.styleSheet.textContent+="#bigWindow > div > button { flex-shrink: 0; border-radius: 4px; width: 6em; font-size: 0.92em; margin-top: auto; } #bigWindow > div > div { width: 100%; overflow-y: auto; overscroll-behavior-y: none; }")},rn=()=>{if(M.bigWindow!==null)return;if(an(),a("versionHTML",!0)===null){let f=document.createElement("div");f.innerHTML=`<label>v0.2.1</label><p>- Missing</p>
        <label>v0.2.0</label><p>- Reworked balance for all Stages past first reset cycle
- Many quality of life additions
- Most of settings are now saved separate from save file
- Some more work on Mobile device support</p>
        <label>v0.1.9</label><p>- More true Vacuum balance
- Reworked time related formats
- Warp and Offline time usage reworked</p>
        <label>v0.1.8</label><p>- True Vacuum small balance changes
- Upgrades and Researches merged
- Added copy to clipboard, load from string save file options</p>
        <label>v0.1.7</label><p>- New content (Void)
- Further balance changes</p>
        <label>v0.1.6</label><p>- Massive rebalance and reworks for all Stages</p>
        <label>v0.1.5</label><p>- True Vacuum minor balance
- Images no longer unload
- Screen reader support reworked</p>
        <label>v0.1.4</label><p>- Custom scrolls
- Notifications</p>
        <label>v0.1.3</label><p>- True Vacuum balance changes
- Submerged Stage minor balance
- Replay event button

- History for Stage resets</p>
        <label>v0.1.2</label><p>- New content (Vacuum)
- Offline time reworked
- Added version window (removed change log on game load)
- Permanently removed text movement</p>
        <label>v0.1.1</label><p>- More balance changes for late game</p>
        <label>v0.1.0</label><p>- New content (Intergalactic)
- Balance changes for late game</p>
        <label>v0.0.9</label><p>- New content (Milestones)
- More Interstellar and late game balance</p>
        <label>v0.0.8</label><p>- Minor speed up to all Stages past Microworld</p>
        <label>v0.0.7</label><p>- New content (Strangeness)
- Microworld Stage rework

- Added stats for Save file name</p>
        <label>v0.0.6</label><p>- Added hotkeys list

- Option to remove text movement
- Ability to rename save file</p>
        <label>v0.0.5</label><p>- New content (Interstellar)
- Basic loading screen

- Added hotkeys</p>
        <label>v0.0.4</label><p>- Speed up to all Stages
- Added events

- Added numbers format</p>
        <label>v0.0.3</label><p>- New content (Accretion)
- Submerged Stage extended
- Offline time calculated better</p>
        <label>v0.0.2</label><p>- Stats subtab</p>
        <label>v0.0.1</label><p>- Submerged Stage rework
- Added change log on game load

- Mobile device support</p>
        <label>v0.0.0</label><p>- First published version

- Submerged Stage placeholder</p>`,C("#bigWindow > div").prepend(f),f.id="versionHTML",M.styleSheet.textContent+="#versionHTML label { font-size: 1.18em; } #versionHTML p { line-height: 1.3em; white-space: pre-line; color: var(--white-text); margin-top: 0.2em; margin-bottom: 1.4em; } #versionHTML p:last-of-type { margin-bottom: 0; }"}M.bigWindow="version";let e=document.body,n=a("closeBigWindow"),s=a("versionHTML"),o=a("bigWindow"),i=f=>{if(M.alert[0]!==null)return;let g=f.code;(g==="Escape"||g==="Enter"||g==="Space")&&(f.preventDefault(),c())},c=()=>{M.bigWindow=null,o.style.display="none",s.style.display="none",e.removeEventListener("keydown",i),n.removeEventListener("click",c)};e.addEventListener("keydown",i),n.addEventListener("click",c),s.style.display="",o.style.display="",n.focus()},on=()=>{if(M.bigWindow!==null)return;if(an(),a("hotkeysHTML",!0)===null){let f=document.createElement("div");f.innerHTML=`<p id="hotkeysMessage" class="mainText bigWord" aria-live="assertive">Some hotkeys can be changed by clicking on them</p>
        <label id="tabRightHotkey" class="mainText"><button></button> \u2012 <span class="whiteText">change tab to the next one</span></label>
        <label id="tabLeftHotkey" class="mainText"><button></button> \u2012 <span class="whiteText">change tab to the previous one</span></label>
        <label id="subtabUpHotkey" class="mainText"><button></button> \u2012 <span class="whiteText">change subtab to the next one</span></label>
        <label id="subtabDownHotkey" class="mainText"><button></button> \u2012 <span class="whiteText">change subtab to the previous one</span></label>
        <label id="stageRightHotkey" class="mainText"><button></button> \u2012 <span class="whiteText">change active Stage to the next one</span></label>
        <label id="stageLeftHotkey" class="mainText"><button></button> \u2012 <span class="whiteText">change active Stage to the previous one</span></label>
        <p class="mainText">Numbers \u2012 <span class="whiteText">make a new Structure</span></p>
        <label id="makeAllHotkey" class="mainText">0 <span class="whiteText">or</span> <button></button> \u2012 <span class="whiteText">make all Structures</span></label>
        <p class="mainText">Shift Numbers \u2012 <span class="whiteText">toggle auto Structure</span></p>
        <label id="toggleAllHotkey" class="mainText">Shift 0 <span class="whiteText">or</span> <button></button> \u2012 <span class="whiteText">toggle all auto Structures</span></label>
        <p class="mainText">Enter <span class="whiteText">or</span> Space \u2012 <span class="whiteText">click on the selected HTML Element or confirm Alert</span></p>
        <p class="mainText">Escape \u2012 <span class="whiteText">cancel changing hotkey, close Alert or Notification</span></p>
        <p class="mainText">Tab <span class="whiteText">and</span> Shift Tab \u2012 <span class="whiteText">select another HTML Element</span></p>
        <div>
            <label id="stageHotkey" class="stageText"><button></button> \u2012 <span class="whiteText">Stage reset</span></label>
            <label id="dischargeHotkey" class="orangeText stage1Include"><button></button> \u2012 <span class="whiteText">Discharge</span></label>
            <label id="vaporizationHotkey" class="grayText stage2Include"><button></button> \u2012 <span class="whiteText">Vaporization</span></label>
            <label id="rankHotkey" class="darkorchidText stage3Include"><button></button> \u2012 <span class="whiteText">Rank</span></label>
            <label id="collapseHotkey" class="orchidText stage4Include"><button></button> \u2012 <span class="whiteText">Collapse</span></label>
            <label id="galaxyHotkey" class="grayText stage5Include"><button></button> \u2012 <span class="whiteText">Galaxy</span></label>
            <label id="mergeHotkey" class="darkvioletText stage5Include"><button></button> \u2012 <span class="whiteText">Merge</span></label>
            <label id="universeHotkey" class="darkvioletText stage6Include"><button></button> \u2012 <span class="whiteText">Universe</span></label>
            <label id="pauseHotkey" class="grayText"><button></button> \u2012 <span class="whiteText">pause</span></label>
        </div>
        <p class="mainText">Holding Enter on last selected button will repeatedly press it, also works with Mouse and Touch events on some buttons</p>
        <label id="hotkeysToggleLabel" title="Turn ON, if using non QWERTY layout keyboard">Language dependant hotkeys </label>
        <button id="restoreHotkeys" type="button">Restore default hotkeys values</button>`,C("#bigWindow > div").prepend(f),f.id="hotkeysHTML";let g=a("globalToggle0");g.className="specialToggle",g.style.display="",a("hotkeysToggleLabel").append(g),M.styleSheet.textContent+="#hotkeysHTML { display: flex; flex-direction: column; align-items: center; row-gap: 0.2em; } #hotkeysHTML > div { display: grid; grid-template-columns: 1fr 1fr 1fr; width: 100%; gap: 0.3em; } #hotkeysHTML > div label { min-width: max-content; }",M.styleSheet.textContent+="#hotkeysHTML button:not(.specialToggle) { width: max-content; color: inherit; background-color: unset; border-width: 1px; border-color: inherit; border-right: none; border-left: none; border-top: none; font-size: inherit; height: unset; }";let l=async(m=!1)=>await new Promise(h=>{a("hotkeysMessage").textContent="Awaiting new value for the hotkey";let b=document.body,S=null,T=I=>{let $=I.code;$!=="Tab"&&(I.preventDefault(),($==="Escape"||($==="Enter"||$==="Space")&&document.activeElement===a("closeBigWindow"))&&k())},E=async I=>{if(m)return void(m=!1);let{key:$,code:N}=I;if(N==="Tab"||N==="Escape")return;let H=I.metaKey?"Meta ":"";if(I.ctrlKey&&(H+="Ctrl "),I.shiftKey&&(H+="Shift "),I.altKey&&(H+="Alt "),!isNaN(Number(N.replace("Digit","").replace("Numpad","")))&&N!==""||$==="Meta"||$==="Control"||$==="Shift"||$==="Alt"||N==="Enter"||N==="Space"){a("hotkeysMessage").textContent=`Value '${H}${v.toggles[0]?$:N}' for hotkeys isn't allowed`;return}S=[`${H}${$.length===1?$.toUpperCase():$.replace("Arrow","Arrow ")}`,`${H}${$.length===1?N.replace("Key",""):N.replace("Arrow","Arrow ")}`],k()},k=()=>{b.removeEventListener("keydown",T),b.removeEventListener("keyup",E),b.removeEventListener("click",k),r.hotkeys.disabled=!1,h(S)};r.hotkeys.disabled=!0,b.addEventListener("keydown",T),b.addEventListener("keyup",E),b.addEventListener("click",k)}),u=v.toggles[0]?0:1;for(let m in oe.hotkeys){let h=C(`#${m}Hotkey > button`),b=v.hotkeys[m][u];h.textContent=b==null||b===""?"None":b,h.type="button",h.addEventListener("click",async S=>{S.stopPropagation();let T=await l(S.clientX<=0);if(T!==null){let E=v.toggles[0]?0:1,k=Zt(T[E]);k!==null&&k!==m&&(C(`#${k}Hotkey > button`).textContent="None"),C(`#${m}Hotkey > button`).textContent=T[E],v.hotkeys[m]=T,Oe(),re()}a("hotkeysMessage").textContent="Some hotkeys can be changed by clicking on them"})}a("restoreHotkeys").addEventListener("click",()=>{v.hotkeys=V(oe.hotkeys);let m=v.toggles[0]?0:1;for(let h in v.hotkeys){let b=v.hotkeys[h][m];C(`#${h}Hotkey > button`).textContent=b==null||b===""?"None":b}Oe(),re()}),G("soft"),He()}M.bigWindow="hotkeys";let e=document.body,n=a("closeBigWindow"),s=a("hotkeysHTML"),o=a("bigWindow"),i=f=>{if(M.alert[0]!==null)return;let g=f.code;(!r.hotkeys.disabled&&g==="Escape"||(g==="Enter"||g==="Space")&&document.activeElement===n)&&(f.preventDefault(),c())},c=()=>{M.bigWindow=null,o.style.display="none",s.style.display="none",e.removeEventListener("keydown",i),n.removeEventListener("click",c)};e.addEventListener("keydown",i),n.addEventListener("click",c),a("pauseHotkey").style.display=v.developerMode?"":"none",s.style.display="",o.style.display="",C("#tabRightHotkey > button").focus()};var p=class e extends Array{constructor(n){let s=L.convert(n);super(s[0],s[1])}get mantissa(){return this[0]}get exponent(){return this[1]}clone(){return new e(this)}setValue(n){return this.#e(L.convert(n))}#e(n){return this[0]=n[0],this[1]=n[1],this}plus(...n){let s=this;for(let o=0;o<n.length;o++)s=L.add(s,L.convert(n[o]));return this.#e(s)}minus(...n){let s=this;for(let o=0;o<n.length;o++)s=L.sub(s,L.convert(n[o]));return this.#e(s)}multiply(...n){let s=this;for(let o=0;o<n.length;o++)s=L.mult(s,L.convert(n[o]));return this.#e(s)}divide(...n){let s=this;for(let o=0;o<n.length;o++)s=L.div(s,L.convert(n[o]));return this.#e(s)}power(n){return this.#e(L.pow(this,n))}root(n=2){return this.#e(L.pow(this,1/n))}log(n=2.718281828459045){return this.#e(L.log(this,n))}abs(){return this[0]=Math.abs(this[0]),this}trunc(){return this.#e(L.trunc(this))}floor(){return this.#e(L.floor(this))}ceil(){return this.#e(L.ceil(this))}round(){return this.#e(L.round(this))}isNaN(){return isNaN(this[0])}replaceNaN(n){return isNaN(this[0])?this.#e(L.convert(n)):this}isFinite(){return isFinite(this[0])}lessThan(n){return L.less(this,L.convert(n))}lessOrEqual(n){return L.lessOrEqual(this,L.convert(n))}moreThan(n){return L.more(this,L.convert(n))}moreOrEqual(n){return L.moreOrEqual(this,L.convert(n))}notEqual(n){return L.notEqual(this,L.convert(n))}equal(n){return!L.notEqual(this,L.convert(n))}allEqual(...n){let s=this;for(let o=0;o<n.length;o++){let i=L.convert(n[o]);if(L.notEqual(s,i))return!1;s=i}return!0}max(...n){let s=this;for(let o=0;o<n.length;o++){let i=L.convert(n[o]);if(isNaN(i[0]))return this.#e([NaN,NaN]);L.less(s,i)&&(s=i)}return this.#e(s)}min(...n){let s=this;for(let o=0;o<n.length;o++){let i=L.convert(n[o]);if(isNaN(i[0]))return this.#e([NaN,NaN]);L.more(s,i)&&(s=i)}return this.#e(s)}format(n={}){return L.format(this,n)}toNumber(){return Number(L.turnString(this))}toSafeNumber(){let n=Number(L.turnString(this));return isFinite(n)?n:Number.MAX_VALUE*(n<0?-1:1)}toString(){return L.turnString(this)}toArray(){return[this[0],this[1]]}toJSON(){return L.turnString(this)}},L={convert:e=>{if(typeof e=="object"&&e!==null)return e;typeof e!="string"&&(e=`${e}`);let n=e.indexOf("e"),s=n===-1?[Number(e),0]:[Number(e.slice(0,n)),Number(e.slice(n+1))];if(!isFinite(s[0])||!isFinite(s[1]))return s[0]===0||s[1]===-1/0?[0,0]:isNaN(s[0])||isNaN(s[1])?[NaN,NaN]:[s[0]<0?-1/0:1/0,1/0];let o=Math.abs(s[0]);if(o===0)return[0,0];if(o<1||o>=10){let i=Math.floor(Math.log10(o));s[0]/=10**i,s[1]+=i,Math.abs(s[0])<1&&(s[0]*=10,s[1]--)}return s[0]=Math.round(s[0]*1e14)/1e14,Math.abs(s[0])===10&&(s[0]/=10,s[1]++),s},turnString:e=>e[1]===0||!isFinite(e[0])?`${e[0]}`:`${e[0]}e${e[1]}`,add:(e,n)=>{if(n[0]===0)return e;if(e[0]===0)return[n[0],n[1]];if(!isFinite(e[0])||!isFinite(n[0])){let i=e[0]+n[0];return isNaN(i)?[NaN,NaN]:[i,1/0]}let s=e[1]-n[1];if(Math.abs(s)>=16)return s>0?e:[n[0],n[1]];s===0?e[0]+=n[0]:s>0?e[0]+=n[0]/10**s:(e[0]=n[0]+e[0]*10**s,e[1]=n[1]);let o=Math.abs(e[0]);if(o===0)return[0,0];if(o>=10)e[0]/=10,e[1]++;else if(o<1){let i=-Math.floor(Math.log10(o));e[0]*=10**i,e[1]-=i}return e[0]=Math.round(e[0]*1e14)/1e14,Math.abs(e[0])===10&&(e[0]/=10,e[1]++),e},sub:(e,n)=>L.add(e,[-n[0],n[1]]),mult:(e,n)=>e[0]===0||n[0]===0?[0,0]:(e[1]+=n[1],e[0]*=n[0],isFinite(e[1])?(Math.abs(e[0])>=10&&(e[0]/=10,e[1]++),e[0]=Math.round(e[0]*1e14)/1e14,Math.abs(e[0])===10&&(e[0]/=10,e[1]++),e):e[1]===-1/0?[0,0]:isNaN(e[1])?[NaN,NaN]:[1/0,1/0]),div:(e,n)=>n[0]===0?[NaN,NaN]:e[0]===0?[0,0]:(e[1]-=n[1],e[0]/=n[0],isFinite(e[1])?(Math.abs(e[0])<1&&(e[0]*=10,e[1]--),e[0]=Math.round(e[0]*1e14)/1e14,Math.abs(e[0])===10&&(e[0]/=10,e[1]++),e):e[1]===-1/0?[0,0]:isNaN(e[1])?[NaN,NaN]:[1/0,1/0]),pow:(e,n)=>{if(n===0)return e[0]===0||isNaN(e[0])?[NaN,NaN]:[1,0];if(e[0]===0)return n<0?[NaN,NaN]:[0,0];if(!isFinite(n))return e[1]===0&&e[0]===1||e[0]<0?e[0]===1?[1,0]:[NaN,NaN]:n===-1/0&&e[1]>=0||n===1/0&&e[1]<0?[0,0]:isNaN(n)||isNaN(e[0])?[NaN,NaN]:[1/0,1/0];let s=e[0]<0?Math.abs(n)%2:null;if(s!==null){if(Math.floor(n)!==n)return[NaN,NaN];e[0]*=-1}let o=n*(Math.log10(e[0])+e[1]);if(!isFinite(o))return o===-1/0?[0,0]:isNaN(e[0])?[NaN,NaN]:[s===1?-1/0:1/0,1/0];let i=Math.floor(o);return e[0]=10**(o-i),e[1]=i,e[0]=Math.round(e[0]*1e14)/1e14,e[0]===10&&(e[0]=1,e[1]++),s===1&&(e[0]*=-1),e},log:(e,n)=>{if(Math.abs(n)===1||e[0]===-1&&e[1]===0)return[NaN,NaN];if(e[0]===1&&e[1]===0)return[0,0];if(n===0)return[NaN,NaN];if(e[0]===0)return isNaN(n)?[NaN,NaN]:[Math.abs(n)>1?-1/0:1/0,1/0];if(!isFinite(n))return[NaN,NaN];if(!isFinite(e[0]))return isNaN(e[0])||e[0]===-1/0?[NaN,NaN]:[Math.abs(n)<1?-1/0:1/0,1/0];let s=e[0]<0;if(s){if(n>0)return[NaN,NaN];e[0]*=-1}let o=e[1]<0,i=Math.log10(Math.abs(Math.log10(e[0])+e[1])),c=Math.floor(i);if(e[0]=10**(i-c),e[1]=c,o&&(e[0]*=-1),n!==10){e[0]/=Math.log10(Math.abs(n));let f=Math.abs(e[0]);if(f<1||f>=10){let g=Math.floor(Math.log10(f));e[0]/=10**g,e[1]+=g}}if(n<0||s){if(e[1]<0)return[NaN,NaN];let f=e[1]<16?Math.abs(Math.round(e[0]*1e14)/10**(14-e[1]))%2:0;if(n<0&&!s){if(f!==0)return[NaN,NaN]}else if(f!==1)return[NaN,NaN]}return e[0]=Math.round(e[0]*1e14)/1e14,Math.abs(e[0])===10&&(e[0]/=10,e[1]++),e},less:(e,n)=>e[0]===0||n[0]===0||e[1]===n[1]?e[0]<n[0]:e[0]>0&&n[0]>0?e[1]<n[1]:e[0]<0&&n[0]>0?!0:n[0]<0&&e[0]>0?!1:e[1]>n[1],lessOrEqual:(e,n)=>e[0]===0||n[0]===0||e[1]===n[1]?e[0]<=n[0]:e[0]>0&&n[0]>0?e[1]<n[1]:e[0]<0&&n[0]>0?!0:n[0]<0&&e[0]>0?!1:e[1]>n[1],more:(e,n)=>e[0]===0||n[0]===0||e[1]===n[1]?e[0]>n[0]:e[0]>0&&n[0]>0?e[1]>n[1]:e[0]<0&&n[0]>0?!1:n[0]<0&&e[0]>0?!0:e[1]<n[1],moreOrEqual:(e,n)=>e[0]===0||n[0]===0||e[1]===n[1]?e[0]>=n[0]:e[0]>0&&n[0]>0?e[1]>n[1]:e[0]<0&&n[0]>0?!1:n[0]<0&&e[0]>0?!0:e[1]<n[1],notEqual:(e,n)=>e[1]!==n[1]||e[0]!==n[0],trunc:e=>e[1]<0?[0,0]:(e[1]===0?e[0]=Math.trunc(e[0]):e[1]<=14&&(e[0]=Math.trunc(e[0]*10**e[1])/10**e[1]),e),floor:e=>e[1]<0?[e[0]<0?-1:0,0]:(e[1]===0?e[0]=Math.floor(e[0]):e[1]<=14&&(e[0]=Math.floor(e[0]*10**e[1])/10**e[1]),e[0]===-10&&(e[0]=-1,e[1]++),e),ceil:e=>e[1]<0?[e[0]<0?0:1,0]:(e[1]===0?e[0]=Math.ceil(e[0]):e[1]<=14&&(e[0]=Math.ceil(e[0]*10**e[1])/10**e[1]),e[0]===10&&(e[0]=1,e[1]++),e),round:e=>e[1]<0?[e[1]===-1?Math.round(e[0]/10):0,0]:(e[1]===0?e[0]=Math.round(e[0]):e[1]<=14&&(e[0]=Math.round(e[0]*10**e[1])/10**e[1]),Math.abs(e[0])===10&&(e[0]/=10,e[1]++),e),format:(e,n)=>{let[s,o]=e;if(!isFinite(s))return`${s}`;let i=n.type??"number",c=n.padding;if(o>=1e4||o<=-1e4){let u=o,m=Math.round(s*100)/100;Math.abs(m)===10&&(m/=10,u++),u=Math.floor(Math.log10(Math.abs(u)));let h=Math.round(o/10**(u-2))/100;Math.abs(h)===10&&(h/=10,u++),c==="exponent"&&(c=!0);let b=c?h.toFixed(2):`${h}`;if(i!=="input")return h=Math.abs(h),s<0&&(h*=-1),`${b.replace(".",v.format[0])}e${o<0?"-":""}e${u}`;let S=c?m.toFixed(2):`${m}`;return i==="input"?`${S}e${b}e${u}`:`${S.replace(".",v.format[0])}e${b.replace(".",v.format[0])}e${u}`}if(o>=6||o<-3){let u=o,m=Math.round(s*100)/100;Math.abs(m)===10&&(m/=10,u++),c==="exponent"&&(c=!0);let h=c?m.toFixed(2):`${m}`;return i==="input"?`${h}e${u}`:`${h.replace(".",v.format[0])}e${u}`}let f=Math.max(4-Math.max(o,0),0),g=Math.round(s*10**(f+o))/10**f;c==="exponent"&&(c=!1);let l=c?g.toFixed(f):`${g}`;return i==="input"?l:g>=1e3?l.replace(".",v.format[0]).replace(/\B(?=(\d{3})+(?!\d))/,v.format[1]):l.replace(".",v.format[0])}};var t={version:"v0.2.1",fileName:"Fundamental, [dateD.M.Y] [timeH-M-S], [stage]",stage:{true:1,current:1,active:1,resets:0,time:0,peak:0,input:[0,0]},discharge:{energy:0,energyMax:0,current:0},vaporization:{clouds:new p("0"),cloudsMax:new p("0"),input:[3,0]},accretion:{rank:0},collapse:{mass:.01235,massMax:.01235,stars:[0,0,0],show:0,input:[2,1e6]},merge:{reward:[0],resets:0},inflation:{tree:[],vacuum:!1,resets:0,age:0},time:{updated:Date.now(),started:Date.now(),export:[0,0,0,0],offline:0,online:0,stage:0,universe:0},buildings:[[],[{current:new p("3"),total:new p("3"),trueTotal:new p("3")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")}],[{current:new p("2.7753108348135e-3"),total:new p("2.7753108348135e-3"),trueTotal:new p("2.7753108348135e-3")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")}],[{current:new p("1e-19"),total:new p("1e-19"),trueTotal:new p("1e-19")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")}],[{current:new p("1"),total:new p("1"),trueTotal:new p("1")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")}],[{current:new p("0"),total:new p("0"),trueTotal:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")}],[{current:new p("0"),total:new p("0"),trueTotal:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0")}]],strange:[{current:0,total:0},{current:0,total:0}],cosmon:{current:0,total:0},upgrades:[],researches:[],researchesExtra:[],researchesAuto:[],ASR:[],elements:[],strangeness:[],milestones:[],challenges:{active:null,void:[0,0,0,0,0,0],voidCheck:[0,0,0,0,0,0]},toggles:{normal:[],confirm:[],buildings:[],hover:[],max:[],auto:[],shop:{input:0,wait:[2]}},history:{stage:{best:[31556952e9,0,0,0],list:[],input:[5,10]},vacuum:{best:[31556952e9,!1,0],list:[],input:[5,10]}},events:[!1,!1]},r={tab:"stage",subtab:{stageCurrent:"Structures",settingsCurrent:"Settings",upgradeCurrent:"Upgrades",strangenessCurrent:"Matter",inflationCurrent:"Researches"},tabList:{tabs:["stage","upgrade","strangeness","inflation","settings"],stageSubtabs:["Structures","Advanced"],settingsSubtabs:["Settings","History","Stats"],upgradeSubtabs:["Upgrades","Elements"],strangenessSubtabs:["Matter","Milestones"],inflationSubtabs:["Researches","Milestones"]},debug:{offlineSpeed:.2,errorID:!0,errorQuery:!0,errorGain:!0,timeLimit:!1,rankUpdated:null,historyStage:null,historyVacuum:null},trueActive:1,lastSave:0,paused:!0,footer:!0,hotkeys:{disabled:!0,shift:!1,ctrl:!1},automatization:{autoU:[[],[],[],[],[],[],[]],autoR:[[],[],[],[],[],[],[]],autoE:[[],[],[],[],[],[]],elements:[]},dischargeInfo:{energyType:[[]],energyStage:[0],energyTrue:0,tritium:new p("0"),base:4,total:0,next:1},vaporizationInfo:{trueResearch0:0,trueResearch1:0,trueResearchRain:0,get:new p("0")},accretionInfo:{unlockA:[2,4,8,11],rankU:[1,1,2,2,3,3,4,4,4,4,5,5,5],rankR:[1,1,2,2,3,3,3,4,5],rankE:[2,3,4,5,3],dustSoft:1,maxRank:4,rankCost:[59722e23,1e-7,1e10,1e24,5e29,245576045e23,198847e35],rankColor:["blue","cyan","gray","gray","gray","darkviolet","orange","gray"],rankName:["Ocean world","Cosmic dust","Meteoroid","Asteroid","Planet","Jovian planet","Protostar","Protogalaxy"],rankImage:["Ocean%20world.png","Dust.png","Meteoroids.png","Asteroid.png","Planet.png","Giant.png","Protostar.png","Protogalaxy.png"]},collapseInfo:{neutronEffect:1,unlockB:[0,.01235,.23,10,40,1e3],unlockU:[.01235,.076,1.3,10,40],unlockR:[.18,.3,.8,1.3,40,1e3],newMass:0,starCheck:[0,0,0],trueStars:0},mergeInfo:{galaxyBase:0,checkReward:[0]},inflationInfo:{globalSpeed:1,preonCap:new p("1e14"),dustCap:new p("1e48"),massCap:.01235,preonTrue:new p("0"),dustTrue:new p("0")},intervalsId:{main:void 0,numbers:void 0,visual:void 0,autoSave:void 0,mouseRepeat:void 0},stageInfo:{word:["","Microworld","Submerged","Accretion","Interstellar","Intergalactic","Abyss"],textColor:["","cyan","blue","gray","orange","darkorchid","darkviolet"],buttonBorder:["","darkcyan","#386cc7","#424242","#a35700","#8f004c","#6c1ad1"],imageBorderColor:["","#008b8b","#1460a8","#5b5b75","#e87400","#b324e2","#5300c1"],activeAll:[1]},buildingsInfo:{maxActive:[0,4,6,5,5,4,2],name:[[],["Mass","Preons","Quarks","Particles","Atoms","Molecules"],["Moles","Drops","Puddles","Ponds","Lakes","Seas","Oceans"],["Mass","Cosmic dust","Planetesimals","Protoplanets","Satellites","Subsatellites"],["Elements","Brown dwarfs","Main sequence","Red supergiants","Blue hypergiants","Quasi-stars"],["Stars","Nebulas","Star clusters","Galaxies"],["Dark matter","Universes"]],hoverText:[[],["Mass","Preons","Quarks","Particles","Atoms"],["Tritium","Drops","Puddles","Ponds","Lakes","Seas"],["Preons hardcap","Cosmic dust","Planetesimals","Protoplanets","Satellites"],["Elements","Elements","Elements","Elements","Elements"],["Interstellar Stars","Interstellar Stars","Nebulas and Star clusters"],["Dark matter"]],type:[[],["producing","producing","producing","producing","producing"],["producing","producing","improving","improving","improving","improving"],["producing","producing","producing","improving","improving"],["producing","producing","producing","producing","producing"],["producing","improving","improving"],["producing"]],startCost:[[],[0,.005476,6,3,24,3],[0,.0027753108348135,100,1e7,1e18,1e23,2676e22],[0,1e-19,1e-9,1e21,1e17,1e22],[0,1,1e5,1e15,1e27,1e50],[0,1e50,1e54,1e5],[0,1]],increase:[[],[0,1.4,1.4,1.4,1.4,1.4],[0,1.15,1.2,1.25,1.35,1.4,4],[0,1.15,1.25,1.35,10,10],[0,1.4,1.55,1.7,1.85,2],[0,2,2,1.11],[0,2]],producing:[]},strangeInfo:{name:["Strange quarks","Strangelets"],stageBoost:[1,1,1,1,1,1],strangeletsInfo:[0,1],quarksGain:0,bestHistoryRate:0},upgradesInfo:[{},{name:["Weak force","Strong force","Electrons","Protons","Neutrons","Superposition","Protium","Deuterium","Tritium","Nuclear fusion"],effectText:[()=>"Particles will produce 8 times more Quarks.",()=>"Gluons will be able to bind Quarks into Particles, which will make Particles 16 times cheaper.",()=>`${t.inflation.vacuum?"Atoms":"Particles"} will be 8 times cheaper.`,()=>`Atoms will produce ${t.inflation.vacuum?6:4} times more Particles.${t.upgrades[1][3]!==1&&t.upgrades[1][5]!==1&&t.buildings[1][t.inflation.vacuum?4:2].total.lessOrEqual("0")?`
(Can't be created due to not having any Atoms)`:""}`,()=>`Molecules will produce 4 times more Atoms.${t.upgrades[1][4]!==1&&t.upgrades[1][5]!==1&&t.buildings[1][t.inflation.vacuum?5:3].total.lessOrEqual("0")?`
(Can't be created due to not having any Molecules)`:""}`,()=>`Ability to regain spent Energy and if had enough Energy will also boost production for all ${t.inflation.vacuum?"Microworld ":""}Structures by ${d(r.dischargeInfo.base,{padding:!0})}.${t.inflation.vacuum?`
(In true Vacuum it will also reset resources and all non-self made Structures from all Stages${t.stage.true>=7?" before Abyss":""}, and enough self-made Structures to fully regain spent Energy)`:""}`,()=>`Decrease Structures cost scaling by -${d(y.S1Upgrade6()/100)}.`,()=>{let e=y.S1Upgrade7(),n=y.S1Upgrade7(!0);return`Make self-made Structures boost themselves by ${d(e)}.${t.inflation.vacuum?`
(Self-made Preons boost themselves by ${d(new p(e/n).power((t.buildings[1][1].true-1)/1e3).multiply(n),{padding:!0})} instead, softcaps instantly)`:""}`},()=>`Molecules will produce Molecules. At a reduced rate.
(${d(r.dischargeInfo.tritium,{padding:!0})} Molecules per second)`,()=>`Unspent Energy ^${d(.5)} will boost 'Tritium' production of Molecules.
(Boost: ${d(Math.max(t.discharge.energy,1)**.5,{padding:!0})})`],startCost:[40,60,100,120,180,360,1200,3600,12e3,8e4],maxActive:10},{name:["Molecules to Moles","Water spread","Vaporization","Surface tension","Surface stress","Stream","River","Tsunami","Tide"],effectText:[()=>`Drops will ${t.inflation.vacuum?"improve Tritium":"produce Moles"} ${d(t.inflation.vacuum?1.02:1.04)} times ${t.inflation.vacuum?"more":"faster"} for every self-made Drop.${t.upgrades[2][0]!==1&&t.buildings[2][1].true<1&&t.buildings[2][2].current.lessThan("1")?`
(Can't be created due to not having any self-made Drops)`:""}`,()=>`Spread water faster with every Puddle, current formula is ${d(1.02)} ^ effective Puddles.
Puddles after 200 and non self-made ones are raised to the power of ${d(.7)}.
(Total effect: ${d(y.S2Upgrade1(),{padding:!0})})`,()=>`Gain ability to convert Drops into Clouds. Cloud gain formula is '(Clouds ^ (1 / softcap) + (Drops / ${d(y.S2Upgrade2())})) ^ softcap - Clouds', softcap is ${d(t.challenges.active===0?.4:t.inflation.vacuum?.5:.6)}.`,()=>{let e=y.S2Upgrade3();return`Puddles will get a boost based on Moles ^${d(e)}.
(Boost: ${d(new p(t.buildings[2][0].current).max("1").power(e),{padding:!0})})`},()=>{let e=y.S2Upgrade4();return`Puddles will get a boost based on Drops ^${d(e)}.
(Boost: ${d(new p(t.buildings[2][1].current).max("1").power(e),{padding:!0})})`},()=>`Ponds will increase current Puddle amount. (${d(y.S2Upgrade5())} extra Puddles per Pond)`,()=>`Lakes will increase current Pond amount. (${d(y.S2Upgrade6())} extra Ponds per Lake)`,()=>"Spreads enough water to make Seas increase current Lake amount. (1 extra Lakes per Sea)",()=>`Spreads water too fast. 1 extra Seas per Ocean.
Also will improve Oceans effect scaling.`],startCost:[10,1e6,1e10,1e3,1e4,2e9,5e20,1e28,2e48],maxActive:8},{name:["Brownian motion","Gas","Micrometeoroid","Streaming instability","Gravitational field","Rubble pile","Magma ocean","Hydrostatic equilibrium","Satellite system","Atmosphere","Pebble accretion","Tidal force","Ring system"],effectText:[()=>`Through random collisions every self-made Cosmic dust will ${t.inflation.vacuum?"delay Preons hardcap even more":"produce even more Mass"}.
(By ${d(y.S3Upgrade0())} per self-made Cosmic dust)`,()=>`New substance for Accretion, will provide boost to Cosmic dust based on its current quantity, weaker for non self-made ones.
(Boost: ${d(y.S3Upgrade1(),{padding:!0})})`,()=>`Just a small meteoroid, but it will be a good base for what to come.
(Unlock a new Structure and get 2x boost to Cosmic dust)`,()=>`Small bodies will spontaneously concentrate into clumps.
(Self-made Planetesimals will boost each other by ${d(y.S3Upgrade3())})`,()=>`Bodies will become massive enough to affect each other with gravity.
(Unlock a new Structure and get 3x boost to Planetesimals)`,()=>`Shattered pieces will fall back together. ${t.inflation.vacuum?"Preons hardcap delay":"Mass production"} from Cosmic dust will be increased by 3.`,()=>`Melt the core to increase Accretion speed.
(Cosmic dust strength will be increased by ${d(2*1.5**t.researches[3][7])})`,()=>`After reaching equilibrium self-made Protoplanets will boost each other by ${d(1.02)}.`,()=>"Unlock yet another Structure.",()=>`${t.inflation.vacuum?"Preons hardcap delay":"Mass production"} from Cosmic dust will be increased again (because of drag and escape velocity), by 2.`,()=>`${t.inflation.vacuum?"Preons hardcap delay":"Mass production"} from Cosmic dust will be greatly increased by ${8*2**t.researches[3][8]}.`,()=>`Satellites cost scaling will be 2 times smaller.${t.inflation.vacuum?`
Also unlock a new Structure.`:""}`,()=>"Satellites effect will scale better."],startCost:[1e-16,1e-13,1e-13,1,1e14,1e17,1e10,1e22,1e22,1e23,1e9,1e26,1e29],maxActive:13},{name:["Gravitational Collapse","Proton-proton chain","Carbon-Nitrogen-Oxygen cycle","Helium fusion","Nucleosynthesis"],effectText:[()=>`Stars will Collapse once fuel runs out, but they will leave behind Remnants which will boost production in their own special way.
Solar mass ${t.inflation.vacuum?`on Collapse is Accretion Mass / ${d(198847e28)} and `:""}will not decrease if to reset bellow current. (Hover over Remnants effects to see what they boosts)`,()=>"Fuse with Protium instead of Deuterium. Unlock 5 first Elements. ('Elements' subtab)",()=>"Unlock CNO cycle which is a better source of Helium and Energy. Unlock 5 more Elements.",()=>"Through Triple-alpha and then Alpha process unlock 2 more Elements.",()=>`Create new Atomic nuclei with Neutron capture (s-process and p-process).
Unlock 1 more Element and +1 for every self-made ${t.stage.true<7?"(not unlocked)":"Universe"}.`],startCost:[100,1e3,1e9,1e48,1e128],maxActive:4},{name:["Molecular cloud","Super Star cluster","Quasar","Galactic Merger"],effectText:[()=>`Nebula that is dense enough to block the light, it will boost Nebulas by ${d(y.S5Upgrade0())}.`,()=>`A very massive Star cluster that will boost Star clusters by ${d(y.S5Upgrade1())}.`,()=>`Boost per Galaxy will be increased by +${d(y.S5Upgrade2(!1,1),{padding:!0})}.
(Effect will be stronger with more Solar mass past ${d(1e5)}, maxed at +1)`,()=>`Unlock a new reset type that will bring Galaxies closer for potential Merging.${t.inflation.vacuum?" That reset behaves like a Galaxy reset, while also converting self-made Galaxies into non self-made through new and even bigger Structures. Can only be done once per Stage reset.":""}`],startCost:[1e56,1e60,1e120,1e160],maxActive:4},{name:[],effectText:[],startCost:[],maxActive:0}],researchesInfo:[{},{name:["Stronger Protium","Better Deuterium","Improved Tritium","Requirement decrease","Discharge improvement","Radioactive Discharge"],effectText:[()=>`Cost scaling will be -${d(.03)} smaller with each level.`,()=>`Self-made Structures will boost each other by additional +${d(.01)}.`,()=>`Molecules will produce themselves ${d(y.S1Research2())} times quicker.`,()=>`Discharge goals requirement will scale slower. (-2)
(Creating this Research will make next Discharge goal to be ${d((at()-2)**t.discharge.current)} Energy)`,()=>{let e=y.dischargeBase(t.researches[1][4]+1);return`Discharge production boost from reached goals will be increased by +${d(e-r.dischargeInfo.base)}.
(This is equal to ${d((e/r.dischargeInfo.base)**r.dischargeInfo.total,{padding:!0})}x boost improvement)`},()=>`Discharge goals will be able to boost 'Tritium'.
(Current effect: ${d(y.S1Research5())} ^ level)`],cost:[],startCost:[1600,4800,16e3,32e3,16e3,24e3],scaling:[400,1200,8e3,4e4,16e3,16e3],max:[5,4,8,2,4,3],maxActive:6},{name:["Better Mole production","Better Drop production","Stronger surface tension","Stronger surface stress","More streams","Distributary channel"],effectText:[()=>`Drops will ${t.inflation.vacuum?"improve Tritium":"produce Moles"} 3 times more.${t.upgrades[2][2]===1||t.inflation.vacuum?`
Effective level ${r.vaporizationInfo.trueResearch0!==t.researches[2][0]?`is ${d(r.vaporizationInfo.trueResearch0,{padding:!0})}, will be restored with more Drops`:"will be set to 0 after any Reset"}.`:""}`,()=>`Puddles will produce 2 times more Drops.${t.upgrades[2][2]===1||t.inflation.vacuum?`
Effective level ${r.vaporizationInfo.trueResearch1!==t.researches[2][1]?`is ${d(r.vaporizationInfo.trueResearch1,{padding:!0})}, will be restored with more Drops`:"will be set to 0 after any Reset"}.`:""}`,()=>`'Surface tension' base will be +${d(.005)} stronger.
(This is equal to ${d(new p(t.buildings[2][0].current).max("1").power(y.S2Upgrade3(t.researches[2][2]+1)-y.S2Upgrade3()).toNumber(),{padding:!0})}x boost improvement)`,()=>`'Surface stress' base will be +${d(.005)} stronger.
(This is equal to ${d(new p(t.buildings[2][1].current).max("1").power(y.S2Upgrade4(t.researches[2][3]+1)-y.S2Upgrade4()).toNumber(),{padding:!0})}x boost improvement)`,()=>"With more streams, will be able to have even more extra Puddles. (+1 extra Puddles per Pond)",()=>"Rivers will be able to split, which will allow even more Ponds per Lake. (+1 per)"],cost:[],startCost:[10,400,1e4,1e5,1e14,1e22],scaling:[1.366,5,1e3,100,1e3,1e4],max:[8,8,4,4,2,1],maxActive:6},{name:["More massive bodies","Adhesion","Space weathering","Inelastic collisions","Destructive collisions","Contact binary","Gravity","Planetary differentiation","Aerodynamic drag"],effectText:[()=>"Increase strength of Cosmic dust by 3.",()=>`Cosmic dust particles will cling to each other. (+${d(.01)} to 'Brownian motion')`,()=>"Planetesimals will produce more Cosmic dust. (3 times more)",()=>`Slow encounter velocities will result in a more efficient growth.
${t.inflation.vacuum?"Preons hardcap delay":"Mass production"} from Cosmic dust will be increased by 2.`,()=>`Planetesimals when shatter will replenish small grains quantity.
'Streaming instability' effect will be increased by +${d(.005)}.`,()=>`Some Planetesimals instead of shattering will form a contact binary or even trinary.
${t.inflation.vacuum?"Preons hardcap delay":"Mass production"} from Cosmic dust will be increased by 3.`,()=>{let e=y.S3Research6();return`Planetesimals will attract other bodies and get a boost to own production based on unspent Mass ^${d(e>1?1/new p(t.buildings[3][0].current).log(e).toNumber():0,{padding:!0})}.
(Boost: ${d(e,{padding:!0})} \u27F6 ${d(y.S3Research6(t.researches[3][6]+1),{padding:!0})}, weaker after ${d(1e21)} Mass)`},()=>`'Magma Ocean' will become stronger, by ${d(1.5)}.`,()=>`Improve 'Pebble accretion' Accretion speed even more.
${t.inflation.vacuum?"Preons hardcap delay":"Mass production"} from Cosmic dust will increased by 2.`],cost:[],startCost:[1e-16,1e-15,1e-5,100,1e10,1e11,1e15,1e14,1e12],scaling:[11,111,22,10,100,100,10,1e4,1e3],max:[9,3,8,8,2,2,6,4,4],maxActive:9},{name:["Planetary system","Star system","Protoplanetary disk","Planetary nebula","Gamma-ray burst","Inner Black hole"],effectText:[()=>{let e=y.S4Research0_base();return`From Planetesimals to Planets, will get ${d(e)}x boost to all Stars per level.
(Total boost: ${d(y.S4Research0(e),{padding:!0})})`},()=>{let e=y.S4Research1();return`All self-made Stars will boost each other by ${d(e)}.
(Total boost: ${d(new p(e).power(r.collapseInfo.trueStars),{padding:!0})} \u27F6 ${d(new p(y.S4Research1(t.researches[4][1]+1)).power(r.collapseInfo.trueStars),{padding:!0})})`},()=>`Improve effect scaling of 'Planetary system', as well increase its max level by +3.
(Total boost from 'Planetary system' will be increased by ${d(y.S4Research0(y.S4Research0_base(t.researches[4][2]+1)/y.S4Research0_base()),{padding:!0})})`,()=>"Matter will be expelled from Red giants, this will boost Main-sequence Stars by 2, as well increase 'Planetary system' max level by +3.",()=>`An immensely energetic explosion that will boost all Stars by ${d(y.S4Research4(),{padding:!0})}${t.researches[4][4]<2?` \u27F6 ${d(y.S4Research4(!1,t.researches[4][4]+1),{padding:!0})}`:""}.
(Effect will be stronger with more Black holes${t.elements[23]>=1?" and Solar mass":""})`,()=>"Quasi-stars will Collapse into Intermediate-mass Black holes that are equivalent to +1 (Stellar) Black holes per level."],cost:[],startCost:[1e3,5e4,1e8,1e11,1e28,1e154],scaling:[10,200,1e12,1,2e8,1],max:[3,2,1,1,2,1],maxActive:5},{name:["Higher density","Type frequency"],effectText:[()=>`Higher density of Nebulas, will allow them to produce higher tier of Stars, but each tier is 4 times slower than previous one. Also will boost Nebulas by 2.
Next tier will be ${r.buildingsInfo.name[4][Math.min(t.researches[5][0]+2,t.inflation.vacuum?5:4)]}.`,()=>`More of same Star type will be found within Star cluster. Star clusters will be improved by 2 and will also boost lower tier of Stars, but 2 times less than previous one.
Next tier will be ${r.buildingsInfo.name[4][Math.max((t.inflation.vacuum?4:3)-t.researches[5][1],1)]}.`],cost:[],startCost:[1e54,1e58],scaling:[1e8,1e8],max:[4,4],maxActive:2},{name:[],effectText:[],cost:[],startCost:[],scaling:[],max:[],maxActive:0}],researchesExtraInfo:[{},{name:["Extra strong force","Improved formula","Accretion","Later Preons","Impulse"],effectText:[()=>`Mesons will be able to bind Particles to form Atoms, which will make Atoms to be affected by 'Strong force'.
(Atoms will be 16 times cheaper)`,()=>{let e=y.S1Extra1(),n=y.S1Extra1(t.researchesExtra[1][1]+1);return`Improve 'Tritium' formula, current formula is log${d(e)}${t.researchesExtra[1][1]<4?` \u27F6 log${d(n)}.
(Which is equal to ${d(We(e,n),{padding:!0})}x improvement)`:"."}`},()=>`First level is to begin the Accretion, second level is to Submerge it.
All Structures produce Energy on creation and all resets affect all lower Stages, while also doing Discharge reset. Accretion Mass is Microworld Mass / ${d(178266192e-41)} and Moles are Molecules * ${d(602214076e15)}.`,()=>{let e=y.S1Extra3();return`Boost Preons and delay hardcap by current Energy ^${d(e)}.
(Effect: ${d(Math.max(t.discharge.energy,1)**e,{padding:!0})} \u27F6 ${d(Math.max(t.discharge.energy,1)**y.S1Extra3(t.researchesExtra[1][3]+1),{padding:!0})})`},()=>{let e=y.S1Extra4();return`Discharge goals will be able to boost all Interstellar Stars, strength is based on Energy and Discharge base.
Current base is ${d(e,{padding:!0})}, total boost is ${d(new p(e).power(r.dischargeInfo.total),{padding:!0})}.`}],cost:[],startCost:[2e3,4e4,12e3,16e3,16e4],scaling:[0,16e3,68e3,16e3,0],max:[1,4,2,4,1],maxActive:0},{name:["Natural Vaporization","Rain Clouds","Storm Clouds","Water Accretion"],effectText:[()=>"When formed Clouds will use Drops produced this reset instead of current ones.",()=>{let e=t.researchesExtra[2][1],n=r.vaporizationInfo.trueResearchRain,s=t.buildings[2][2].current.lessThan("1"),o=y.S2Extra1;return`Some Clouds will start pouring Drops themselves. This will boost Puddles, even if there are none, based on current Clouds.${t.researchesExtra[2][2]<1?`
Effective level ${n!==e?`is ${d(n,{padding:!0})}, will be restored with more Drops, this doesn't`:"will be set to 0 after any Reset, this will not"} affect pre Puddles boost.`:""}
(Effect: ${d(s?o(e)-1:o(n),{padding:!0})} \u27F6 ${d(s?o(e+1)-1:o(e+(n===e?1:0)),{padding:!0})}, weaker after ${d(1e6)} Clouds)`},()=>`Make 'Rain Clouds' boost Seas at a reduced rate and also prevent its effective level from resetting.
(Effect: ${d(y.S2Extra2(y.S2Extra1(r.vaporizationInfo.trueResearchRain),1),{padding:!0})})`,()=>{let e=t.researchesExtra[2][3],n=t.upgrades[2][3]===1?new p(t.buildings[2][0].current).max("1").power(y.S2Upgrade3()).toNumber():1,s=t.upgrades[2][4]===1?new p(t.buildings[2][1].current).max("1").power(y.S2Upgrade4()).toNumber():1;return`Submerge and boost Stars with 'Surface tension'. Also with 'Surface stress' ^${d(.5)} at level 2, full power at level 3.
(Boost to Stars: ${e<3?`${d(e<1?1:n*(e>1?s**.5:1),{padding:!0})} \u27F6 `:""}${d(n*(e<1?1:s**(e>1?1:.5)),{padding:!0})})`}],cost:[],startCost:[1e18,1e12,1e26,1e14],scaling:[1,1e3,1,1e8],max:[1,3,1,3],maxActive:3},{name:["Rank boost","Efficient growth","Weight","Viscosity","Efficient submersion"],effectText:[()=>`Increase strength of Cosmic dust by another ${d(1.11)} per level. Max level is based on current Rank.
(Total increase: ${d(1.11**t.researchesExtra[3][0],{padding:!0})})`,()=>{let e=y.S3Extra1();return`${t.inflation.vacuum?"Preons hardcap delay":"Mass production"} from Cosmic dust will be even bigger, current formula is ${d(e)} ^ current Rank.
(Total boost: ${d(e**t.accretion.rank,{padding:!0})} \u27F6 ${d(y.S3Extra1(t.researchesExtra[3][1]+1)**t.accretion.rank,{padding:!0})})`},()=>"'Gravitational field' will be able to boost Protoplanets, but at reduced strength. (2x boost)",()=>`'Gas' will be ${d(y.S3Upgrade1(t.researchesExtra[3][3]+1)/y.S3Upgrade1(),{padding:!0})}x stronger per level.`,()=>`Submerge quicker by boosting Puddles, improved by current Rank.
(Current boost: ${d(y.S3Extra4())} \u27F6 ${d(y.S3Extra4(t.researchesExtra[3][4]+1))})`],cost:[],startCost:[1e-18,1e-7,1e26,1e9,1e-10],scaling:[10,100,1,1e5,1e12],max:[14,6,1,5,1],maxActive:4},{name:["Nova","Mass transfer","White dwarfs","Quark-nova"],effectText:[()=>`This violent stellar explosion is main source of Elements, but also starts new Star formation.
Unlock a new Star and even more, after Collapse of that Star.
(Will require at least ${d(r.collapseInfo.unlockB[Math.min(t.researchesExtra[4][0]+2,4)])} Solar mass to create that new Star)`,()=>`Star material will transfer from one Star to another, improving Solar mass gain${t.inflation.vacuum?" (also delaying Preons hardcap)":""} by ${d(y.S4Extra1())}.
Improved by 'Star system' levels and also improves its scaling (effect increase for 'Star system' is ${d(new p(y.S4Research1(void 0,1)/y.S4Research1(void 0,0)).power(r.collapseInfo.trueStars),{padding:!0})}).`,()=>`After matter were dispeled from Red giant, White dwarf was all that remained.
Improves effect of '[6] Carbon' by +${d(.5)} and increases max level of 'Star system' by +1.`,()=>`As Neutron stars spins down, some of them may convert into Quark stars.
This will add new effect to Neutron stars \u2012 all Stars are cheaper, also will increase max level of 'Star system' by +1.`],cost:[],startCost:[4e4,2e9,1e50,1e136],scaling:[1e10,1,1,1],max:[3,1,1,1],maxActive:3},{name:["Hypercompact stellar system"],effectText:[()=>`Super dense core which will allow creation of a new Structure. That Structure will increase Stage reset reward, boost Nebulas and Star clusters, but creating it fully resets ${t.inflation.vacuum?"all":"Interstellar and Intergalactic"} Stages${t.inflation.vacuum?", Energy from creating it won't reset on this or any lower Reset tiers":t.strangeness[5][3]<1?", can't be created because 'Gravitational bound' is missing":""}.
This Research also removes Solar mass and other Remnants requirement from everything in Interstellar.`],cost:[],startCost:[1e80],scaling:[1],max:[1],maxActive:1},{name:[],effectText:[],cost:[],startCost:[],scaling:[],max:[],maxActive:0}],researchesAutoInfo:{name:["Upgrade automatization","Element automatization","Reset automatization"],effectText:[()=>`Automatically create all ${["Upgrades","Stage Researches","Special Researches"][Math.min(t.researchesAuto[0],2)]} from any Stage. (Need to be enabled in Settings)`,()=>`Elements will no longer require Collapse for activation.
Second level will unlock auto creation of Elements. (Need to be enabled in settings)`,()=>`Unlock auto ${t.inflation.vacuum?["Discharge","Rank","Vaporization","Collapse"][Math.min(t.researchesAuto[2],3)]:["Discharge","Vaporization","Rank","Collapse"][Math.min(t.stage.current-1,3)]} level 1. (Need to be enabled in settings)`],costRange:[[1e13,2e34,1e30],[136e3,272e3],[1200,2400,7200,28800]],autoStage:[[2,3,4],[1,1],[6,6,6,6]],max:[3,2,1]},ASRInfo:{name:"Auto Structures",effectText:()=>{let e=t.stage.active,n=Math.min(t.ASR[e]+1,Math.max(r.ASRInfo.max[e],1)),s=!0;return t.stage.true<6?e===3&&t.stage.resets<5?n===2?s=t.upgrades[3][2]===1||t.buildings[3][2].trueTotal.moreThan("0"):n===3&&(s=t.upgrades[3][4]===1||t.buildings[3][3].trueTotal.moreThan("0")):e===5&&(n===1?s=t.milestones[2][0]>=7:n===2?s=t.milestones[3][0]>=7:n===3&&(s=t.milestones[4][1]>=8)):t.stage.true<7&&t.stage.resets<2&&n===5&&(e===3?s=t.upgrades[3][11]===1||t.buildings[3][5].trueTotal.moreThan("0"):e===4&&(s=t.elements[26]>=1)),`Automatically make ${s?r.buildingsInfo.name[e][n]:"(not unlocked)"} (counts as self-made).
(Auto ${e===5&&n===3||e===6?"for this Structure doesn't wait and ignores related settings":`will wait until ${d(t.stage.true>=3?t.toggles.shop.wait[e]:2)} times of the Structure cost`})`},costRange:[[],[2e3,8e3,16e3,32e3,56e3],[1e10,1e14,1e18,1e23,1e28,1e30],[1e-7,1e10,5e29,2e30,2e36],[1e6,1e17,1e28,1e39,1e52],[1e56,1e60,1e100],[1/0]],max:[0,3,5,4,4,3,0]},elementsInfo:{name:["[0] Neutronium","[1] Hydrogen","[2] Helium","[3] Lithium","[4] Beryllium","[5] Boron","[6] Carbon","[7] Nitrogen","[8] Oxygen","[9] Fluorine","[10] Neon","[11] Sodium","[12] Magnesium","[13] Aluminium","[14] Silicon","[15] Phosphorus","[16] Sulfur","[17] Chlorine","[18] Argon","[19] Potassium","[20] Calcium","[21] Scandium","[22] Titanium","[23] Vanadium","[24] Chromium","[25] Manganese","[26] Iron","[27] Cobalt","[28] Nickel","[29] Copper","[30] Zinc","[31] Gallium"],effectText:[()=>`Element with no protons, true head of this table.
This one is ${Math.random()<.1?Math.random()<.1?"an illusive Tetraneutron, or maybe even Pentaneutron, wait where did it go? Was it even there?":"a rare Dineutron, but it is already gone...":"a simple Mononeutron, it will stay with you for as long as it can."}`,()=>`Most basic Element, increases Brown dwarf${t.inflation.vacuum?" and Puddles":""} production by 2.`,()=>`Fusion reaction byproduct, makes Interstellar Stars cost scale -${d(.1)} less.`,()=>`First metal, Solar mass gain${t.inflation.vacuum?" and hardcap delay for Cosmic dust":""} per Brown dwarf will be lightly increased.`,()=>`Brittle earth metal and so is brittle increase to production.
(${d(1.4)}x boost to all Stars${t.inflation.vacuum?" and Cosmic dust":""})`,()=>`A new color, and a new boost to Solar mass gain${t.inflation.vacuum?" and delay to Cosmic dust hardcap":""} that is based on current Dwarf Stars.`,()=>`Base for organics, boost from Red giants will be increased by ^${d(y.element6())}.`,()=>"Most abundant Element in atmosphere of some Planets that will allow to have 2 extra levels of 'Star system'.",()=>`An oxidizing agent that will make Interstellar Stars cost scale even slower. (-${d(.05)} less)`,()=>"Highly toxic and reactive, +12 to max level of 'Planetary system'.",()=>`A noble 2x boost to Solar mass gain${t.inflation.vacuum?" and delay to Preons hardcap":""}.`,()=>"Through leaching will get 1 extra level of 'Protoplanetary disk'.",()=>"Stars are inside you, as well Neutron stars strength will be increased by log4.",()=>"Has a great affinity towards Oxygen and to decrease cost for all Stars by 100.",()=>`Just another tetravalent metalloid, and so is another ${d(1.4)}x boost to all Stars${t.inflation.vacuum?" and Cosmic dust":""}.`,()=>`One of the Fundamentals for Life and to make all Stars boost Solar mass gain${t.inflation.vacuum?" and also delay Cosmic dust hardcap":""}.`,()=>"From hot area to increase max level of 'Star system' by 1.",()=>"Extremely reactive to extend max level of 'Planetary system' by another 24 levels.",()=>"Less noble, but Black holes effect will be a little stronger.",()=>`Don't forget about it and will get 1 free level of 'Planetary system'.
(Also will make Solar mass effect apply twice to Brown dwarfs)`,()=>"Get stronger with 1 extra level of 'Star system'.",()=>`A new color and a rare bonus of ^${d(1.1)} to Solar mass effect.`,()=>"New alloy that allows Red giants to be added into effective amount of Neutron stars.",()=>`Catalyst for production of Elements. 'Gamma-ray burst' effect will be increased by Solar mass ^${d(.1)}.
(Effect increase: ${d(t.collapse.mass**.1,{padding:!0})})`,()=>{let e=y.element24();return`No corrosion, only boost to all Stars that is based on unspent Elements ^${d(e)}.
(Boost to Stars: ${d(new p(t.buildings[4][0].current).power(e),{padding:!0})})`},()=>"Brittle Element, but not the bonus \u2012 1 more level in 'Star system'.",()=>`Any further fusion will be an endothermic process. ${t.inflation.vacuum?`Unlock a new Star type${t.strangeness[5][3]>=1?" and Intergalactic Stage":""}`:"Enter Intergalactic space"}.
(${t.stage.true>=6||t.strange[0].total>=1?`Current base for Stage reset reward is ${d(y.element26(),{padding:!0})}, improve it further by producing more Elements this Stage`:"Can change active Stage from footer, new effect will be added after another Stage reset"})`,()=>`Combined and ready to make all self-made Red supergiants count as Red giants and improve '[24] Chromium' Element by +^${d(.01)}.`,()=>"Slow to react, but will increase max level of 'Star system' by +1.",()=>`Does not need to be prepared to increase Stage reset reward base by Arithmetic progression with step of ${d(.01)}.`,()=>"First of new Elements to come, increases max allowed Merge resets by current self-made Universes amount.",()=>"None."],startCost:[0,1e3,4e3,2e4,1e5,1e8,1e10,4e11,8e12,6e13,1e15,1e20,1e22,1e24,14e25,1e28,1e30,1e32,2e36,1e38,1e39,1e41,2e42,3e43,4e44,5e45,1e48,1e54,1e58,1e140,1e200,1/0]},strangenessInfo:[{},{name:["Fundamental boost","Better improvement","Cheaper Discharge","Free Discharge","Automatic Discharge","Auto Structures","Strange boost","Energy increase","Conservation of Mass","Conservation of Energy"],effectText:[()=>`Boost all Microworld Structures by ${d(t.inflation.vacuum?2:1.8)}.`,()=>`Base for 'Improved Tritium' Research will be bigger by +${d(t.inflation.vacuum?1.5:1)}.`,()=>`Discharge goals requirement will scale slower. (-${d(.5)})${r.stageInfo.activeAll.includes(1)?`
(Creating this Strangeness will make next Discharge goal to be ${d((at()-.5)**t.discharge.current)} Energy)`:""}`,()=>`Obtain +${d(.5)} bonus Discharge goals.`,()=>`Automatically Discharge upon reaching next goal or spending Energy. (Need to be enabled in Settings)${r.strangenessInfo[1].max[4]>1?`
Second level will allow to gain Discharge goals based on current Energy instead of needing to reset.`:""}`,()=>"Make auto for all Microworld Structures permanent.",()=>`Unspent Strange quarks will boost Microworld by improving its Structures.
(Current effect: ${d(r.strangeInfo.stageBoost[1],{padding:!0})})`,()=>"Increase Energy gain from creating Preons by +2.",()=>`No Mass will be lost when creating Preons, only works when Accretion Stage is unlocked.
Second level will disable auto Accretion Structures if Cosmic dust is hardcapped until have enough Mass for highest Solar mass conversion.`,()=>"No Energy will be lost when creating Upgrades or Researches, only works when Interstellar Stage is unlocked."],cost:[],startCost:[1,1,1,2,12,2,24,2,12,15600],scaling:[2.46,2,6,6,400,1,1,6,18,1],max:[6,4,4,2,1,1,1,2,2,1],maxActive:7},{name:["More Moles","Bigger Puddles","More spread","Cloud density","Automatic Vaporization","Auto Structures","Strange boost","Improved flow","Mechanical spread","Ocean world"],effectText:[()=>`Moles will ${t.inflation.vacuum?"improve":"produce"} 2 times more.`,()=>`Puddles will produce ${d(t.inflation.vacuum?1.8:1.6)} times more.`,()=>{let e="none";return t.strangeness[2][2]>=1&&(e="max level increased for 'More streams' (+1)"),t.strangeness[2][2]>=2&&(e+=" and 'Distributary channel' (+1)"),t.strangeness[2][2]>=3&&(e+=", a new Upgrade \u2012 'Tsunami'"),`Increase max level for one of Researches. Final level will instead unlock a new Upgrade.
(Current effect: ${e})`},()=>`Decrease amount of Drops required to get a Cloud by ${d(t.inflation.vacuum?2.5:2)}.`,()=>`Automatically Vaporize when reached enough boost from new Clouds. (Need to be enabled in Settings)${r.strangenessInfo[2].max[4]>1?`
Second level will allow to automatically gain ${d(2.5)}% of Clouds per second. (Not affected by global speed)`:""}`,()=>"Make auto for all Submerged Structures permanent.",()=>`Unspent Strange quarks will boost Submerged by improving Puddles.
(Current effect: ${d(r.strangeInfo.stageBoost[2],{padding:!0})})`,()=>`Submerged Structures that improve other Submerged Structures will do it ${d(1.24)} times stonger.`,()=>{let e="none";return t.strangeness[2][8]>=1&&(e="max level increased for 'Stronger surface tension' (+3)"),t.strangeness[2][8]>=2&&(e+=" and 'Stronger surface stress' (+1)"),t.strangeness[2][8]>=3&&(e+=", a new Upgrade \u2012 'Tide'"),`Increase max level for one of Researches. Final level will instead unlock an even better new Upgrade.
(Current effect: ${e})`},()=>`Increase Stage reset reward based on current Cloud amount.
(Current effect: ${d(y.S2Strange9(),{padding:!0})})`],cost:[],startCost:[1,1,2,2,12,4,24,36,1200,9600],scaling:[2.46,2,3,3.4,800,1,1,3.4,3,1],max:[4,8,3,2,1,1,1,6,3,1],maxActive:7},{name:["Faster Accretion","Intense weathering","More levels","Improved Satellites","Automatic Rank","Auto Structures","Upgrade automatization","Strange boost","Mass delay","Rank raise"],effectText:[()=>`Increase strength of Cosmic dust by ${d(1.8)}.`,()=>`Accretion Structures that produce other Structures will do it ${d(t.inflation.vacuum?1.48:1.6)} times faster.`,()=>{let e="none";return t.strangeness[3][2]>=1&&(e="max level increased for 'Rank boost' (+6)"),t.strangeness[3][2]>=2&&(e+=" and 'Efficient growth' (+2)"),t.strangeness[3][2]>=3&&(e+=", a new Upgrade \u2012 'Hydrostatic equilibrium'"),`Increase max level for one of the Rank Researches. Final level will instead unlock a new Upgrade.
(Current effect: ${e})`},()=>`Satellites will be able to improve Cosmic dust and Planetesimals, but at reduced strength (^${d(t.inflation.vacuum?.1:.2)}).`,()=>`Automatically increase Rank when possible. (Need to be enabled in Settings)${r.strangenessInfo[3].max[4]>1?`
Second level will make Rank increase to use Mass produced this reset instead of current.`:""}`,()=>"Make auto for all Accretion Structures permanent.",()=>`Always automatically create all ${["Upgrades","Stage Researches","Special Researches"][Math.min(t.strangeness[3][6],2)]} from any Stage${!t.inflation.vacuum&&t.strangeness[5][3]<1&&!r.milestonesInfoS6.active[2]?" before Intergalactic":""}. (Need to be enabled in Settings)`,()=>`Unspent Strange quarks will boost Accretion by making its Structures cheaper.
(Current effect: ${d(r.strangeInfo.stageBoost[3],{padding:!0})})`,()=>`Delay Cosmic dust hardcap by ${d(1.4)} per level.`,()=>"Unlock a new Accretion Rank to achieve."],cost:[],startCost:[1,2,2,24,12,4,4,24,9600,18e5],scaling:[2,3.4,3,1,100,1,1.74,1,2.46,1],max:[8,4,3,1,1,1,3,1,6,1],maxActive:8},{name:["Hotter Stars","Cheaper Stars","New Upgrade","Main giants","Automatic Collapse","Auto Structures","Element automatization","Strange boost","Neutronium","Newer Upgrade"],effectText:[()=>`All Stars will produce ${d(1.6)} times more Elements.`,()=>"Stars will be 2 times cheaper.",()=>{let e="none";return t.strangeness[4][2]>=1&&(e="'Planetary nebula' (Stage Research)"),t.strangeness[4][2]>=2&&(e+=", 'White dwarfs' (Collapse Research)"),t.strangeness[4][2]>=3&&(e+=", 'Helium fusion' (Upgrade)"),`Unlock a new Upgrade, its quite good.
(Current unlocks: ${e})`},()=>"10% of Brown dwarfs will be able to turn into Red giants after Collapse.",()=>`Automatically Collapse once reached enough boost. (Need to be enabled in Settings)${r.strangenessInfo[4].max[4]>1?`
Second level will allow to automatically gain Star remnants without needing to reset.`:""}`,()=>"Make auto for all Interstellar Structures permanent.",()=>`Elements will no longer require Collapse for activation${t.inflation.vacuum?" and related automatization Research will cost as if its level is 1 less":""}.
Second level will unlock auto creation of Elements. (${r.strangenessInfo[4].max[6]>1?"Need to be enabled in settings":"Not yet unlocked for Interstellar space"})`,()=>`Unspent Strange quarks will boost Interstellar by improving all Stars, stronger if '[26] Iron' is created.
(Current effect: ${d(r.strangeInfo.stageBoost[4],{padding:!0})})`,()=>`Increase effective amount of Neutron stars (doesn't include ones from '[22] Titanium') by 1 + level and improve Neutron stars strength by +^${d(.125)}.`,()=>{let e="none";return t.strangeness[4][9]>=1&&(e="'Nucleosynthesis' (Upgrade)"),t.strangeness[4][9]>=2&&(e+=", 'Quark-nova' (Collapse Research)"),t.strangeness[4][9]>=3&&(e+=", 'Inner Black hole' (Stage Research)"),`Unlock yet another an even better new Upgrade.
(Current unlocks: ${e})`}],cost:[],startCost:[1,2,4,2,12,6,6,24,6400,2e5],scaling:[2,3.4,3,6,1900,1,1.74,1,2,3],max:[8,4,3,2,1,1,1,1,8,3],maxActive:8},{name:["Bigger Structures","Higher density","Strange gain","Gravitational bound","Automatic Galaxy","Auto Structures","Automatic Stage","Strange boost","Strange growth"],effectText:[()=>`More matter for Accretion (flavor text), first two Intergalactic Structures will be ${d(t.inflation.vacuum?1.4:1.6)} times stronger.`,()=>`With higher density first two Intergalactic upgrades will be even stronger. Effects will be increased by ${d(t.inflation.vacuum?1.6:1.8)}.`,()=>`Gain ${d(1.4)} times more Strange quarks from any Stage reset.`,()=>t.inflation.vacuum?"Unlock Intergalactic Stage and increase Strange quarks from Stage resets by +1.":`Will make Intergalactic Stage immune to Collapse reset${r.milestonesInfoS6.active[2]?"":" and allow 'Upgrade automatization' to work within Intergalactic Stage"}.`,()=>"Automatically Collapse if will be able to afford new Galaxy and auto Galaxy is enabled. (Also unlocks permanent auto Galaxies for free)",()=>`Make auto for ${t.strangeness[5][4]>=1?"all":"the first two"} Intergalactic Structures permanent${t.strangeness[5][4]<1?" and prevent rest from resetting":""}.`,()=>`Automatically trigger Stage reset, doesn't work ${t.inflation.vacuum?"inside the Void":"for Interstellar Stage until second level"}. (Need to be enabled in Settings)`,()=>`Unspent Strange quarks will boost Intergalactic by increasing Solar mass gain.
(Current effect: ${d(r.strangeInfo.stageBoost[5],{padding:!0})})`,()=>`Unlock another Strange Structure.
(Click on that Structure to see its effects)`],cost:[],startCost:[24,36,6,24,15600,24,96,120,6e3],scaling:[2,2,3.4,1,1,1,1,1,1],max:[8,8,2,1,1,1,1,1,1],maxActive:8}],inflationTreeInfo:{name:["Overboost","Global boost","Strange gain","Stranger gain","Unlimited time"],effectText:[()=>"Boost global speed by 2, but reduce time limit on everything that has it by 4.",()=>`Unspent Dark matter boost global speed by ${d(y.inflation1(),{padding:!0})} \u27F6 ${d(y.inflation1(t.inflation.tree[1]+1),{padding:!0})}.`,()=>`Gain ${d(1.4)} times more Strange quarks from any Stage reset.`,()=>`Allows to gain Strangelets until 'Strange growth' Strangeness is created, afterwards it will make 'Strange gain' Strangeness affect Strangelets gain.
Level 2 will make 'Strange gain' Inflation affect Strangelets gain, doesn't require 'Strange growth' Strangeness.`,()=>`Remove time limit from Void rewards (Milestones if in false Vacuum) that have already been obtained in previous Vacuum resets.
For everything else removes 'Overboost' Inflation time limit decrease.`],cost:[],startCost:[0,1,1,2,2],scaling:[0,.75,.5,0,0],max:[1,4,6,2,1]},lastUpgrade:[[null,"upgrades"],[null,"upgrades"],[null,"upgrades"],[null,"upgrades"],[null,"upgrades"],[null,"upgrades"],[null,"upgrades"]],lastElement:null,lastStrangeness:[null,0],lastInflation:null,lastMilestone:[null,0],lastChallenge:[null,null],milestonesInfo:[{},{name:["Fundamental Matter","Energized"],needText:[()=>`Produce at least ${d(r.milestonesInfo[1].need[0])} Quarks this reset.`,()=>`Have current Energy reach ${d(r.milestonesInfo[1].need[1])}.`],rewardText:[()=>"Increase Strange quarks from any Stage reset by +1.",()=>"Permanent Microworld Stage."],need:[new p("Infinity"),new p("Infinity")],time:[14400,14400],scaling:[[1e152,1e158,1e164,1e170,1e178,1e190],[23800,24600,25800,27e3,28200,29600]],max:[6,6]},{name:["A Nebula of Drops","Just a bigger Puddle"],needText:[()=>`Produce at least ${d(r.milestonesInfo[2].need[0])} Drops this reset.`,()=>`Have at least ${d(r.milestonesInfo[2].need[1])} Puddles at same time.`],rewardText:[()=>"A new Intergalactic Structure. (Nebula)",()=>"Permanent Submerged Stage."],need:[new p("Infinity"),new p("Infinity")],time:[28800,28800],scaling:[[1e30,1e32,1e34,1e36,1e38,1e40,1e44],[1500,2300,3100,3900,4700,5500,6400]],max:[7,7]},{name:["Cluster of Mass","Satellites of Satellites"],needText:[()=>`Produce at least ${d(r.milestonesInfo[3].need[0])} Mass this reset.`,()=>`Have more or equal to ${d(r.milestonesInfo[3].need[1])} Satellites.`],rewardText:[()=>"A new Intergalactic Structure. (Star cluster)",()=>"Permanent Accretion Stage."],need:[new p("Infinity"),new p("Infinity")],time:[43200,43200],scaling:[[1e32,1e34,1e36,1e38,1e40,1e42,1e45],[24,28,32,36,40,44,50]],max:[7,7]},{name:["Remnants of past","Supermassive"],needText:[()=>`Produce at least ${d(r.milestonesInfo[4].need[0])} Elements this reset.`,()=>`Have Solar mass after Collapse reach ${d(r.milestonesInfo[4].need[1])} or more.`],rewardText:[()=>"New Intergalactic themed Strangeness, Milestone and second level of 'Element automatization'.",()=>"A new Intergalactic Structure and the final Milestone. (Galaxy)"],need:[new p("Infinity"),new p("Infinity")],time:[57600,57600],scaling:[[1e48,1e49,1e50,1e52,1e54,1e56,1e58,1e60],[9e3,12e3,16e3,22e3,3e4,42e3,6e4,84e3]],max:[8,8]},{name:["Light in the dark","End of Greatness"],needText:[()=>`Have self-made Stars count reach at least ${d(r.milestonesInfo[5].need[0])}.`,()=>`Have ${d(r.milestonesInfo[5].need[1])} self-made Galaxies or more.`],rewardText:[()=>"Unlock a new Intergalactic Strangeness 'Strange gain' and second level of 'Automatic Stage'.",()=>"Unlock a new Intergalactic Upgrade 'Galactic Merger'."],need:[new p("Infinity"),new p("Infinity")],time:[3600,1200],scaling:[[1460,1540,1620,1700,1780,1860,1940,2020],[1,2,4,6,10,14,18,22]],max:[8,8]}],milestonesInfoS6:{requirement:[1,2,3],active:[]},challengesInfo:{name:["Void"],description:[()=>`Result of Vacuum Instability, investigate at your own will
(${t.inflation.vacuum?"Entering (but not exiting) will force a Stage reset":"Requires true Vacuum state to enter"})`],effectText:[()=>{let e=t.challenges.voidCheck,n=`<span class="orangeText">\u2012 Microworld Structures are 4 times weaker${e[1]>=1?`
\u2012 Discharge base is raised to the root of 2 (^${d(.5)})`:""}${e[1]>=2?`
\u2012 Energy gain from creating non Microworld Structures is decreased by 50%`:""}</span>`;e[1]>=3&&(n+=`

<span class="blueText">\u2012 Effective Drops amount is hardcapped at 1
\u2012 Puddles are ${d(8e3)} times weaker${e[2]>=1?`
\u2012 Clouds gain is decreased by ^${d(.8)}</span>`:""}`),e[1]>=2&&(n+=`

<span class="grayText">\u2012 Cosmic dust is softcapped (^${d(.9)})${e[3]>=4?`
\u2012 Softcap is stronger after reaching 'Jovian planet' Rank (^${d(.8)})`:""}</span>`),e[3]>=5&&(n+=`

<span class="orchidText">\u2012 Intestellar Structures are ${d(8e3)} times weaker
\u2012 Solar mass gain from Stars is decreased by 2
\u2012 Solar mass effect is softcapped ^${d(.2)} after 1</span>`),e[5]>=1&&(n+=`

<span class="cyanText">\u2012 Can't create or gain Quasi-stars</span>`);let s=e[1]<2?"orange":e[3]<5?"gray":e[5]<1?"orchid":null;return s!==null&&(n+=`
<span class="${s}Text">More will be shown after getting further into the Void</span>`),n}],needText:[[[],[()=>"Perform Discharge",()=>"Get first level of 'Accretion'",()=>"Get second level of 'Accretion'"],[()=>"Have more than 0 Clouds",()=>`Have more than ${d(1e4)} Clouds`],[()=>"Reach 'Meteoroid' Rank",()=>"Reach 'Asteroid' Rank",()=>"Reach 'Planet' Rank",()=>"Reach 'Jovian planet' Rank",()=>"Reach 'Protostar' Rank"],[()=>"Cause the Collapse",()=>"Get first Red giant",()=>"Get first Neutron star",()=>"Get first Black hole"],[()=>"Unlock Intergalactic",()=>"Create a Galaxy"]]],rewardText:[[[],["'Energy increase' (Microworld)","'Conservation of Mass' (Microworld)","'Improved flow' (Submerged)"],["'Mechanical spread' (Submerged)","'Ocean world' (Submerged)"],["Multiple max level increases","Multiple max level increases","Multiple max level increases","Multiple max level increases","'Strange growth' (Intergalactic)"],["Max level increased for Auto resets","'Conservation of Energy' (Microworld)","'Neutronium' (Interstellar)","'Mass delay' (Accretion)"],["'Newer Upgrade' (Interstellar)","'Rank raise' (Accretion)"]]],color:["darkviolet"]},historyStorage:{stage:[],vacuum:[]}},We=(e,n)=>Math.log(e)/Math.log(n),B=e=>e.slice(0),V=e=>{if(typeof e!="object"||e===null)return e;let n;if(Array.isArray(e)){if(e instanceof p)return new p(e);n=[];for(let s=0;s<e.length;s++)n.push(V(e[s]))}else{n={};for(let s in e)n[s]=V(e[s])}return n},A=(e,n)=>{let s=[];for(let o=0;o<e;o++)s.push(n);return s};for(let e=0;e<r.buildingsInfo.startCost.length;e++){r.buildingsInfo.producing[e]=[];for(let n=0;n<r.buildingsInfo.startCost[e].length;n++)r.buildingsInfo.producing[e].push(new p("0"))}for(let e of["researches","researchesExtra","strangeness"]){let n=r[`${e}Info`];for(let s=1;s<n.length;s++)n[s].cost=B(n[s].startCost)}r.inflationTreeInfo.cost=B(r.inflationTreeInfo.startCost);Object.assign(t,{upgrades:[[],A(r.upgradesInfo[1].startCost.length,0),A(r.upgradesInfo[2].startCost.length,0),A(r.upgradesInfo[3].startCost.length,0),A(r.upgradesInfo[4].startCost.length,0),A(r.upgradesInfo[5].startCost.length,0),A(r.upgradesInfo[6].startCost.length,0)],researches:[[],A(r.researchesInfo[1].startCost.length,0),A(r.researchesInfo[2].startCost.length,0),A(r.researchesInfo[3].startCost.length,0),A(r.researchesInfo[4].startCost.length,0),A(r.researchesInfo[5].startCost.length,0),A(r.researchesInfo[6].startCost.length,0)],researchesExtra:[[],A(r.researchesExtraInfo[1].startCost.length,0),A(r.researchesExtraInfo[2].startCost.length,0),A(r.researchesExtraInfo[3].startCost.length,0),A(r.researchesExtraInfo[4].startCost.length,0),A(r.researchesExtraInfo[5].startCost.length,0),A(r.researchesExtraInfo[6].startCost.length,0)],researchesAuto:A(r.researchesAutoInfo.costRange.length,0),ASR:A(r.ASRInfo.costRange.length,0),maxASR:A(r.ASRInfo.costRange.length,0),elements:A(r.elementsInfo.startCost.length,0),strangeness:[[],A(r.strangenessInfo[1].startCost.length,0),A(r.strangenessInfo[2].startCost.length,0),A(r.strangenessInfo[3].startCost.length,0),A(r.strangenessInfo[4].startCost.length,0),A(r.strangenessInfo[5].startCost.length,0)],milestones:[[],A(r.milestonesInfo[1].need.length,0),A(r.milestonesInfo[2].need.length,0),A(r.milestonesInfo[3].need.length,0),A(r.milestonesInfo[4].need.length,0),A(r.milestonesInfo[5].need.length,0)]});Object.assign(t.toggles,{normal:A(document.getElementsByClassName("toggleNormal").length,!1),confirm:A(document.getElementsByClassName("toggleConfirm").length,"Safe"),buildings:[[],A(t.buildings[1].length,!1),A(t.buildings[2].length,!1),A(t.buildings[3].length,!1),A(t.buildings[4].length,!1),A(t.buildings[5].length,!1),A(t.buildings[6].length,!1)],hover:A(document.getElementsByClassName("toggleHover").length,!1),max:A(document.getElementsByClassName("toggleMax").length,!1),auto:A(document.getElementsByClassName("toggleAuto").length,!1)});t.inflation.tree=A(r.inflationTreeInfo.startCost.length,0);t.toggles.normal[1]=!0;var w=V(t),vt=e=>{if(e.player!==void 0&&(e=e.player),e.vaporization===void 0)throw new ReferenceError("This save file is not from this game or too old");e.version===void 0&&(e.version="0.0.0"),ve(!!e.inflation?.vacuum);let n=e.version;if(n!==w.version){if(e.version==="0.0.0"&&(e.version="v0.0.1",e.researchesExtra=[]),e.version==="v0.0.1"&&(e.version="v0.0.2",e.stage.resets=e.stage.current-1),e.version==="v0.0.2"&&(e.version="v0.0.3",e.accretion=V(w.accretion)),(e.version==="v0.0.3"||e.version==="v0.0.4")&&(e.version="v0.0.5",e.elements=B(w.elements),e.collapse=V(w.collapse),delete e.energy,delete e.buyToggle),(e.version==="v0.0.5"||e.version==="v0.0.6")&&(e.version="v0.0.7",e.strange=V(w.strange),e.strangeness=V(w.strangeness)),e.version==="v0.0.7"||e.version==="v0.0.8"){e.version="v0.0.9",e.stage.active=Math.min(e.stage.current,4);let u=e.stage.active,m=e.buildings;e.buildings=V(w.buildings),e.buildings[u]=m;let h=e.upgrades;e.upgrades=V(w.upgrades),e.upgrades[u]=h;let b=e.researches;e.researches=V(w.researches),e.researches[u]=b;let S=e.researchesExtra;e.researchesExtra=V(w.researchesExtra),e.researchesExtra[u]=S,e.strangeness.length<5&&e.strangeness.unshift([]),e.ASR=B(w.ASR),e.milestones=V(w.milestones)}if((e.version==="v0.0.9"||e.version==="v0.1.0")&&(e.version="v0.1.1",e.discharge.energy=0,e.collapse.massMax=e.collapse.mass,delete e.discharge.energyCur),e.version==="v0.1.1"){e.version="v0.1.2";for(let u=1;u<=5;u++)for(let m=0;m<e.buildings[u].length;m++){let h=e.buildings[u][m];h.current=new p(h.current),h.total=new p(h.total),h.trueTotal=new p(h.total)}e.strange[0].true!==void 0&&(e.strange[0].current=e.strange[0].true),e.strange[0].total=e.strange[0].current,e.inflation=V(w.inflation),delete e.vaporization.current,delete e.strange[0].true}if(e.version==="v0.1.2"&&(e.version="v0.1.3",e.stage.time=0,e.inflation.age=0,e.discharge.energyMax=e.discharge.energy,e.vaporization.cloudsMax=new p(e.vaporization.clouds)),(e.version==="v0.1.3"||e.version==="v0.1.4"||e.version==="v0.1.5")&&(e.version="v0.1.6",e.collapse.show=0,e.challenges=V(w.challenges),delete e.time.disabled,delete e.discharge.unlock,delete e.collapse.disabled,delete e.collapse.inputM,delete e.collapse.inputS),(e.version==="v0.1.6"||e.version==="v0.1.7")&&(e.version="v0.1.8",e.time.online=e.inflation.age,e.time.universe=e.inflation.age,e.time.stage=e.stage.time,e.buildings[5].length>4&&(e.buildings[5].length=4),delete e.saveUpdate016,delete e.accretion.input,delete e.collapse.elementsMax),e.version==="v0.1.8"&&(e.version="v0.1.9",e.toggles=V(w.toggles),e.researchesAuto=B(w.researchesAuto),delete e.discharge.bonus),e.version==="v0.1.9"&&(e.version="v0.2.0",e.stage.peak=0,e.vaporization.input=B(w.vaporization.input),e.time.export=B(w.time.export),e.history=V(w.history),e.events=B(w.events),e.fileName=w.fileName,delete e.event,delete e.separator,delete e.intervals,delete e.stage.best,delete e.stage.export,e.strangeness[1].splice(1,0,e.strangeness[1].splice(5,1)[0]),e.strangeness[1].splice(7,1),e.strangeness[1].splice(4,1),e.strangeness[2].splice(8,1),e.strangeness[2].splice(6,1),e.strangeness[3].splice(10,1),e.strangeness[3].splice(8,1),e.strangeness[4].splice(6,0,e.strangeness[4].splice(4,1)[0]),e.strangeness[4].splice(9,1),e.strangeness[4].splice(7,1),e.strangeness[5].splice(8,1),e.strangeness[5].splice(6,1),e.inflation.vacuum&&(e.milestones=V(w.milestones)),delete e.toggles.shop.howMany),e.version==="v0.2.0"){e.version="v0.2.1",e.time.offline=0,e.stage.input=B(w.stage.input),e.merge=V(w.merge),e.cosmon=V(w.cosmon),e.inflation.resets=e.inflation.vacuum?1:0,e.inflation.tree=B(w.inflation.tree),e.buildings[6]=V(w.buildings[6]),e.upgrades[6]=B(w.upgrades[6]),e.researches[6]=B(w.researches[6]),e.researchesExtra[6]=B(w.researchesExtra[6]),e.collapse.input=B(w.collapse.input),e.challenges.active===-1&&(e.challenges.active=null),e.challenges.voidCheck=B(e.challenges.void),e.history.vacuum=V(w.history.vacuum);for(let u=1;u<=5;u++)for(let m=0;m<e.buildings[u].length;m++)delete e.buildings[u][m].highest;e.discharge.energy=Math.round(e.discharge.energy),e.toggles.normal=B(w.toggles.normal),e.toggles.buildings[6]=B(w.toggles.buildings[6]),e.strangeness[5].splice(6,0,e.strangeness[5].splice(2,1)[0]),e.strangeness[5].splice(3,0,e.strangeness[5].splice(1,1)[0]),e.strangeness[5].splice(0,1),e.strangeness[5].splice(4,0,0)}if(e.version!==w.version)throw new ReferenceError("Save file version is higher than game version")}for(let u=1;u<=6;u++){for(let m=Math.min(e.buildings[u].length,r.buildingsInfo.maxActive[u]);m<w.buildings[u].length;m++)e.buildings[u][m]=V(w.buildings[u][m]);for(let m=e.toggles.buildings[u].length;m<w.toggles.buildings[u].length;m++)e.toggles.buildings[u][m]=!1;isNaN(e.toggles.shop.wait[u])&&(e.toggles.shop.wait[u]=2);for(let m=e.upgrades[u].length;m<w.upgrades[u].length;m++)e.upgrades[u][m]=0;for(let m=e.researches[u].length;m<w.researches[u].length;m++)e.researches[u][m]=0;for(let m=e.researchesExtra[u].length;m<w.researchesExtra[u].length;m++)e.researchesExtra[u][m]=0;if(e.ASR[u]===void 0&&(e.ASR[u]=0),u!==6){for(let m=Math.min(e.strangeness[u].length,r.strangenessInfo[u].maxActive);m<w.strangeness[u].length;m++)e.strangeness[u][m]=0;for(let m=e.milestones[u].length;m<w.milestones[u].length;m++)e.milestones[u][m]=0}}for(let u=e.strange.length;u<w.strange.length;u++)e.strange[u]=V(w.strange[u]);for(let u=e.researchesAuto.length;u<w.researchesAuto.length;u++)e.researchesAuto[u]=0;for(let u=e.elements.length;u<w.elements.length;u++)e.elements[u]=0;for(let u=e.inflation.tree.length;u<w.inflation.tree.length;u++)e.inflation.tree[u]=0;for(let u=e.toggles.normal.length;u<w.toggles.normal.length;u++)e.toggles.normal[u]=w.toggles.normal[u];for(let u=e.toggles.confirm.length;u<w.toggles.confirm.length;u++)e.toggles.confirm[u]="Safe";for(let u=e.toggles.hover.length;u<w.toggles.hover.length;u++)e.toggles.hover[u]=!1;for(let u=e.toggles.max.length;u<w.toggles.max.length;u++)e.toggles.max[u]=!1;for(let u=e.toggles.auto.length;u<w.toggles.auto.length;u++)e.toggles.auto[u]=!1;e.fileName=new TextDecoder().decode(Uint8Array.from(e.fileName,u=>u.codePointAt(0))),e.vaporization.clouds=new p(e.vaporization.clouds),e.vaporization.cloudsMax=new p(e.vaporization.cloudsMax);for(let u=1;u<e.buildings.length;u++)for(let m=0;m<e.buildings[u].length;m++){let h=e.buildings[u][m];h.current=new p(h.current),h.total=new p(h.total),h.trueTotal=new p(h.trueTotal)}Object.assign(t,e),r.debug.errorID=!0,r.debug.errorQuery=!0,r.debug.errorGain=!0,r.debug.historyStage=null,r.debug.historyVacuum=null;let{buildings:s,strangeness:o,researchesAuto:i}=t,{active:c,requirement:f}=r.milestonesInfoS6,g=t.history.stage,l=s[6][1].current;for(let u=0;u<f.length;u++)c[u]=l.moreOrEqual(f[u]);if(r.vaporizationInfo.trueResearch0=0,r.vaporizationInfo.trueResearch1=0,r.vaporizationInfo.trueResearchRain=0,t.challenges.active===0&&(s[4][5].true=0),r.collapseInfo.trueStars=s[4][1].true+s[4][2].true+s[4][3].true+s[4][4].true+s[4][5].true,r.historyStorage.stage=g.list,r.historyStorage.vacuum=t.history.vacuum.list,t.elements[26]>=1&&t.stage.current<5&&(t.elements[26]=0),t.inflation.vacuum)s[2][0].current.setValue(s[1][5].current).divide("6.02214076e23"),s[3][0].current.setValue(s[1][0].current).multiply("1.78266192e-33"),t.events[0]=!0;else{for(let u=2;u<=5;u++)r.dischargeInfo.energyStage[u]=0;s[2][1].current.lessOrEqual("0")&&s[2][0].current.max("2.7753108348135e-3"),t.accretion.rank===0&&s[3][0].current.setValue("5.9722e27")}t.events[1]||(t.events[1]=t.stage.true>=7),c[0]&&(o[1][8]=2),c[1]&&(o[5][4]=1),c[2]&&(o[3][6]=3,o[4][6]=2),i[0]=Math.max(o[3][6],i[0]),i[1]=Math.max(o[4][6],i[1]),r.strangeInfo.bestHistoryRate=g.best[1]/g.best[0];for(let u=1;u<6;u++){let m=t.strangeness[u],h=r.strangenessInfo[u].max;c[1]&&(m[5]=1);for(let k=0;k<r.strangenessInfo[u].maxActive;k++)R(k,u,"strangeness"),m[k]>h[k]&&(m[k]=h[k],D(k,u,"strangeness"));for(let k=0;k<w.milestones[u].length;k++)Ge(k,u);let b=t.researchesExtra[u],S=r.researchesExtraInfo[u].max;for(let k=0;k<r.researchesExtraInfo[u].maxActive;k++)R(k,u,"researchesExtra"),b[k]>S[k]&&(b[k]=S[k]);let T=t.researches[u],E=r.researchesInfo[u].max;for(let k=0;k<r.researchesInfo[u].maxActive;k++)R(k,u,"researches"),T[k]>E[k]&&(T[k]=E[k]);R(0,u,"ASR"),m[5]>=1&&(t.ASR[u]=u===5&&m[4]<1?Math.max(2,t.ASR[5]):r.ASRInfo.max[u])}{let u=r.researchesAutoInfo.max;for(let m=0;m<w.researchesAuto.length;m++)R(m,0,"researchesAuto"),m===2&&i[m]>u[m]&&(i[m]=u[m],D(m,0,"researchesAuto"))}r.lastChallenge=[t.challenges.active,null],r.lastInflation=null,a("inflationText").textContent="Hover to see.",a("inflationEffect").textContent="Hover to see.",a("inflationCost").textContent="Cosmon.";for(let u=0;u<w.inflation.tree.length;u++)pe(u,0,"inflation");Q(),X[1](),X[0](),ke(),$e(),rt(),a("saveFileNameInput").value=t.fileName,a("stageInput").value=d(t.stage.input[0],{type:"input"}),a("stage2Input").value=d(t.stage.input[1],{type:"input"}),a("vaporizationInput").value=d(t.vaporization.input[0],{type:"input"}),a("vaporizationInputMax").value=d(t.vaporization.input[1],{type:"input"}),a("collapseStarsInput").value=d(t.collapse.input[0],{type:"input"}),a("collapseStarsInputWait").value=d(t.collapse.input[1],{type:"input"}),a("stageHistorySave").value=`${g.input[0]}`,a("stageHistoryShow").value=`${g.input[1]}`,a("vacuumHistorySave").value=`${t.history.vacuum.input[0]}`,a("vacuumHistoryShow").value=`${t.history.vacuum.input[1]}`;for(let u=0;u<w.toggles.normal.length;u++)K(u,"normal");for(let u=0;u<w.toggles.confirm.length;u++)st(u);for(let u=0;u<w.toggles.hover.length;u++)K(u,"hover");for(let u=0;u<w.toggles.max.length;u++)K(u,"max");for(let u=0;u<w.toggles.auto.length;u++)K(u,"auto");return a("buyAnyInput").value=d(t.toggles.shop.input,{type:"input"}),n};var a=(e,n=!1)=>{let s=M.cache.idMap.get(e);if(s!==void 0)return s;let o=document.getElementById(e);if(o!==null)return M.cache.idMap.set(e,o),o;if(n)return null;throw r.debug.errorID&&(r.debug.errorID=!1,P(`Error encountered, ID \u2012 '${e}' doesn't exist`),setTimeout(()=>{r.debug.errorID=!0},6e4)),new ReferenceError(`ID \u2012 '${e}' doesn't exist`)},$t=e=>{let n=M.cache.classMap.get(e);if(n!==void 0)return n;let s=document.getElementsByClassName(e);return M.cache.classMap.set(e,s),s},C=e=>{let n=M.cache.queryMap.get(e);if(n!==void 0)return n;let s=document.querySelector(e);if(s!==null)return M.cache.queryMap.set(e,s),s;throw r.debug.errorQuery&&(r.debug.errorQuery=!1,P(`Error encountered, Query \u2012 '${e}' failed to find anything`),setTimeout(()=>{r.debug.errorQuery=!0},6e4)),new ReferenceError(`Query \u2012 '${e}' failed`)},Et=()=>{let e=t.time,n=Date.now(),s=(n-e.updated)/1e3;return e.updated=n,e.export[0]+=s,s},_e=async(e,n=!v.developerMode)=>{if(r.paused||(r.paused=!0,Y()),t.time.offline<0&&(e+=t.time.offline,t.time.offline=0),e>86400)e=86400;else if(e<=0)return t.time.offline+=e,r.paused=!1,Y();if(!n&&!await j(`Claim ${d(e,{type:"time",padding:!1})} worth of Offline time?
Will be lost if not accepted`,2))return r.lastSave+=Et(),r.paused=!1,Y();let s=a("offlineAccelerate");s.addEventListener("click",Ht),a("offlineCancel").addEventListener("click",Ut),document.body.addEventListener("keydown",cn),a("offlineMain").style.display="",un(e),s.focus()},un=(e,n=e)=>{let s=r.debug.offlineSpeed,o=s===0?e:Math.min(600*s,e);e-=o;try{mt(o,Math.max(o/600,.2))}catch(i){throw ln(),W(`Offline calculation failed due to error:
${i}`,1),i}e>0?(setTimeout(un,0,e,n),a("offlineTick").textContent=d(s),a("offlineRemains").textContent=d(e,{type:"time"}),a("offlinePercentage").textContent=d(100-e/n*100,{padding:!0}),v.SRSettings[0]&&(C("#offlineMain > div").ariaValueText=`${d(100-e/n*100)}% done`)):ln()},ln=()=>{r.debug.offlineSpeed=.2,r.paused=!1,Y(),a("offlineMain").style.display="none",ue(),J(),a("offlineAccelerate").removeEventListener("click",Ht),a("offlineCancel").removeEventListener("click",Ut),document.body.removeEventListener("keydown",cn)},cn=e=>{let n=e.key;if(n==="Escape")e.preventDefault(),Ut();else if(n==="Enter"||n===" "){if(document.activeElement===a("offlineCancel"))return;e.preventDefault(),Ht()}else if(n==="Tab"){e.preventDefault();let s=a("offlineCancel");(document.activeElement===s?a("offlineAccelerate"):s).focus()}},Ut=()=>r.debug.offlineSpeed=0,Ht=()=>r.debug.offlineSpeed*=2,Y=()=>{let e=r.intervalsId,n=v.intervals,s=r.paused;clearInterval(e.main),clearInterval(e.numbers),clearInterval(e.visual),clearInterval(e.autoSave),e.main=s?void 0:setInterval(mt,n.main),e.numbers=s?void 0:setInterval(J,n.numbers),e.visual=s?void 0:setInterval(ue,n.visual),e.autoSave=s?void 0:setInterval(je,n.autoSave)},je=async(e=!1)=>{if(r.paused)return P("No saving while game is paused"),null;try{t.history.stage.list=r.historyStorage.stage.slice(0,t.history.stage.input[0]),t.history.vacuum.list=r.historyStorage.vacuum.slice(0,t.history.vacuum.input[0]);let n={...t};n.fileName=String.fromCharCode(...new TextEncoder().encode(n.fileName));let s=btoa(JSON.stringify(n));return e||(localStorage.setItem("testing_save",s),clearInterval(r.intervalsId.autoSave),r.intervalsId.autoSave=setInterval(je,v.intervals.autoSave),a("isSaved").textContent="Saved",r.lastSave=0),s}catch(n){let s=n.stack;throw W(`Failed to save game
${typeof s=="string"?s.replaceAll(`${window.location.origin}/`,""):n}`,1),n}},fn=e=>{if(r.paused)return P("No loading while game is paused");r.hotkeys.disabled=!0,r.paused=!0,Y();try{let n=vt(JSON.parse(atob(e)));r.lastSave=Et(),P(`This save is ${d(r.lastSave,{type:"time",padding:!1})} old${n!==t.version?`
Save file version is ${n}`:""}`),G("reload"),_e(r.lastSave),r.hotkeys.disabled=!1}catch(n){throw ve(!!t.inflation.vacuum),r.hotkeys.disabled=!1,r.paused=!1,Y(),W(`Incorrect save file format
${n}`),n}},xn=async()=>{(t.stage.true>=7||t.stage.resets>=(t.inflation.vacuum?1:4))&&wn();let e=await je(v.developerMode);if(e===null)return;let n=document.createElement("a");n.href=`data:text/plain,${e}`,n.download=gn(),n.click()},wn=()=>{let e=t.time.export;if(e[0]<0)return;let{strange:n}=t,s=Math.min(e[0]/86400,1),o=(e[1]/2.5+1)*s;if(n[0].current+=o,n[0].total+=o,e[1]=Math.max(e[1]-o,0),t.strangeness[5][8]>=1||t.inflation.tree[3]>=1){let i=e[2]/2.5*s;n[1].current+=i,n[1].total+=i,e[2]-=i,X[1]()}X[0](),e[0]=0},En=async()=>{let e=await yt(`Available options:
'Copy' \u2012 copy save file to clipboard
'Delete' \u2012 delete your save file
'Reset' \u2012 reset global settings
'Clear' \u2012 clear all domain data
Or insert save file string here to load it`);if(e===null||e==="")return;let n=e.toLowerCase();if(n==="copy"){let s=await je(!0);s!==null&&navigator.clipboard.writeText(s)}else if(n==="delete"||n==="reset"||n==="clear")r.hotkeys.disabled=!0,r.paused=!0,Y(),n==="delete"?localStorage.removeItem("testing_save"):n==="reset"?localStorage.removeItem("fundamentalSettings"):localStorage.clear(),window.location.reload(),W("Awaiting game reload");else if(e==="devMode")v.developerMode=!v.developerMode,P(`Developer mode is ${v.developerMode?"now":"no longer"} active`),re();else if(n==="achievement")P("Unlocked a new Achievement! (If there were any)");else if(n==="slow"||n==="free")P("Game speed was increased by 1x");else{if(e.length<20)return void W(`Input '${e}' doesn't match anything`);if(!await j(`Press 'Confirm' to load input as a save file
(Input is too long to be displayed)`))return;fn(e)}},gn=()=>{let e=t.fileName,n=new Date,s=e.indexOf("[date");if(s>=0){let f=e.indexOf("]",s+5);if(f>=0){let g=e.substring(s+5,f),l=["Y","M","D"],u=[`${n.getFullYear()}`,`${n.getMonth()+1}`.padStart(2,"0"),`${n.getDate()}`.padStart(2,"0")];for(let m=0;m<l.length;m++)g=g.replace(l[m],u[m]);e=e.replace(e.substring(s,f+1),g)}}let o=e.indexOf("[time");if(o>=0){let f=e.indexOf("]",o+5);if(f>=0){let g=e.substring(o+5,f),l=["H","M","S"],u=[`${n.getHours()}`.padStart(2,"0"),`${n.getMinutes()}`.padStart(2,"0"),`${n.getSeconds()}`.padStart(2,"0")];for(let m=0;m<l.length;m++)g=g.replace(l[m],u[m]);e=e.replace(e.substring(o,f+1),g)}}let i=["[version]","[stage]","[strange]","[cosmon]","[vacuum]","[galaxy]","[universe]"],c=[t.version,r.stageInfo.word[t.stage.active],`${t.strange[0].total}`,`${t.cosmon.total}`,`${t.inflation.vacuum}`,`${t.buildings[5][3].true}`,`${t.buildings[6][1].true}`];for(let f=0;f<i.length;f++)e=e.replace(i[f],c[f]);return`${e}.txt`},U=(e,n=!1)=>{n&&e(),r.intervalsId.mouseRepeat===void 0&&(r.intervalsId.mouseRepeat=setTimeout(()=>{r.intervalsId.mouseRepeat=setInterval(e,50)},200))},St=()=>{clearInterval(r.intervalsId.mouseRepeat),r.intervalsId.mouseRepeat=void 0},ye=(e,n)=>{n==="inflation"?r.lastInflation=e:(t.toggles.hover[0]&&t.stage.true>=2&&(n!=="researchesAuto"||be(e,t.stage.active,"researchesAuto"))&&te(e,t.stage.active,n),n==="elements"?r.lastElement=e:r.lastUpgrade[t.stage.active]=[e,n]),De(e,n)},xt=(e,n,s)=>{s==="strangeness"?r.lastStrangeness=[e,n]:r.lastMilestone=[e,n],dt(e,n,s)},wt=(e,n)=>{n==="challenge"?(r.lastChallenge[0]=e,Be(e)):(r.lastChallenge[1]=e,gt(e))},he=()=>{let e=t.stage.active;for(let n=1;n<M.longestBuilding;n++)ne(n,e,0)},Rt=async()=>{if(r.paused)return;r.paused=!0,Y();let e=await j("Game is currently paused. Any button bellow will unpause, press 'Confirm' to keep Offline time"),n=Et();r.lastSave+=n,e?_e(n,!0):(r.paused=!1,Y())},oe=V(v);try{tn();let e=document.body,n=localStorage.getItem("fundamentalSettings");if(n!==null){try{Object.assign(v,JSON.parse(atob(n)));let l=new TextDecoder;for(let u in v.hotkeys){let m=v.hotkeys[u];for(let h=0;h<m.length;h++)m[h]=l.decode(Uint8Array.from(m[h],b=>b.codePointAt(0)))}for(let u=v.toggles.length;u<oe.toggles.length;u++)v.toggles[u]=!1;for(let u=v.MDSettings.length;u<oe.MDSettings.length;u++)v.MDSettings[u]=!1;for(let u=v.SRSettings.length;u<oe.SRSettings.length;u++)v.SRSettings[u]=!1;for(let u in oe.hotkeys)v.hotkeys[u]===void 0&&(v.hotkeys[u]=B(oe.hotkeys[u]))}catch(l){P("Global settings failed to parse, default ones will be used instead"),console.log(`(Full parse error) ${l}`)}a("decimalPoint").value=v.format[0].replace("\xA0"," "),a("thousandSeparator").value=v.format[1].replace("\xA0"," "),a("mainInterval").value=`${v.intervals.main}`,a("numbersInterval").value=`${v.intervals.numbers}`,a("visualInterval").value=`${v.intervals.visual/1e3}`,a("autoSaveInterval").value=`${v.intervals.autoSave/1e3}`;for(let l=0;l<oe.toggles.length;l++)me(l,"global");if(v.fontSize!==16&&At(!0),v.toggles[2]&&(e.style.userSelect=""),v.toggles[1]){let l=a("upgradeSubtabElements");l.id="ElementsTab",a("upgradeTab").after(l),M.cache.idMap.delete("upgradeSubtabElements");let u=a("upgradeSubtabBtnElements");u.id="ElementsTabBtn",u.classList.add("stage4Include"),a("upgradeTabBtn").after(u),M.cache.idMap.delete("upgradeSubtabBtnElements");let m=r.tabList;m.ElementsSubtabs=[],m.upgradeSubtabs.splice(m.upgradeSubtabs.indexOf("Elements"),1),m.tabs.splice(m.tabs.indexOf("upgrade")+1,0,"Elements")}if(v.MDSettings[0]){document.getElementById("MDMessage1").remove(),M.styleSheet.textContent+='input[type = "image"], img { -webkit-touch-callout: none; }',M.styleSheet.textContent+="#themeArea.windowOpen > div > div { display: flex; } #themeArea.windowOpen > div > button { clip-path: circle(0); }",a("file").accept="";let l=document.createElement("button");l.append(document.createElement("div")),l.type="button";let u=document.createElement("button");u.append(document.createElement("div")),u.type="button",a("resetStage").append(l),l.addEventListener("click",()=>a("resetStage").classList.toggle("open")),l.addEventListener("blur",()=>a("resetStage").classList.remove("open")),a("reset1Main").append(u),u.addEventListener("click",()=>a("reset1Main").classList.toggle("open")),u.addEventListener("blur",()=>a("reset1Main").classList.remove("open")),M.styleSheet.textContent+="#resets { row-gap: 1em; } #resets > section { position: relative; flex-direction: row; justify-content: center; width: unset; padding: unset; row-gap: unset; background-color: unset; border: unset; } #resets > section:not(.open) > p { display: none !important; }",M.styleSheet.textContent+="#resets > section > button:last-of-type { width: 2.2em !important; margin-left: -2px; } #resets button > div { clip-path: polygon(0 0, 50% 100%, 100% 0, 50% 25%); width: 1.24em; height: 1.24em; background-color: var(--main-text); pointer-events: none; margin: auto; } #resets p { position: absolute; width: 17.4em; padding: 0.5em 0.6em 0.6em; background-color: var(--window-color); border: 2px solid var(--window-border); top: calc(100% - 2px); z-index: 1; box-sizing: content-box; }";let m=document.createElement("button");m.textContent="Structures",m.id="structuresFooter",m.type="button";let h=document.createElement("button");h.textContent="Stage",h.id="stageFooter",h.type="button";let b=document.createElement("button");b.id="reset1Footer",b.type="button";let S=document.createElement("button");S.textContent="Collapse",S.id="resetCollapseFooter",S.type="button",S.className="stage5Only";let T=document.createElement("button");T.textContent="Galaxy",T.id="resetGalaxyFooter",T.type="button",T.className="stage4Only",a("phoneHotkeys").prepend(T,b,S,h,m);let E=document.createElement("button");E.classList.add("hollowButton"),E.textContent="Create",E.id="upgradeCreate",E.type="button",a("toggleHover0").after(E);let k=document.createElement("button");k.classList.add("hollowButton"),k.textContent="Activate",k.id="inflationActivate",k.type="button",a("inflationRefund").before(k);let I=document.createElement("div");I.id="strangenessPages",I.innerHTML='<button type="button" id="strangenessPage1" class="stage1borderImage hollowButton">1</button><button type="button" id="strangenessPage2" class="stage2borderImage hollowButton">2</button><button type="button" id="strangenessPage3" class="stage3borderImage hollowButton">3</button><button type="button" id="strangenessPage4" class="stage4borderImage hollowButton">4</button><button type="button" id="strangenessPage5" class="stage5borderImage hollowButton">5</button><button type="button" id="strangenessCreate" class="hollowButton">Create</button>',M.styleSheet.textContent+="#strangenessPages { display: flex; justify-content: center; column-gap: 0.3em; } #strangenessPages button { width: 2.08em; height: calc(2.08em - 2px); border-top: none; border-radius: 0 0 4px 4px; } #strangenessCreate { width: unset !important; padding: 0 0.4em; }",a("strangenessResearch").append(I);let $=document.createElement("li");$.innerHTML='<label>Keep mouse events<button type="button" id="MDToggle1" class="specialToggle">OFF</button></label>',a("MDLi").after($),a("MDToggle1").addEventListener("click",()=>me(1,"mobile",!0,!0));for(let N=0;N<oe.MDSettings.length;N++)me(N,"mobile")}if(v.SRSettings[0]){document.getElementById("SRMessage1").remove();for(let b=0;b<=3;b++){let S=C(`#${b===0?"solarMass":`star${b}`}Effect > span:last-of-type`);S.textContent=` (${S.textContent})`,S.classList.remove("greenText")}for(let b=1;b<=1;b++){let S=C(`#merge${b}Effect > span:last-of-type`);S.textContent=` (${S.textContent})`,S.classList.remove("greenText")}let l=document.createElement("article");l.innerHTML='<h5>Information for Screen reader</h5><p id="SRTab" aria-live="polite"></p><p id="SRStage" aria-live="polite"></p><p id="SRMain" aria-live="assertive"></p>',l.className="reader",a("fakeFooter").before(l);let u=document.createElement("li");u.innerHTML='<label>Keep tab index on created Upgrades<button type="button" id="SRToggle1" class="specialToggle">OFF</button></label>';let m=document.createElement("li");m.innerHTML='<label>Keep tab index on primary buttons<button type="button" id="SRToggle2" class="specialToggle">OFF</button></label>',a("SRLi").after(u,m),a("SRToggle1").addEventListener("click",()=>{me(1,"reader",!0),G("reload");for(let b=1;b<w.strangeness.length;b++)for(let S=0;S<r.strangenessInfo[b].maxActive;S++)D(S,b,"strangeness");Pe()});let h=(b=!1)=>{b||me(2,"reader",!0);let S=v.SRSettings[2]?0:-1;a("stageReset").tabIndex=S,a("reset1Button").tabIndex=S;for(let T=1;T<M.longestBuilding;T++)a(`building${T}Btn`).tabIndex=S,a(`toggleBuilding${T}`).tabIndex=S;a("toggleBuilding0").tabIndex=S;for(let T of r.tabList.tabs){a(`${T}TabBtn`).tabIndex=S;for(let E of r.tabList[`${T}Subtabs`])a(`${T}SubtabBtn${E}`).tabIndex=S}for(let T=1;T<r.stageInfo.word.length;T++)a(`${r.stageInfo.word[T]}Switch`).tabIndex=S};a("SRToggle2").addEventListener("click",()=>{h()}),v.SRSettings[2]&&h(!0);for(let b=0;b<oe.SRSettings.length;b++)me(b,"reader");M.styleSheet.textContent+="#starEffects > p > span, #mergeEffects > p > span { display: unset !important; }"}if(v.developerMode){let l=document.createElement("button");l.classList.add("hollowButton"),l.textContent="Pause",l.type="button",a("mainLi").append(l),l.addEventListener("click",Rt)}}let s=t.version,o=localStorage.getItem("testing_save");o!==null?s=vt(JSON.parse(atob(o))):(ve(!1),vt(V(w))),Oe();let i=v.MDSettings[0],c=v.SRSettings[0],f=!i||v.MDSettings[1];e.addEventListener("keydown",l=>en(l));let g=l=>{r.hotkeys.shift&&!l.shiftKey&&(r.hotkeys.shift=!1),r.hotkeys.ctrl&&!l.ctrlKey&&(r.hotkeys.ctrl=!1)};e.addEventListener("keyup",g,{passive:!0}),e.addEventListener("contextmenu",l=>{let u=document.activeElement?.type;u!=="text"&&u!=="number"&&!v.developerMode&&l.preventDefault()}),f&&(e.addEventListener("mouseup",l=>{St(),g(l)},{passive:!0}),e.addEventListener("mouseleave",St,{passive:!0})),i&&(e.addEventListener("touchstart",l=>{document.body.style.userSelect==="none"&&l.preventDefault()}),e.addEventListener("touchend",St,{passive:!0}),e.addEventListener("touchcancel",St,{passive:!0}));for(let l=0;l<oe.toggles.length;l++)a(`globalToggle${l}`).addEventListener("click",()=>{if(me(l,"global",!0,l===1),l===0){Oe();let u=v.toggles[0]?0:1;for(let m in oe.hotkeys){let h=v.hotkeys[m][u];C(`#${m}Hotkey > button`).textContent=h==null||h===""?"None":h}}else l===2&&(document.body.style.userSelect=v.toggles[2]?"":"none")});for(let l=0;l<w.toggles.normal.length;l++)a(`toggleNormal${l}`).addEventListener("click",()=>K(l,"normal",!0));for(let l=0;l<w.toggles.confirm.length;l++)a(`toggleConfirm${l}`).addEventListener("click",()=>st(l,!0));for(let l=0;l<M.longestBuilding;l++)a(`toggleBuilding${l}`).addEventListener("click",()=>K(l,"buildings",!0));for(let l=0;l<w.toggles.hover.length;l++)a(`toggleHover${l}`).addEventListener("click",()=>K(l,"hover",!0));for(let l=0;l<w.toggles.max.length;l++)a(`toggleMax${l}`).addEventListener("click",()=>K(l,"max",!0));for(let l=0;l<w.toggles.auto.length;l++)a(`toggleAuto${l}`).addEventListener("click",()=>{K(l,"auto",!0),l===5?Me("all"):l===6?le("researches","all"):l===7?le("researchesExtra","all"):l===8&&Ce()});{let l=()=>{t.inflation.vacuum||t.stage.active>=4||Ue()},u=a("stageReset");if(u.addEventListener("click",Ue),f&&u.addEventListener("mousedown",()=>U(l)),i){u.addEventListener("touchstart",()=>U(l));let m=a("stageFooter");m.addEventListener("click",Ue),m.addEventListener("touchstart",()=>U(l)),f&&m.addEventListener("mousedown",()=>U(l))}}{let l=()=>{let h=t.stage.active;h===1?ot():h===2?it():h===3?lt():h===4?Ke():h===5&&ft()},u=()=>{t.stage.active!==1&&t.stage.active!==3||l()},m=a("reset1Button");if(m.addEventListener("click",l),f&&m.addEventListener("mousedown",()=>U(u)),i){m.addEventListener("touchstart",()=>U(u));let h=a("reset1Footer");h.addEventListener("click",l),h.addEventListener("touchstart",()=>U(u)),f&&h.addEventListener("mousedown",()=>U(u)),a("resetCollapseFooter").addEventListener("click",Ke);let b=()=>ne(3,5),S=a("resetGalaxyFooter");S.addEventListener("click",b),S.addEventListener("touchstart",()=>U(b)),f&&S.addEventListener("mousedown",()=>U(b))}}for(let l=1;l<M.longestBuilding;l++){let u=a(`building${l}Btn`),m=()=>ne(l);u.addEventListener("click",m),f&&u.addEventListener("mousedown",()=>U(m)),i&&u.addEventListener("touchstart",()=>U(m))}{let l=a("makeAllStructures");if(l.addEventListener("click",he),f&&l.addEventListener("mousedown",()=>U(he)),i){l.addEventListener("touchstart",()=>U(he));let u=a("structuresFooter");u.addEventListener("click",he),u.addEventListener("touchstart",()=>U(he)),f&&u.addEventListener("mousedown",()=>U(he))}}a("buyAnyInput").addEventListener("change",()=>{let l=a("buyAnyInput");t.toggles.shop.input=Math.max(Math.trunc(Number(l.value)),0),l.value=d(t.toggles.shop.input,{type:"input"}),J()}),a("autoWaitInput").addEventListener("change",()=>{let l=a("autoWaitInput"),u=Math.max(Number(l.value),1);isNaN(u)&&(u=2),t.toggles.shop.wait[t.stage.active]=u,l.value=d(u,{type:"input"})});for(let l=0;l<r.challengesInfo.name.length;l++){let u=a(`challenge${l+1}`);f&&u.addEventListener("mouseover",()=>wt(l,"challenge")),i&&u.addEventListener("touchstart",()=>wt(l,"challenge")),c&&u.addEventListener("focus",()=>wt(l,"challenge")),u.addEventListener("click",()=>{jt(l)})}for(let l=1;l<r.challengesInfo.rewardText[0].length;l++){let u=a(`voidReward${r.stageInfo.word[l]}`);u.addEventListener("click",()=>wt(l,"reward")),i&&u.addEventListener("click",()=>a("voidRewardsDiv").style.display="block")}i&&a("voidRewardsDiv").addEventListener("click",()=>a("voidRewardsDiv").style.display="");for(let l=0;l<M.longestUpgrade;l++){let u=a(`upgrade${l+1}`),m=()=>ye(l,"upgrades");if(f&&u.addEventListener("mouseover",m),i)u.addEventListener("touchstart",()=>U(m,!0));else{let h=()=>te(l,t.stage.active,"upgrades");u.addEventListener("click",h),u.addEventListener("mousedown",()=>U(h))}c&&u.addEventListener("focus",m)}for(let l=0;l<M.longestResearch;l++){let u=a(`research${l+1}Image`),m=()=>ye(l,"researches");if(f&&u.addEventListener("mouseover",m),i)u.addEventListener("touchstart",()=>U(m,!0));else{let h=()=>te(l,t.stage.active,"researches");u.addEventListener("click",h),u.addEventListener("mousedown",()=>U(h))}c&&u.addEventListener("focus",m)}for(let l=0;l<M.longestResearchExtra;l++){let u=a(`researchExtra${l+1}Image`),m=()=>ye(l,"researchesExtra");if(f&&u.addEventListener("mouseover",m),i)u.addEventListener("touchstart",()=>U(m,!0));else{let h=()=>te(l,t.stage.active,"researchesExtra");u.addEventListener("click",h),u.addEventListener("mousedown",()=>U(h))}c&&u.addEventListener("focus",m)}for(let l=0;l<r.researchesAutoInfo.costRange.length;l++){let u=a(`researchAuto${l+1}Image`),m=()=>ye(l,"researchesAuto");if(f&&u.addEventListener("mouseover",m),i)u.addEventListener("touchstart",()=>U(m,!0));else{let h=()=>te(l,t.stage.active,"researchesAuto");u.addEventListener("click",h),u.addEventListener("mousedown",()=>U(h))}c&&u.addEventListener("focus",m)}{let l=a("ASRImage"),u=()=>ye(0,"ASR");if(f&&l.addEventListener("mouseover",u),i)l.addEventListener("touchstart",()=>U(u,!0));else{let m=()=>te(0,t.stage.active,"ASR");l.addEventListener("click",m),l.addEventListener("mousedown",()=>U(m))}c&&l.addEventListener("focus",u)}if(i){let l=a("upgradeCreate"),u=()=>{let m=t.stage.active,h=r.lastUpgrade[m];h[0]!==null&&te(h[0],m,h[1])};l.addEventListener("click",u),l.addEventListener("touchstart",()=>U(u)),f&&l.addEventListener("mousedown",()=>U(u))}{let l=a("element0"),u=()=>{r.lastElement=0,De(0,"elements")};c&&(a("element1").addEventListener("keydown",m=>{if(m.code==="Tab"&&m.shiftKey){let h=a("element0");h.tabIndex=0,h.ariaHidden="false"}}),l.addEventListener("keydown",m=>{m.code==="Enter"&&u()}),l.addEventListener("blur",()=>{let m=a("element0");m.tabIndex=-1,m.ariaHidden="true"})),f&&l.addEventListener("dblclick",u),i&&l.addEventListener("touchstart",()=>{r.intervalsId.mouseRepeat===void 0&&(r.intervalsId.mouseRepeat=setTimeout(u,3e3))})}for(let l=1;l<r.elementsInfo.startCost.length;l++){let u=a(`element${l}`),m=()=>te(l,4,"elements");f&&(u.addEventListener("mouseover",()=>ye(l,"elements")),u.addEventListener("mousedown",()=>U(m))),i&&u.addEventListener("touchstart",()=>{ye(l,"elements"),U(m)}),c&&u.addEventListener("focus",()=>ye(l,"elements")),(f||c)&&u.addEventListener("click",m)}for(let l=0;l<2;l++){let u=a(`strange${l}`),m=["quarks","strangelets"][l],h=()=>{m==="quarks"&&!t.inflation.vacuum&&t.milestones[4][0]<8||(a(`${m}EffectsMain`).style.display="",J())};u.addEventListener("click",h),c&&u.addEventListener("focus",h),u.addEventListener("blur",()=>a(`${m}EffectsMain`).style.display="none"),a(`${m}EffectsMain`).addEventListener("click",b=>{a(`${m}EffectsMain`).style.display="none",b.stopPropagation()})}for(let l=1;l<r.strangenessInfo.length;l++){i&&a(`strangenessPage${l}`).addEventListener("click",()=>pt(l));for(let u=0;u<r.strangenessInfo[l].startCost.length;u++){let m=a(`strange${u+1}Stage${l}Image`),h=()=>xt(u,l,"strangeness");if(f&&m.addEventListener("mouseover",h),i)m.addEventListener("touchstart",()=>{h()});else{let b=()=>Qe(u,l,"strangeness");m.addEventListener("click",b),m.addEventListener("mousedown",()=>U(b))}c&&m.addEventListener("focus",h)}}if(i){let l=a("strangenessCreate"),u=()=>{let m=r.lastStrangeness;m[0]!==null&&Qe(m[0],m[1],"strangeness")};l.addEventListener("click",u),l.addEventListener("touchstart",()=>U(u)),f&&l.addEventListener("mousedown",()=>U(u))}for(let l=1;l<r.milestonesInfo.length;l++)for(let u=0;u<r.milestonesInfo[l].need.length;u++){let m=C(`#milestone${u+1}Stage${l}Div > img`);f&&m.addEventListener("mouseover",()=>xt(u,l,"milestones")),i&&m.addEventListener("touchstart",()=>xt(u,l,"milestones")),c&&(m.tabIndex=0,m.classList.add("noFocusOutline"),m.addEventListener("focus",()=>xt(u,l,"milestones")))}for(let l=0;l<r.inflationTreeInfo.startCost.length;l++){let u=a(`inflation${l+1}`),m=()=>ye(l,"inflation");if(f&&u.addEventListener("mouseover",m),i)u.addEventListener("touchstart",()=>{m()});else{let h=()=>Qe(l,0,"inflation");u.addEventListener("click",h),u.addEventListener("mousedown",()=>U(h))}c&&u.addEventListener("focus",m)}if(a("inflationRefund").addEventListener("click",qt),i){let l=a("inflationActivate"),u=()=>{r.lastInflation!==null&&Qe(r.lastInflation,0,"inflation")};l.addEventListener("click",u),l.addEventListener("touchstart",()=>U(u)),f&&l.addEventListener("mousedown",()=>U(u))}a("vaporizationInput").addEventListener("change",()=>{let l=a("vaporizationInput");t.vaporization.input[0]=Math.max(Number(l.value),0),l.value=d(t.vaporization.input[0],{type:"input"})}),a("vaporizationInputMax").addEventListener("change",()=>{let l=a("vaporizationInputMax");t.vaporization.input[1]=Math.max(Number(l.value),0),l.value=d(t.vaporization.input[1],{type:"input"})}),a("collapseStarsInput").addEventListener("change",()=>{let l=a("collapseStarsInput");t.collapse.input[0]=Math.max(Number(l.value),1),l.value=d(t.collapse.input[0],{type:"input"})}),a("collapseStarsInputWait").addEventListener("change",()=>{let l=a("collapseStarsInputWait");t.collapse.input[1]=Number(l.value),l.value=d(t.collapse.input[1],{type:"input"})}),a("stageInput").addEventListener("change",()=>{let l=a("stageInput");t.stage.input[0]=Math.max(Number(l.value),0),l.value=d(t.stage.input[0],{type:"input"})}),a("stage2Input").addEventListener("change",()=>{let l=a("stage2Input");t.stage.input[1]=Math.max(Number(l.value),0),l.value=d(t.stage.input[1],{type:"input"})}),a("versionButton").addEventListener("click",rn),a("hotkeysButton").addEventListener("click",on),a("save").addEventListener("click",()=>{je()}),a("file").addEventListener("change",async()=>{let l=a("file");fn(await l.files[0].text()),l.value=""}),a("export").addEventListener("click",xn),a("saveConsole").addEventListener("click",En),i&&(a("currentTheme").addEventListener("click",()=>a("themeArea").classList.add("windowOpen")),a("themeArea").addEventListener("mouseleave",()=>a("themeArea").classList.remove("windowOpen"))),a("switchTheme0").addEventListener("click",()=>ht(null));for(let l=1;l<r.stageInfo.word.length;l++)a(`switchTheme${l}`).addEventListener("click",()=>ht(l));a("saveFileNameInput").addEventListener("change",()=>{let l=a("saveFileNameInput"),u=l.value;if(u.length<1)return void(l.value=w.fileName);try{btoa(String.fromCharCode(...new TextEncoder().encode(u))),t.fileName=u}catch(m){W(`Save file name is not allowed
${m}`)}});{let l=a("saveFileHoverButton"),u=()=>a("saveFileNamePreview").textContent=gn();l.addEventListener("mouseover",u),c&&l.addEventListener("focus",u)}a("mainInterval").addEventListener("change",()=>{let l=a("mainInterval");v.intervals.main=Math.min(Math.max(Math.trunc(Number(l.value)),20),100),l.value=`${v.intervals.main}`,re(),Y()}),a("numbersInterval").addEventListener("change",()=>{let l=a("numbersInterval");v.intervals.numbers=Math.min(Math.max(Math.trunc(Number(l.value)),40),200),l.value=`${v.intervals.numbers}`,re(),Y()}),a("visualInterval").addEventListener("change",()=>{let l=a("visualInterval");v.intervals.visual=Math.min(Math.max(Math.trunc(Number(l.value)*100),20),400)*10,l.value=`${v.intervals.visual/1e3}`,re(),Y()}),a("autoSaveInterval").addEventListener("change",()=>{let l=a("autoSaveInterval");v.intervals.autoSave=Math.min(Math.max(Math.trunc(Number(l.value)),4),1800)*1e3,l.value=`${v.intervals.autoSave/1e3}`,re(),Y()}),a("thousandSeparator").addEventListener("change",()=>Lt(!1)),a("decimalPoint").addEventListener("change",()=>Lt(!0)),a("MDToggle0").addEventListener("click",()=>me(0,"mobile",!0,!0)),a("SRToggle0").addEventListener("click",()=>me(0,"reader",!0,!0)),a("reviewEvents").addEventListener("click",sn),a("showHints").addEventListener("click",Nt),a("customFontSize").addEventListener("change",()=>At()),a("stageHistorySave").addEventListener("change",()=>{let l=a("stageHistorySave");t.history.stage.input[0]=Math.min(Math.max(Math.trunc(Number(l.value)),0),100),l.value=`${t.history.stage.input[0]}`}),a("stageHistoryShow").addEventListener("change",()=>{let l=a("stageHistoryShow");t.history.stage.input[1]=Math.min(Math.max(Math.trunc(Number(l.value)),4),100),l.value=`${t.history.stage.input[1]}`,r.debug.historyStage=null,ue()}),a("vacuumHistorySave").addEventListener("change",()=>{let l=a("vacuumHistorySave");t.history.vacuum.input[0]=Math.min(Math.max(Math.trunc(Number(l.value)),0),100),l.value=`${t.history.vacuum.input[0]}`}),a("vacuumHistoryShow").addEventListener("change",()=>{let l=a("vacuumHistoryShow");t.history.vacuum.input[1]=Math.min(Math.max(Math.trunc(Number(l.value)),4),100),l.value=`${t.history.vacuum.input[1]}`,r.debug.historyVacuum=null,ue()});{let l=a("hideToggle");if(i){let u=()=>{if(!r.footer)return bt();r.intervalsId.mouseRepeat===void 0&&(r.intervalsId.mouseRepeat=setTimeout(bt,400))};l.addEventListener("touchstart",u),f&&l.addEventListener("mousedown",u)}else l.addEventListener("click",bt)}for(let l of r.tabList.tabs){a(`${l}TabBtn`).addEventListener("click",()=>_(l));for(let u of r.tabList[`${l}Subtabs`])a(`${l}SubtabBtn${u}`).addEventListener("click",()=>_(l,u))}for(let l=1;l<r.stageInfo.word.length;l++)a(`${r.stageInfo.word[l]}Switch`).addEventListener("click",()=>xe(l));document.head.append(M.styleSheet),v.theme!==null&&ht(v.theme),G("reload"),o!==null?(r.lastSave=Et(),P(`Welcome back, you were away for ${d(r.lastSave,{type:"time",padding:!1})}${s!==t.version?`
Game have been updated from ${s} to ${t.version}`:""}${v.developerMode?`
Game loaded after ${d((Date.now()-w.time.started)/1e3,{type:"time",padding:!1})}`:""}
        `),_e(r.lastSave)):(r.paused=!1,Y()),r.hotkeys.disabled=!1,a("body").style.display="",a("loading").style.display="none",document.title=`Fundamental ${w.version}`}catch(e){let n=e.stack;W(`Game failed to load
${typeof n=="string"?n.replaceAll(`${window.location.origin}/`,""):e}`,2);let s=document.createElement("div");s.innerHTML='<button type="button" id="exportError" style="width: 7em;">Export save</button><button type="button" id="deleteError" style="width: 7em;">Delete save</button>',s.style.cssText="display: flex; column-gap: 0.6em; margin-top: 0.4em;",a("loading").append(s);let o=!1;throw a("exportError").addEventListener("click",()=>{o=!0;let i=localStorage.getItem("testing_save");if(i===null)return void W("No save file detected");let c=document.createElement("a");c.href=`data:text/plain,${i}`,c.download="Fundamental post error export",c.click()}),a("deleteError").addEventListener("click",async()=>{!o&&!await j(`Recommended to export save file first
Press 'Confirm' to confirm and delete your save file`)||(localStorage.removeItem("testing_save"),window.location.reload(),W("Awaiting game reload"))}),e}})();
//# sourceMappingURL=Code.js.map
