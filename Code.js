"use strict";(()=>{var ce=(e,s=null)=>{switch(e){case"stage":return s==="Advanced"?t.stage.true>=6||o.strangeInfo.instability>0:s==="Structures"||s===null;case"Elements":case"upgrade":return t.stage.true<2&&t.discharge.energyMax<9?!1:s==="Elements"||e==="Elements"?o.stageInfo.activeAll.includes(4)&&t.upgrades[4][1]===1:s==="Upgrades"||s===null;case"strangeness":return t.strange[0].total<=0&&(!t.inflation.vacuum||t.stage.current<5)?!1:s==="Milestones"?!t.inflation.vacuum:s==="Matter"||s===null;case"settings":return s==="History"?t.strange[0].total>0:s==="Settings"||s==="Stats"||s===null}return!1},kt=(e,s)=>{if(e<1||o.buildingsInfo.maxActive[s]<e+1)return!1;if(s===1)return!0;if(s===2)return!0;if(s===3){if(t.accretion.rank===0)return!1;if(e===1)return!0;if(e===2)return t.upgrades[3][2]===1;if(e===3)return t.upgrades[3][4]===1;if(e===4)return t.upgrades[3][8]===1;if(e===5)return t.upgrades[3][11]===1}else if(s===4){if(t.collapse.mass<o.collapseInfo.unlockB[e]&&t.buildings[5][3].true<1)return!1;if(e===1)return!0;if(e===2)return t.researchesExtra[4][0]>=1;if(e===3)return t.researchesExtra[4][0]>=2;if(e===4)return t.researchesExtra[4][0]>=3;if(e===5)return t.elements[26]>=1}else if(s===5){if(e===1)return t.inflation.vacuum||t.milestones[2][0]>=7;if(e===2)return t.inflation.vacuum||t.milestones[3][0]>=7;if(e===3)return t.researchesExtra[5][0]>=1}return!1},ve=(e,s,n)=>{if(e<0)return!1;switch(n){case"upgrades":if(o.upgradesInfo[s].maxActive<e+1)return!1;if(s===1)return e===0||e===1?t.inflation.vacuum:e>5?t.upgrades[1][5]===1:!0;if(s===2)return e===7?t.strangeness[2][2]>=3:e===8?t.strangeness[2][8]>=3:!0;if(s===3)return t.accretion.rank<o.accretionInfo.rankU[e]||t.accretion.rank===0?!1:e===7?t.strangeness[3][2]>=3:!0;if(s===4)return t.collapse.mass<o.collapseInfo.unlockU[e]&&t.buildings[5][3].true<1?!1:e===2?t.upgrades[4][1]===1:e===3?t.strangeness[4][2]>=2&&t.upgrades[4][2]===1&&t.collapse.stars[1]>0:e===4?t.strangeness[4][9]>=1&&t.upgrades[4][3]===1:!0;if(s===5){if(e===0)return t.inflation.vacuum||t.milestones[2][0]>=7;if(e===1)return t.inflation.vacuum||t.milestones[3][0]>=7;if(e===2)return t.buildings[5][3].true>=1}break;case"researches":if(o.researchesInfo[s].maxActive<e+1)return!1;if(s===1)return t.upgrades[1][5]===1;if(s===2)return!0;if(s===3)return t.accretion.rank>=o.accretionInfo.rankR[e]&&t.accretion.rank!==0;if(s===4)return t.collapse.mass<o.collapseInfo.unlockR[e]&&t.buildings[5][3].true<1?!1:e===3?(t.collapse.stars[0]>0||t.buildings[5][3].true>=1)&&t.strangeness[4][2]>=1:e===4?t.collapse.stars[2]>0||t.buildings[5][3].true>=1:!0;if(s===5){if(e===0)return t.inflation.vacuum||t.milestones[2][0]>=7;if(e===1)return t.inflation.vacuum||t.milestones[3][0]>=7}break;case"researchesExtra":if(o.researchesExtraInfo[s].maxActive<e+1)return!1;if(s===1)return e===1?t.researchesExtra[1][2]>=2:e===3?t.researchesExtra[1][2]>=1:e===4?t.accretion.rank>=6:t.upgrades[1][5]===1;if(s===2)return e===3?t.accretion.rank>=6:t.upgrades[2][2]===1;if(s===3)return t.accretion.rank<o.accretionInfo.rankE[e]||t.accretion.rank===0?!1:e===4?t.researchesExtra[1][2]>=2:!0;if(s===4)return e===1?t.collapse.stars[0]>0||t.buildings[5][3].true>=1:e===2?(t.collapse.stars[0]>0||t.buildings[5][3].true>=1)&&t.strangeness[4][2]>=3:!0;if(s===5&&e===0)return t.inflation.vacuum||t.milestones[5][0]>=8;break;case"researchesAuto":{if(!t.inflation.vacuum)return!1;let a=o.researchesAutoInfo.autoStage[e][t.researchesAuto[e]];return a===s||s===5&&a===4}case"ASR":return s===1?t.upgrades[1][5]>=1:s===3?t.accretion.rank!==0:!0;case"elements":return e>=29?t.upgrades[4][4]===1:e>=27?t.upgrades[4][3]===1:e>=11?t.upgrades[4][2]===1&&(t.collapse.stars[1]>0||t.buildings[5][3].true>=1):e>=6?t.upgrades[4][2]===1:t.upgrades[4][1]===1;case"strangeness":if(o.strangenessInfo[s].maxActive<e+1)return!1;if(t.inflation.vacuum){if(s===1){if(e===7)return t.challenges.void[1]>=1;if(e===8)return t.challenges.void[1]>=2;if(e===9)return t.challenges.void[4]>=2}else if(s===2){if(e===7)return t.challenges.void[1]>=3;if(e===8)return t.challenges.void[2]>=1;if(e===9)return t.challenges.void[2]>=2}else if(s===3){if(e===8)return t.challenges.void[4]>=4;if(e===9)return t.challenges.void[5]>=2}else if(s===4){if(e===8)return t.challenges.void[4]>=3;if(e===9)return t.challenges.void[5]>=1}else if(s===5){if(e===8)return t.challenges.void[3]>=5;if([3,4,6,7].includes(e))return t.strangeness[5][5]>=1}return!0}if((s===1||s===2)&&e<6||(s===3||s===4)&&e<7)return!0;if(t.milestones[4][0]<8)return!1;if(s===5){if(e===3)return t.milestones[2][0]>=7;if(e===4)return t.milestones[3][0]>=7;if(e===5||e===6)return t.milestones[2][0]>=7||t.milestones[3][0]>=7}return!0}return!1},Se=(e,s,n)=>{switch(n){case"structures":if(s===5&&e===3)return!1;break;case"upgrades":if(s===1)return e!==5;if(s===2)return e!==2;if(s===4)return!1;break;case"researches":if(s===1)return e!==3;break;case"researchesExtra":if(s===1)return e!==2;if(s===2)return e>2;if(s===4)return e!==0;if(s===5)return e!==0;break;case"elements":return e!==26&&e!==29}return!0},ft=(e,s)=>{if(s===1){if(e===0)return t.buildings[1][t.inflation.vacuum?1:0].total;if(e===1)return t.discharge.energy}else if(s===2){if(e===0)return t.inflation.vacuum?t.vaporization.clouds:t.buildings[2][1].total;if(e===1)return t.buildings[2][2].current}else if(s===3){if(e===0)return t.inflation.vacuum?new p(t.buildings[1][0].total).multiply("1.78266192e-33"):t.buildings[3][0].total;if(e===1)return t.buildings[3][4].true+t.buildings[3][5].true}else if(s===4){if(e===0)return t.inflation.vacuum?t.buildings[4][0].total:t.collapse.mass;if(e===1)return t.collapse.stars[2]}else if(s===5){if(e===0)return o.collapseInfo.trueStars;if(e===1)return t.buildings[5][3].true}throw new TypeError(`Milestone s${s}-i${e} doesn't exist`)},It=(e,s)=>{if(t.inflation.vacuum)return t.challenges.active!==0,!1;if(t.stage.resets<4||s===5&&t.strangeness[5][5]<1)return!1;let n=o.milestonesInfo[s].need[e];return n.notEqual("0")?n.lessOrEqual(ft(e,s)):!1};var we=e=>{let{buildings:s}=E,{buildingsInfo:n,upgradesInfo:a,researchesInfo:i,researchesExtraInfo:c,strangenessInfo:l}=o,g=r("star3Explanation");if(e){M.footerStatsHTML[1][0]=["Energy%20mass.png","stage1borderImage cyanText","Mass"],n.hoverText[2][0]="Tritium",n.hoverText[3][0]="Preons hardcap",s[1][0].current.setValue("5.476e-3"),s[2][0].current.setValue("0"),s[3][0].current.setValue("9.76185667392e-36"),n.maxActive=[0,6,7,6,6,4],n.name[1][0]!=="Mass"&&(M.buildingHTML[1].unshift("Preon.png","Quarks.png"),n.name[1].unshift("Mass","Preons"),n.hoverText[1].unshift("Mass","Preons")),n.startCost[1]=[0,.005476,6,3,24,3],n.type[2][1]="improving",n.type[3][1]="delaying",n.increase[5][1]=4,n.increase[5][2]=4,g.textContent="Boost to Solar mass gain and delay to Preons hardcap";let d=[40,60,120,140,200,400,2e3,4e3,16e3,84e3];a[1].startCost.splice(0,d.length,...d),a[2].startCost[0]=10,a[2].startCost[7]=1e30,a[2].maxActive=9,a[4].maxActive=5;let u=[2400,6e3,2e4,36e3,2e4,28e3],m=[400,2e3,8e3,48e3,16e3,16e3];i[1].startCost.splice(0,u.length,...u),i[1].scaling.splice(0,m.length,...m),i[2].scaling[2]=100,i[2].scaling[3]=1e3,c[2].startCost[2]=1e28,c[1].maxActive=5,c[2].maxActive=4,c[3].maxActive=5,o.ASRInfo.costRange[1]=[4e3,12e3,2e4,36e3,6e4],o.ASRInfo.costRange[3][3]=245576045e23;let h=[1,2,1,4,12,2,24],S=[2.46,4,6,8,100,1,1];l[1].startCost.splice(0,h.length,...h),l[1].scaling.splice(0,S.length,...S);let C=[1,1,2,4,12,4,24],w=[2.46,2,3,6,800,1,1];l[2].startCost.splice(0,C.length,...C),l[2].scaling.splice(0,w.length,...w);let x=[1,2,4,16,12,4,4,24],$=[2,3.4,2,1,400,1,1.74,1];l[3].startCost.splice(0,x.length,...x),l[3].scaling.splice(0,$.length,...$);let T=[1,2,4,4,12,6,6,24],R=[2,3.4,3,4,1300,1,2,1];l[4].startCost.splice(0,T.length,...T),l[4].scaling.splice(0,R.length,...R);let A=[4,24,360,24,36,36,40,120],H=[1,10,1,2,2,1,1,1];l[5].startCost.splice(0,A.length,...A),l[5].scaling.splice(0,H.length,...H),l[1].maxActive=10,l[2].maxActive=10,l[3].maxActive=10,l[4].maxActive=10,l[5].maxActive=9,r("milestonesWelcome").innerHTML='Milestones, can only be done when inside the <span class="darkvioletText">Void</span>';let V=z("#milestone1Stage1Div > img");V.src=V.src.replace("Quarks.png","Preon.png");let q=z("#milestone1Stage2Div > img");o.milestonesInfo[2].name[0]="Distant Clouds",r("milestone1Stage2Name").textContent="Distant Clouds",q.src=q.src.replace("Drop.png","Clouds.png"),q.alt="Distant Clouds",z("#milestone1Stage3Div > img").alt="Center of gravity",o.milestonesInfo[3].name[0]="Center of gravity",r("milestone1Stage3Name").textContent="Center of gravity",z("#stageHistory > h4").textContent="Stage resets:",r("preonCap").style.display="",r("molesProduction").style.display="",r("massProduction").style.display="",r("dustCap").style.display="",r("mainCap").style.display="",r("strange7Stage1").style.display="",r("strange7Stage2").style.display="",r("strange8Stage3").style.display="",r("strange8Stage4").style.display="",r("strange6Stage5").style.display="",r("collapseCapped").style.display="";for(let P=2;P<=5;P++)r(`strangeness${v.MDSettings[0]?"Page":"Section"}${P}`).style.display="",r(`milestone1Stage${P}Div`).style.display="",r(`milestone2Stage${P}Div`).style.display="";r("vacuumBoost").style.display="none",r("stageInstant").style.display="none",r("unknownStructures").style.display="none"}else{M.footerStatsHTML[1][0]=["Quarks.png","stage1borderImage cyanText","Quarks"],n.hoverText[2][0]="Moles",n.hoverText[3][0]="Mass",s[1][0].current.setValue("3"),s[2][0].current.setValue("2.8e-3"),s[3][0].current.setValue("1e-19"),n.name[1][0]==="Mass"&&(M.buildingHTML[1].splice(0,2),n.name[1].splice(0,2),n.hoverText[1].splice(0,2)),n.maxActive=[0,4,6,5,5,4],n.startCost[1]=[0,3,24,3],n.type[2][1]="producing",n.type[3][1]="producing",n.increase[5][1]=2,n.increase[5][2]=2,g.textContent="Boost to Solar mass gain";let d=[0,0,9,12,36,300,800,2e3,4e3,22e3];a[1].startCost.splice(0,d.length,...d),a[2].startCost[0]=1e4,a[2].startCost[7]=1e28,a[1].maxActive=10,a[2].maxActive=8,a[3].maxActive=13,a[4].maxActive=4,a[5].maxActive=3;let u=[1e3,2500,6e3,8e3,8e3,6e3],m=[250,500,2e3,8e3,4e3,6e3];i[1].startCost.splice(0,u.length,...u),i[1].scaling.splice(0,m.length,...m),i[2].scaling[2]=1e3,i[2].scaling[3]=100,i[1].maxActive=6,i[2].maxActive=6,i[3].maxActive=9,i[4].maxActive=5,i[5].maxActive=2,c[2].startCost[2]=1e26,c[1].maxActive=0,c[2].maxActive=3,c[3].maxActive=4,c[4].maxActive=3,c[5].maxActive=1,o.ASRInfo.costRange[1]=[6e3,12e3,18e3],o.ASRInfo.costRange[3][3]=2e30;let h=[1,1,1,2,4,2,24],S=[1,1,1.5,3,0,0,0];l[1].startCost.splice(0,h.length,...h),l[1].scaling.splice(0,S.length,...S);let C=[1,1,2,2,4,2,24],w=[.5,.75,2.5,3,0,0,0];l[2].startCost.splice(0,C.length,...C),l[2].scaling.splice(0,w.length,...w);let x=[1,1,2,6,4,2,6,24],$=[.75,1.5,2,0,0,0,6,0];l[3].startCost.splice(0,x.length,...x),l[3].scaling.splice(0,$.length,...$);let T=[1,1,3,2,4,2,4,24],R=[1,2,2.5,3,0,0,76,0];l[4].startCost.splice(0,T.length,...T),l[4].scaling.splice(0,R.length,...R);let A=[80,80,40,20,24,24,20,240],H=[80,0,0,20,24,0,0,0];l[5].startCost.splice(0,A.length,...A),l[5].scaling.splice(0,H.length,...H),l[1].maxActive=7,l[2].maxActive=7,l[3].maxActive=8,l[4].maxActive=8,l[5].maxActive=8,r("milestonesWelcome").innerHTML='Any reached Milestone will award 1 <span class="greenText">Strange quark</span>';let V=z("#milestone1Stage1Div > img");V.src=V.src.replace("Preon.png","Quarks.png");let q=z("#milestone1Stage2Div > img");o.milestonesInfo[2].name[0]="A Nebula of Drops",r("milestone1Stage2Name").textContent="A Nebula of Drops",q.src=q.src.replace("Clouds.png","Drop.png"),q.alt="A Nebula of Drops",z("#milestone1Stage3Div > img").alt="Cluster of Mass",o.milestonesInfo[3].name[0]="Cluster of Mass",r("milestone1Stage3Name").textContent="Cluster of Mass",z("#stageHistory > h4").textContent="Interstellar Stage resets:",r("vacuumBoost").style.display="",r("strange8Stage5").style.display="",r("milestonesProgressArea").style.display="",r("stageInstant").style.display="",r("rankStat0").style.display="",r("preonCap").style.display="none",r("molesProduction").style.display="none",r("massProduction").style.display="none",r("dustCap").style.display="none",r("submersionBoost").style.display="none",r("mainCap").style.display="none",r("researchAuto1").style.display="none",r("collapseCapped").style.display="none";for(let P=1;P<l.length;P++)for(let ee=l[P].maxActive+1;ee<=l[P].startCost.length;ee++)r(`strange${ee}Stage${P}`).style.display="none"}v.SRSettings[0]&&(g.textContent=` (${g.textContent})`);for(let d=1;d<=3;d++){let u=s[d][0].current;s[d][0].total.setValue(u),s[d][0].trueTotal.setValue(u),s[d][0].highest.setValue(u)}},Rt=async()=>{if(t.inflation.vacuum)return void N("This cannot be undone");let e=o.strangeInfo.instability;if(e<5)return void N(`Universe is still stable. Vacuum state is false. ${5-e} more`);await K(`This will not be possible to undo. Confirm?
(This will reset everything)`)&&(t.stage.true<6&&(await ue(6,-1),t.stage.true=6,t.collapse.show=0),t.inflation.vacuum=!0,t.stage.current=1,t.stage.active=1,we(!0),Lt(),v.SRSettings[0]&&(r("SRMain").textContent="Vacuum state is now true"))},At=()=>{let e=t.milestones,s='<h4 class="darkvioletText">Unknown Structures:</h4>';e[1][0]>=6&&(s+='<img src="Used_art/Preon.png" alt="Unknown Structure" loading="lazy" draggable="false">'),e[2][1]>=7&&(s+='<img src="Used_art/Ocean.png" alt="Unknown Structure" loading="lazy" draggable="false">'),e[3][1]>=7&&(s+='<img src="Used_art/Subsatellite.png" alt="Unknown Structure" loading="lazy" draggable="false">'),e[4][1]>=8&&(s+='<img src="Used_art/Quasi%20star.png" alt="Unknown Structure" loading="lazy" draggable="false">');let n=r("unknownStructures");n.style.display=o.strangeInfo.instability>0?"":"none",n.innerHTML!==s&&(n.innerHTML=s)};var j=(e,s=null)=>{if(s===null){let a=o.tab;r(`${a}Tab`).style.display="none",r(`${a}TabBtn`).classList.remove("tabActive");let i=o.tabList[`${a}Subtabs`];if(i!==void 0)for(let g of i)r(`${a}SubtabBtn${g}`).style.display="none";o.tab=e;let c=0;r(`${e}Tab`).style.display="",r(`${e}TabBtn`).classList.add("tabActive");let l=o.tabList[`${e}Subtabs`];if(l!==void 0)for(let g of l)ce(e,g)?(r(`${e}SubtabBtn${g}`).style.display="",c++):o.subtab[`${e}Current`]===g&&j(e,l[0]);r("subtabs").style.display=c>1?"":"none",v.SRSettings[0]&&(r("SRTab").textContent=`Current tab is '${e}'${c>1?` and subtab is '${o.subtab[`${e}Current`]}'`:""}`)}else{let a=o.subtab[`${e}Current`];r(`${e}Subtab${a}`).style.display="none",r(`${e}SubtabBtn${a}`).classList.remove("tabActive"),o.subtab[`${e}Current`]=s,r(`${e}Subtab${s}`).style.display="",r(`${e}SubtabBtn${s}`).classList.add("tabActive"),v.SRSettings[0]&&(r("SRTab").textContent=`Current subtab is '${s}', part of '${e}' tab`)}let n=t.stage.active;o.trueActive!==n?he(o.trueActive):n!==4&&n!==5&&(o.tab==="upgrade"&&o.subtab.upgradeCurrent==="Elements"||e==="Elements")?e==="upgrade"&&s===null||!o.stageInfo.activeAll.includes(4)?j("upgrade","Upgrades"):(re(4,n),F()):(ne(),Q())},Ue=()=>t.stage.true>=6?43200:Math.min(3600*Math.min(t.stage.true,4)+Math.max(t.stage.resets-3,0)*1800,43200),Ge=(e=0)=>{let{time:s}=t,{auto:n,buildings:a}=t.toggles,{maxActive:i,type:c}=o.buildingsInfo,{autoU:l,autoR:g,autoE:d,elements:u}=o.automatization,m=t.inflation.vacuum,h;if(e>0){let w=Math.min(1,e);h=w,e-=w}else{let w=Date.now();if(h=(w-s.updated)/1e3,s.updated=w,s.online+=h,s.export[0]+=h,o.lastSave+=h,h<0){s.offline+=h;return}else h>60&&(s.offline=Math.min(s.offline+h-60,Ue()),h=60)}let S=h;s.stage+=S,s.universe+=S;let C=1;m&&t.strangeness[5][0]>=1&&t.challenges.active!==0&&(C*=1.2),o.inflationInfo.globalSpeed=C,h*=C,t.stage.time+=h,t.inflation.age+=h,m&&n[0]&&ge(5,!0),t.strangeness[5][8]>=1&&Nt(0,S),te();for(let w of o.stageInfo.activeAll){!m&&n[0]&&ge(w,!0),w===4?(Je(n[4],!0),u.length!==0&&Ut()):w===3?n[3]&&je(!0):w===2?Ke(n[2],S):w===1&&_e(n[1],!0),l[w].length!==0&&Pt(w),g[w].length!==0&&dt("researches",w),d[w].length!==0&&dt("researchesExtra",w);for(let x=i[w]-1;x>=1;x--)a[w][x]&&t.ASR[w]>=x&&de(x,w,0,!0),c[w][x]==="producing"&&(xe(x-1,w,h),te());if(w===1)xe(5,1,h);else if(w===5){let x=t.researches[5][0];x>=1&&xe(1,5,h),x>=2&&xe(2,5,h),x>=3&&xe(3,5,h)}}e>0&&Ge(e)},Q=()=>{let{tab:e,subtab:s}=o,{stage:n}=t,a=n.active,i=t.buildings[a],c=t.inflation.vacuum?5:n.current;if(ge(c)){let l=b.strangeGain(c)/t.time.stage;n.peak<l&&(n.peak=l)}if(o.footer){if(a===1)r("footerStat1Span").textContent=f(i[0].current,{padding:!0}),r("footerStat2Span").textContent=f(t.discharge.energy,{padding:t.discharge.energy>=1e6});else if(a===2)r("footerStat1Span").textContent=f(t.vaporization.clouds,{padding:!0}),r("footerStat2Span").textContent=f(i[0].current,{padding:!0}),r("footerStat3Span").textContent=f(i[1].current,{padding:!0});else if(a===3)r("footerStat1Span").textContent=f(i[0].current,{padding:!0});else if(a===4||a===5){let l=t.buildings[4];r("footerStat1Span").textContent=f(t.collapse.mass,{padding:!0}),r("footerStat2Span").textContent=f(l[0].current,{padding:!0}),a===5&&(r("footerStat3Span").textContent=f(new p(l[1].current).plus(l[2].current,l[3].current,l[4].current,l[5].current),{padding:!0}))}}if(e==="stage")if(s.stageCurrent==="Structures"){let{buildingsInfo:l}=o,g=o.hotkeys.shift?1:o.hotkeys.ctrl?10:t.toggles.shop.input;for(let d=1;d<l.maxActive[a];d++){let u=r(`building${d}True`);if(r(`building${d}Cur`).textContent=f(i[d].current,{padding:u.style.display!=="none"}),r(`building${d}Prod`).textContent=f(l.producing[a][d],{padding:!0}),u.textContent=`[${f(i[d].true)}]`,a===3){if(d>1&&t.upgrades[3][o.accretionInfo.unlockA[d-2]]!==1){r(`building${d}`).classList.remove("availableBuilding"),r(`building${d}Btn`).textContent="Unlocked with Upgrade",r(`building${d}BuyX`).textContent="Locked";continue}}else if(a===4){let x=o.collapseInfo.unlockB[d];if(t.collapse.mass<x&&t.buildings[5][3].true<1){r(`building${d}`).classList.remove("availableBuilding"),r(`building${d}Btn`).textContent=`Unlocked at ${f(x)} Mass`,r(`building${d}BuyX`).textContent="Locked";continue}}let m,h,S=!1;if(a===5&&d===3)m="Mass",h=t.collapse.mass;else{let x=d-1,$=a;a===1?d===1&&(S=t.researchesExtra[1][2]>=1&&t.strangeness[1][8]>=1):a===2?d!==1&&(x=1):a>=3&&(x=0,a===5&&($=4)),m=l.name[$][x],h=t.buildings[$][x].current}let C=1,w=Qe(d,a);if(g!==1&&(a!==5||d!==3)){let x=l.increase[a][d];S?(C=g<=0?Math.max(Math.floor(new p(h).divide(w).log(x).toNumber())+1,1):g,C>1&&w.multiply(new p(x).power(C-1))):(C=g<=0?Math.max(Math.floor(new p(h).multiply(x-1).divide(w).plus("1").log(x).toNumber()),1):g,C>1&&w.multiply(new p(x).power(C).minus("1").divide(x-1)))}r(`building${d}`).classList[w.lessOrEqual(h)?"add":"remove"]("availableBuilding"),r(`building${d}Btn`).textContent=`Need: ${f(w,{padding:!0})} ${m}`,r(`building${d}BuyX`).textContent=f(C)}if(a===1)mt(),r("dischargeBase").textContent=f(o.dischargeInfo.base),r("reset1Button").textContent=`Next goal is ${f(o.dischargeInfo.next)} Energy`,r("tritiumEffect").textContent=f(o.dischargeInfo.tritium,{padding:!0}),r("dischargeEffectStat").textContent=f(new p(o.dischargeInfo.base).power(o.dischargeInfo.total),{padding:!0}),r("energySpent").textContent=f(o.dischargeInfo.energyTrue-t.discharge.energy),t.inflation.vacuum&&(r("preonCapStat").textContent=f(o.inflationInfo.preonCap,{padding:!0}),r("preonCapRatio").textContent=f(new p(o.inflationInfo.preonTrue).divide(o.inflationInfo.preonCap),{padding:!0}));else if(a===2)Ee(),r("reset1Button").textContent=o.vaporizationInfo.get.moreThan("0")?`Reset for ${f(o.vaporizationInfo.get,{padding:!0})} Clouds`:`Waiting for ${f(b.S2Upgrade2(),{padding:!0})} Drops`,r("cloudEffectStat").textContent=f(o.vaporizationInfo.strength,{padding:!0}),t.inflation.vacuum&&(r("molesProductionStat").textContent=f(new p(o.dischargeInfo.tritium).divide("6.02214076e23"),{padding:!0}));else if(a===3)t.inflation.vacuum&&(r("massProductionStat").textContent=f(new p(l.producing[1][1]).multiply("1.78266192e-33"),{padding:!0}),r("dustCapStat").textContent=f(o.inflationInfo.dustCap,{padding:!0}),r("dustCapRatio").textContent=f(new p(o.inflationInfo.dustTrue).divide(o.inflationInfo.dustCap),{padding:!0}),r("submersionBoostStat").textContent=f(b.submersion(),{padding:!0}));else if(a===4){let{collapse:d}=t,{collapseInfo:u}=o;Le(),Pe(),r("reset1Button").textContent=`Collapse to ${f(u.newMass,{padding:!0})} Mass`,r("solarMassCurrent").textContent=f(u.massEffect,{padding:!0});for(let m=1;m<=3;m++)r(`special${m}Cur`).textContent=f(d.stars[m-1]),r(`special${m}Get`).textContent=f(u.starCheck[m-1]),r(`star${m}Current`).textContent=f(u.starEffect[m-1],{padding:!0});if(t.inflation.vacuum){let m=new p(o.inflationInfo.massCap/896499278339628e-81).minus(t.buildings[1][0].current).divide(l.producing[1][1]).toNumber()/o.inflationInfo.globalSpeed;r("mainCapStat").textContent=f(o.inflationInfo.massCap,{padding:!0}),r("mainCapTill").textContent=isFinite(m)?f(m,{padding:!0}):"Infinity"}}else a===5&&(Le(),r("solarMassOnCollapse").textContent=f(o.collapseInfo.newMass,{padding:!0}));if(!t.inflation.vacuum){let d=a>=4?"Return back to start":a===n.current?"Enter next Stage":"Reset this Stage",u=(a>=4?t.strange[0].total<=0:a===n.current)?"Not ready for more":"Not ready for reset";r("stageReset").textContent=(a>=4?n.current>=5&&t.events[0]:ge(a))?d:u}r("stageTime").textContent=f(n.time,{type:"time"}),r("stageTimeRealStat").textContent=f(t.time.stage,{type:"time"})}else s.stageCurrent==="Advanced"&&(t.inflation.vacuum||(r("vacuumEffect").textContent=f(o.strangeInfo.instability)),r("globalSpeedStat").textContent=f(o.inflationInfo.globalSpeed,{padding:!0}),r("universeAge").textContent=f(t.inflation.age,{type:"time"}),r("universeAgeTime").textContent=f(t.time.universe,{type:"time"}));else if(e==="upgrade"||e==="Elements"){let l=e==="Elements"?e:s.upgradeCurrent;if(l==="Upgrades"){let g=o.lastUpgrade[a];g[0]>=0&&Ne(g[0],g[1])}else l==="Elements"&&o.lastElement>=1&&Ne(o.lastElement,"elements")}else if(e==="strangeness"){if(s.strangenessCurrent==="Matter"){let l=t.inflation.vacuum?5:a,g=b.strangeGain(l);if(r("strange0Inc").textContent=f(g),r("strange1Inc").textContent=f(b.strangeGain(l,1)),r("strangeRate").textContent=f(g/t.time.stage,{type:"income",padding:!0}),r("strangePeak").textContent=f(n.peak,{type:"income",padding:!0}),r("strange0Cur").textContent=f(t.strange[0].current),r("strange1Cur").textContent=f(t.strange[1].current),r("stageTimeStrangeness").textContent=f(t.time.stage,{type:"time"}),r("stageTimeBestReset").textContent=f(t.history.stage.best[0],{type:"time"}),r("strangeletsEffectsMain").style.display==="")r("strangeletsEffect1Stat").textContent=f(b.strangeletsProd(),{padding:!0}),r("strangeletsEffect2Stat").textContent=f(b.strangeletsBuff(),{padding:!0});else if(r("quarksEffectsMain").style.display===""){let{stageBoost:d}=o.strangeInfo,{strangeness:u}=t;r("quarksEffect1Stat").textContent=u[1][6]>=1?f(d[1],{padding:!0}):"1",r("quarksEffect2Stat").textContent=u[2][6]>=1?f(d[2],{padding:!0}):"1",r("quarksEffect3Stat").textContent=u[3][7]>=1?f(d[3],{padding:!0}):"1",r("quarksEffect4Stat").textContent=u[4][7]>=1?f(d[4],{padding:!0}):"1",r("quarksEffect5Stat").textContent=u[5][7]>=1?f(d[5],{padding:!0}):"1"}o.lastStrangeness[0]>=0&&Be(o.lastStrangeness[0],o.lastStrangeness[1],"strangeness")}else if(s.strangenessCurrent==="Milestones"){let l=o.milestonesInfo;for(let g=1;g<l.length;g++){let d=l[g].need;for(let u=0;u<d.length;u++){let m=ft(u,g);r(`milestone${u+1}Stage${g}Current`).textContent=f(m,{padding:!0}),r(`milestone${u+1}Stage${g}Required`).textContent=d[u].notEqual("0")?d[u].lessOrEqual(m)?"Reached":f(d[u],{padding:!0}):"Maxed"}}}}else if(e==="settings"){if(s.settingsCurrent==="Settings"){let l=t.time.export,g=Math.min(l[0]/86400,1);for(let d=0;d<2;d++){let u=["Quarks","Strangelets"][d],m=l[d+1]/2.5+(d===0?1:0),h=Math.floor(m),S=Math.min(m*g,h),C=(h-S)/m*86400;r(`export${u}Max`).textContent=f(h,{padding:!0}),r(`export${u}Cur`).textContent=f(S,{padding:!0}),r(`export${u}Time`).textContent=C>0?f(C,{type:"time"}):"maxed"}o.lastSave>=1&&(r("isSaved").textContent=`${f(o.lastSave,{type:"time"})} ago`)}else if(s.settingsCurrent==="Stats"){if(r("firstPlayStat").textContent=`${new Date(t.time.started).toLocaleString()} (${f((Date.now()-t.time.started)/1e3,{type:"time"})} ago)`,r("firstPlay").title=`Total online time is ${f(t.time.online,{type:"time"})}`,r("stageResetsCount").textContent=f(n.resets),r("offlineStat").textContent=f(t.time.offline,{type:"time",padding:!1}),r("maxOfflineStat").textContent=f(Ue(),{type:"time",padding:!1}),a===1)r("maxEnergyStat").textContent=f(t.discharge.energyMax),r("dischargeStat").textContent=f(o.dischargeInfo.total),r("dischargeStatTrue").textContent=` [${t.discharge.current}]`;else if(a===2){Ee();let l=new p(b.clouds(!0)).divide(o.vaporizationInfo.strength).toNumber();r("cloudEffectAfter").textContent=`x${f(l,{padding:!0})}`;let g=b.S2Extra1_2(),d=b.S2Extra1_2(!0),u=d[0]/g[0],m=d[1]/g[1];if(r("rainEffectAfter").textContent=`x${f(u,{padding:!0})}`,r("stormEffectAfter").textContent=`x${f(m,{padding:!0})}`,r("cloudEffectTotal").textContent=`x${f(l*u*m,{padding:!0})}`,r("maxCloudStat").textContent=f(t.vaporization.cloudsMax),t.inflation.vacuum){let h=t.buildings[1][5];i[0].total.setValue(h.total).divide("6.02214076e23"),i[0].trueTotal.setValue(h.trueTotal).divide("6.02214076e23"),i[0].highest.setValue(h.highest).divide("6.02214076e23")}}else if(a===3){if(r("currentRank").textContent=`${t.accretion.rank}`,t.inflation.vacuum){let l=t.buildings[1][0];i[0].total.setValue(l.total).multiply("1.78266192e-33"),i[0].trueTotal.setValue(l.trueTotal).multiply("1.78266192e-33"),i[0].highest.setValue(l.highest).multiply("1.78266192e-33")}}else if(a===4||a===5){let l=o.collapseInfo;if(r("starsStatTrue").textContent=f(l.trueStars),r("maxSolarMassStat").textContent=f(t.collapse.massMax),a===4){let g=t.strangeness[4][4]>=2;Le(),Pe();let d=b.mass(!0)/l.massEffect;r("massEffectAfter").textContent=`x${f(d,{padding:!0})}`;let u=g?1:b.star[0](!0)/l.starEffect[0],m=g?1:b.star[1](!0)/l.starEffect[1],h=g?1:b.star[2](!0)/l.starEffect[2];g||(r("star1After").textContent=`x${f(u,{padding:!0})}`,r("star2After").textContent=`x${f(m,{padding:!0})}`,r("star3After").textContent=`x${f(h,{padding:!0})}`);let S=b.S4Research4(!0)/b.S4Research4();r("gammaRayAfter").textContent=`x${f(S,{padding:!0})}`,r("starTotal").textContent=`x${f(d*u*m*h*S,{padding:!0})}`}else if(a===5){let g=t.buildings[4];i[0].current.setValue(g[1].current).plus(g[2].current,g[3].current,g[4].current,g[5].current),i[0].total.setValue(g[1].total).plus(g[2].total,g[3].total,g[4].total,g[5].total),i[0].trueTotal.setValue(g[1].trueTotal).plus(g[2].trueTotal,g[3].trueTotal,g[4].trueTotal,g[5].trueTotal),i[0].highest.setValue(g[1].highest).plus(g[2].highest,g[3].highest,g[4].highest,g[5].highest)}}for(let l=0;l<i.length;l++)r(`building${l}StatTotal`).textContent=f(i[l].total,{padding:!0}),r(`building${l}StatTrueTotal`).textContent=f(i[l].trueTotal,{padding:!0}),r(`building${l}StatHighest`).textContent=f(i[l].highest,{padding:!0});r("strange0StatTotal").textContent=f(t.strange[0].total,{padding:!0}),r("strange1StatTotal").textContent=f(t.strange[1].total,{padding:!0})}}},ne=()=>{let{tab:e,subtab:s}=o,{active:n,true:a}=t.stage,i=t.inflation.vacuum;if(t.events[0]||(a===5?n===5&&ue(5,0):a===4?t.elements.includes(.5,1)&&ue(4,0):a===3?t.buildings[3][0].current.moreOrEqual("5e29")&&ue(3,0):a===2?(Ee(),new p(o.vaporizationInfo.get).plus(t.vaporization.clouds).moreThan("1e4")&&ue(2,0)):a===1&&t.upgrades[1][5]===1&&ue(1,0)),o.footer&&(v.toggles[1]&&(r("ElementsTabBtn").style.display=t.upgrades[4][1]===1?"":"none"),n===1?a<2&&(r("footerStat2").style.display=t.discharge.energyMax>=9?"":"none",r("upgradeTabBtn").style.display=t.discharge.energyMax>=9?"":"none"):n===2&&(r("footerStat1").style.display=t.upgrades[2][2]===1?"":"none")),v.MDSettings[0]){let c=e==="stage"||e==="upgrade"||e==="Elements";c&&(n===1?c=t.upgrades[1][5]===1:n===2?c=t.upgrades[2][2]===1:n===4?c=t.upgrades[4][0]===1:n===5&&(c=!1)),r("reset1Footer").style.display=c?"":"none",r("resetCollapseFooter").style.display=n===5&&e==="stage"?"":"none",r("stageFooter").style.display=e==="stage"&&(a>=2||t.upgrades[1][9]===1)||e==="strangeness"?"":"none"}if(e==="stage")if(s.stageCurrent==="Structures"){let c=t.buildings[n],l=t.ASR[n];r("stageTimeReal").style.display=t.stage.time!==t.time.stage?"":"none",r("offlineWarning").style.display=t.time.offline>0&&t.time.offline>=Ue()?"":"none",a<2&&(r("toggleBuilding0").style.display=l>=1?"":"none");for(let g=1;g<o.buildingsInfo.maxActive[n];g++)r(`building${g}True`).style.display=c[g].current.notEqual(c[g].true)?"":"none",r(`toggleBuilding${g}`).style.display=l>=g?"":"none";if(n===1)r("reset1Main").style.display=t.upgrades[1][5]===1?"":"none",r("building2").style.display=c[1].trueTotal.moreOrEqual(i?"4":"11")?"":"none",r("building3").style.display=c[2].trueTotal.moreOrEqual("2")?"":"none",i&&(r("building4").style.display=c[3].trueTotal.moreOrEqual("8")?"":"none",r("building5").style.display=c[4].trueTotal.moreOrEqual("2")?"":"none"),r("stageInfo").style.display=t.upgrades[1][5]===1?"":"none",r("tritium").style.display=t.upgrades[1][8]===1?"":"none",a<2&&(r("resetStage").style.display=t.upgrades[1][9]===1?"":"none"),a<7&&t.stage.resets<1&&(r("resets").style.display=t.upgrades[1][5]===1?"":"none");else if(n===2)r("reset1Main").style.display=t.upgrades[2][2]===1?"":"none",r("building2").style.display=c[1].trueTotal.moreOrEqual("2e2")?"":"none",r("building3").style.display=c[1].trueTotal.moreOrEqual("4e6")?"":"none",r("building4").style.display=c[1].trueTotal.moreOrEqual("4e17")?"":"none",r("building5").style.display=c[1].trueTotal.moreOrEqual("4e22")?"":"none",r("cloudEffect").style.display=t.upgrades[2][2]===1?"":"none",i?r("building6").style.display=c[1].trueTotal.moreOrEqual("8e24")?"":"none":r("stageInfo").style.display=t.upgrades[2][2]===1?"":"none";else if(n===3){let g=t.upgrades[3],d=t.accretion.rank;r("buildings").style.display=d>=1?"":"none",r("building2").style.display=d>=3||g[2]===1?"":"none",r("building3").style.display=d>=4||g[4]===1?"":"none",r("building4").style.display=d>=5||g[8]===1?"":"none",i&&(r("building5").style.display=d>=6||g[11]===1?"":"none",r("submersionBoost").style.display=t.researchesExtra[1][2]>=2?"":"none"),Jt()}else if(n===4){let g=t.researchesExtra[4][0];r("specials").style.display=c[2].trueTotal.moreThan("0")?"":"none",r("special2").style.display=c[3].trueTotal.moreThan("0")?"":"none",r("special3").style.display=c[4].trueTotal.moreThan("0")?"":"none",r("reset1Main").style.display=t.upgrades[4][0]===1?"":"none",r("building2").style.display=g>=1?"":"none",r("building3").style.display=g>=2?"":"none",r("building4").style.display=g>=3?"":"none",r("star1Effect").style.display=c[2].trueTotal.moreThan("0")?"":"none",r("star2Effect").style.display=c[3].trueTotal.moreThan("0")?"":"none",r("star3Effect").style.display=c[4].trueTotal.moreThan("0")?"":"none",i&&(r("building5").style.display=t.elements[26]>=1?"":"none")}else n===5&&(i||(r("buildings").style.display=t.milestones[2][0]>=7||t.milestones[3][0]>=7?"":"none",r("building1").style.display=t.milestones[2][0]>=7?"":"none",r("building2").style.display=t.milestones[3][0]>=7?"":"none"),r("building3").style.display=t.researchesExtra[5][0]>=1?"":"none")}else s.stageCurrent==="Advanced"&&(r("globalSpeed").style.display=o.inflationInfo.globalSpeed!==1?"":"none",r("universeAgeReal").style.display=t.inflation.age!==t.time.universe?"":"none",r("challenge1").style.display=i&&t.strangeness[5][0]>=1?"":"none");else if(e==="upgrade"||e==="Elements"){let c=e==="Elements"?e:s.upgradeCurrent;if(c==="Upgrades"){if(i&&(r("researchAuto1").style.display=t.researchesExtra[1][2]>=2?"":"none"),n===1){let l=t.upgrades[1][5]===1;r("upgrade7").style.display=l?"":"none",r("upgrade8").style.display=l?"":"none",r("upgrade9").style.display=l?"":"none",r("upgrade10").style.display=l?"":"none",r("researches").style.display=l?"":"none",i&&(r("researchExtra2").style.display=t.researchesExtra[1][2]>=2?"":"none",r("researchExtra4").style.display=t.researchesExtra[1][2]>=1?"":"none",r("researchExtra5").style.display=t.accretion.rank>=6?"":"none")}else if(n===2){let l=t.buildings[2];r("upgrade2").style.display=l[2].trueTotal.moreThan("0")?"":"none",r("upgrade3").style.display=l[3].trueTotal.moreThan("0")?"":"none",r("upgrade4").style.display=l[2].trueTotal.moreThan("0")?"":"none",r("upgrade5").style.display=l[2].trueTotal.moreThan("0")?"":"none",r("upgrade6").style.display=l[3].trueTotal.moreThan("0")?"":"none",r("upgrade7").style.display=l[4].trueTotal.moreThan("0")?"":"none",r("upgrade8").style.display=t.strangeness[2][2]>=3&&l[5].trueTotal.moreThan("0")?"":"none",i&&(r("upgrade9").style.display=t.strangeness[2][8]>=3&&l[6].trueTotal.moreThan("0")?"":"none",r("researchExtra4").style.display=t.accretion.rank>=6?"":"none"),r("research2").style.display=l[2].trueTotal.moreThan("0")?"":"none",r("research3").style.display=l[2].trueTotal.moreThan("0")?"":"none",r("research4").style.display=l[2].trueTotal.moreThan("0")?"":"none",r("research5").style.display=l[3].trueTotal.moreThan("0")?"":"none",r("research6").style.display=l[4].trueTotal.moreThan("0")?"":"none",r("extraResearches").style.display=t.upgrades[2][2]===1?"":"none",r("researchExtra3").style.display=l[5].trueTotal.moreThan("0")?"":"none"}else if(n===3){let l=t.accretion.rank,g=t.buildings[3][2].trueTotal.moreThan("0");r("upgrade3").style.display=l>=2?"":"none",r("upgrade4").style.display=g?"":"none",r("upgrade5").style.display=l>=3?"":"none",r("upgrade6").style.display=l>=4||t.upgrades[3][4]===1?"":"none",r("upgrade7").style.display=l>=4?"":"none",r("upgrade8").style.display=l>=4&&t.strangeness[3][2]>=3?"":"none",r("upgrade9").style.display=l>=4?"":"none",r("upgrade10").style.display=l>=4?"":"none",r("upgrade11").style.display=l>=5?"":"none",r("upgrade12").style.display=l>=5?"":"none",r("upgrade13").style.display=l>=5?"":"none",r("research3").style.display=g?"":"none",r("research4").style.display=g?"":"none",r("research5").style.display=l>=3?"":"none",r("research6").style.display=l>=3?"":"none",r("research7").style.display=l>=4||t.upgrades[3][4]===1?"":"none",r("research8").style.display=l>=4?"":"none",r("research9").style.display=l>=5?"":"none",r("extraResearches").style.display=l>=2?"":"none",r("researchExtra2").style.display=l>=3?"":"none",r("researchExtra3").style.display=l>=4?"":"none",r("researchExtra4").style.display=l>=5?"":"none",i?r("researchExtra5").style.display=l>=3&&t.researchesExtra[1][2]>=2?"":"none":(r("upgrades").style.display=l>=1?"":"none",r("stageResearches").style.display=l>=1?"":"none")}else if(n===4){let l=t.collapse.stars,g=t.buildings[5][3].true>=1;r("upgrade4").style.display=t.strangeness[4][2]>=2?"":"none",r("upgrade5").style.display=t.strangeness[4][9]>=1?"":"none",r("research4").style.display=(g||l[0]>0)&&t.strangeness[4][2]>=1?"":"none",r("research5").style.display=g||l[2]>0?"":"none",r("researchExtra2").style.display=g||l[0]>0?"":"none",r("researchExtra3").style.display=(g||l[0]>0)&&t.strangeness[4][2]>=3?"":"none"}else if(n===5){if(!i){let l=t.milestones[2][0]>=7,g=t.milestones[3][0]>=7;r("upgrades").style.display=l||g?"":"none",r("upgrade1").style.display=l?"":"none",r("upgrade2").style.display=g?"":"none",r("stageResearches").style.display=l||g?"":"none",r("research1").style.display=l?"":"none",r("research2").style.display=g?"":"none",r("extraResearches").style.display=t.milestones[5][0]>=8?"":"none"}r("upgrade3").style.display=t.researchesExtra[5][0]>=1?"":"none"}}else if(c==="Elements"){let l=t.upgrades[4],g=t.upgrades[4][2]===1&&(t.collapse.stars[1]>0||t.buildings[5][3].true>=1),d=r("elementsGrid");d.style.display=l[2]===1?"":"flex",d.classList[!g&&l[2]===1?"add":"remove"]("tenElements");for(let u=6;u<=10;u++)r(`element${u}`).style.display=l[2]===1?"":"none";for(let u=11;u<=26;u++)r(`element${u}`).style.display=g?"":"none";r("element27").style.display=l[3]===1?"":"none",r("element28").style.display=l[3]===1?"":"none",r("element29").style.display=l[4]===1?"":"none"}}else if(e==="strangeness")if(s.strangenessCurrent==="Matter"){let c=t.strangeness[5][5]>=1;if(r("strange1").style.display=t.strangeness[5][8]>=1?"":"none",r("strange1Gain").style.display=t.strangeness[5][8]>=1?"":"none",r("strangeRateType").textContent=t.strangeness[5][8]>=1?"Strange quarks rate":"Rate",r("strange4Stage5").style.display=(i?c:t.milestones[2][0]>=7)?"":"none",r("strange5Stage5").style.display=(i?c:t.milestones[3][0]>=7)?"":"none",r("strange7Stage5").style.display=(i?c:t.milestones[2][0]>=7||t.milestones[3][0]>=7)?"":"none",i){let l=t.challenges.void;r("strange8Stage1").style.display=l[1]>=1?"":"none",r("strange9Stage1").style.display=l[1]>=2?"":"none",r("strange10Stage1").style.display=l[4]>=2?"":"none",r("strange8Stage2").style.display=l[1]>=3?"":"none",r("strange9Stage2").style.display=l[2]>=1?"":"none",r("strange10Stage2").style.display=l[2]>=2?"":"none",r("strange9Stage3").style.display=l[4]>=4?"":"none",r("strange10Stage3").style.display=l[5]>=2?"":"none",r("strange9Stage4").style.display=l[4]>=3?"":"none",r("strange10Stage4").style.display=l[5]>=1?"":"none",r("strange8Stage5").style.display=c?"":"none",r("strange9Stage5").style.display=l[3]>=5?"":"none"}else{let l=t.milestones[4][0]>=8;r("strange7Stage1").style.display=l?"":"none",r("strange7Stage2").style.display=l?"":"none",r("strange8Stage3").style.display=l?"":"none",r("strange8Stage4").style.display=l?"":"none",r(`strangeness${v.MDSettings[0]?"Page":"Section"}5`).style.display=l?"":"none",r("strange6Stage5").style.display=t.milestones[2][0]>=7||t.milestones[3][0]>=7?"":"none"}}else s.strangenessCurrent==="Milestones"&&(i||(r("milestone1Stage5Div").style.display=t.strangeness[5][5]>=1?"":"none",r("milestone2Stage5Div").style.display=t.milestones[5][0]>=8?"":"none",o.stageInfo.activeAll.includes(4)&&(r("milestonesStage5Progress").style.display=t.strangeness[5][5]>=1?"":"none"),o.stageInfo.activeAll.includes(5)&&(r("milestone2Stage5Progress").style.display=t.milestones[5][0]>=8?"":"none")));else if(e==="settings"){if(s.settingsCurrent==="Settings"){let{researchesAuto:c,strangeness:l}=t;r("exportStrangelets").style.display=l[5][8]>=1?"":"none",r("toggleAuto0").style.display=l[5][2]>=1?"":"none",r("toggleAuto0Main").style.display=l[5][2]>=1?"":"none",r("autoToggle5").style.display=c[0]>=1?"":"none",r("autoToggle6").style.display=c[0]>=2?"":"none",r("autoToggle7").style.display=c[0]>=3?"":"none",r("autoToggle8").style.display=l[4][6]>=2?"":"none",r("toggleAuto1").style.display=l[1][4]>=1?"":"none",r("toggleAuto2").style.display=l[2][4]>=1?"":"none",r("toggleAuto2Main").style.display=l[2][4]>=1?"":"none",r("toggleAuto3").style.display=l[3][4]>=1?"":"none",r("toggleAuto4").style.display=l[4][4]>=1?"":"none",r("toggleAuto4Main").style.display=l[4][4]>=1?"":"none",a<2&&(r("resetToggles").style.display=t.upgrades[1][5]===1?"":"none",r("dischargeHotkey").style.display=t.upgrades[1][5]===1?"":"none",r("stageToggleReset").style.display=t.upgrades[1][9]===1?"":"none",r("stageHotkey").style.display=t.upgrades[1][9]===1?"":"none"),a<3&&(r("vaporizationToggleReset").style.display=t.upgrades[2][2]===1?"":"none",r("vaporizationHotkey").style.display=t.upgrades[2][2]===1?"":"none"),a<5&&(r("collapseToggleReset").style.display=t.upgrades[4][0]===1?"":"none",r("collapseHotkey").style.display=t.upgrades[4][0]===1?"":"none",r("elementsAsTab").style.display=t.upgrades[4][1]===1?"":"none"),a<7&&(r("exportReward").style.display=t.stage.resets>=(i?1:4)?"":"none")}else if(s.settingsCurrent==="History")Yt();else if(s.settingsCurrent==="Stats"){let{strange:c,strangeness:l}=t,g=t.buildings[n];r("stageResets").style.display=t.stage.resets>0?"":"none";for(let d=1;d<o.buildingsInfo.maxActive[n];d++)r(`building${d}Stats`).style.display=g[d].trueTotal.moreThan("0")?"":"none";if(r("strangeAllStats").style.display=c[0].total>0?"":"none",r("strange1Stats").style.display=c[1].total>0?"":"none",i||At(),r("solarMassStat").style.display=n===4||n===5?"":"none",n===1)r("energyStats").style.display=a>=5||t.discharge.energyMax>=9?"":"none",r("dischargeStats").style.display=t.upgrades[1][5]===1?"":"none",r("dischargeStatTrue").style.display=t.discharge.current!==o.dischargeInfo.total?"":"none";else if(n===2)r("vaporizationBoost").style.display=t.upgrades[2][2]===1?"":"none",r("rainEffect").style.display=t.researchesExtra[2][1]>=1?"":"none",r("stormEffect").style.display=t.researchesExtra[2][2]>=1?"":"none",r("cloudStats").style.display=t.upgrades[2][2]===1?"":"none";else if(n===3){i&&(r("rankStat0").style.display=l[2][9]>=1?"":"none");for(let d=1;d<o.accretionInfo.rankImage.length;d++)r(`rankStat${d}`).style.display=t.accretion.rank>=d?"":"none"}else if(n===4){let d=t.strangeness[4][4]>=2;r("star1Stat").style.display=!d&&g[2].trueTotal.moreThan("0")?"":"none",r("star2Stat").style.display=!d&&g[3].trueTotal.moreThan("0")?"":"none",r("star3Stat").style.display=!d&&g[4].trueTotal.moreThan("0")?"":"none",r("gammaRayStat").style.display=t.researches[4][4]>=1?"":"none"}}}},Ne=(e,s)=>{if(s==="elements"){let i=o.elementsInfo;r("elementText").textContent=`${i.name[e]}.`,r("elementEffect").textContent=t.elements[e]>=1||t.collapse.show>=e&&e!==0?i.effectText[e]():"Effect is not yet known.",r("elementCost").textContent=t.elements[e]>=1?"Obtained.":t.elements[e]>0?"Awaiting Collapse.":e===0?"Unknown.":`${f(i.startCost[e])} Elements.`;return}let n=t.stage.active,a=n===1?"Energy":n===2?"Drops":n===3?"Mass":"Elements";if(s==="upgrades"){let i=o[`${s}Info`][n];r("upgradeText").textContent=`${i.name[e]}.`,r("upgradeEffect").textContent=i.effectText[e](),r("upgradeCost").textContent=t.upgrades[n][e]===1?"Created.":n===4&&o.collapseInfo.unlockU[e]>t.collapse.mass&&t.buildings[5][3].true<1?`Unlocked at ${f(o.collapseInfo.unlockU[e])} Mass.`:`${f(i.startCost[e])} ${a}.`}else if(s==="researches"||s==="researchesExtra"){let i=o[`${s}Info`][n],c=t[s][n][e];if(s==="researchesExtra"&&n===4&&e===0&&(i.name[0]=["Nova","Supernova","Hypernova"][Math.min(c,2)]),r("upgradeText").textContent=`${i.name[e]}.`,r("upgradeEffect").textContent=i.effectText[e](),c>=i.max[e])r("upgradeCost").textContent="Maxed.";else if(n===4&&s==="researches"&&o.collapseInfo.unlockR[e]>t.collapse.mass&&t.buildings[5][3].true<1)r("upgradeCost").textContent=`Unlocked at ${f(o.collapseInfo.unlockR[e])} Mass.`;else{let l=1,g=i.cost[e];if(t.toggles.max[0]&&t.stage.true>=2&&i.max[e]>1){let d=i.scaling[e];if(n===1)if(t.accretion.rank>=6&&t.strangeness[1][9]>=1)l=Math.min(Math.max(Math.floor((t.discharge.energy-g)/d+1),1),i.max[e]-c),l>1&&(g+=(l-1)*d);else{let u=g-d/2;l=Math.min(Math.max(Math.floor(((u**2+2*d*t.discharge.energy)**.5-u)/d),1),i.max[e]-c),l>1&&(g=l*(l*d/2+u))}else{let u=n===2?t.buildings[2][1].current:n===3?t.buildings[3][0].current:t.buildings[4][0].current;l=Math.min(Math.max(Math.floor(new p(u).multiply(d-1).divide(g).plus("1").log(d).toNumber()),1),i.max[e]-c),l>1&&(g=new p(d).power(l).minus("1").divide(d-1).multiply(g).toNumber())}}r("upgradeCost").textContent=`${f(g)} ${a}.${l>1?` [x${f(l)}]`:""}`}}else if(s==="researchesAuto"){let i=o.researchesAutoInfo,c=t.researchesAuto[e];if(r("upgradeText").textContent=`${i.name[e]}.`,r("upgradeEffect").textContent=i.effectText[e](),c>=i.max[e])r("upgradeCost").textContent="Maxed.";else{let l=i.autoStage[e][c];r("upgradeCost").textContent=l===n||n===5&&l===4?`${f(i.costRange[e][c])} ${a}.`:`This level can only be created while inside '${o.stageInfo.word[l]}'.`}}else if(s==="ASR"){let i=o.ASRInfo,c=t.ASR[n];r("upgradeText").textContent=`${i.name}.`,r("upgradeEffect").textContent=i.effectText(),r("upgradeCost").textContent=c>=i.max[n]?"Maxed.":n===3&&t.accretion.rank<1?"Cannot be created at 'Ocean world' Rank.":`${f(i.costRange[n][c])} ${a}.`}},Be=(e,s,n)=>{let a=r(`${n}Stage`);if(a.style.color=`var(--${o.stageInfo.textColor[s]}-text)`,a.textContent=`${o.stageInfo.word[s]}. `,n==="strangeness"){let i=o.strangenessInfo[s];r("strangenessText").textContent=`${i.name[e]}.`,r("strangenessEffect").textContent=i.effectText[e](),r("strangenessCost").textContent=t.strangeness[s][e]>=i.max[e]?"Maxed.":`${f(i.cost[e])} Strange quarks.`}else{let i=o.milestonesInfo[s],c=r("milestonesMultiline"),l=c.parentElement;r("milestonesText").textContent=`${i.name[e]}. (${f(t.milestones[s][e])})`,t.inflation.vacuum?c.innerHTML=`<p class="orchidText">Requirement: <span class="greenText">${i.needText[e]()}</span></p>
            <p class="darkvioletText">Effect: <span class="greenText">${i.rewardText[e]()}</span></p>`:i.need[e].notEqual("0")?c.innerHTML=`<p class="orchidText">Requirement: <span class="greenText">${i.needText[e]()}</span></p>
            <p class="darkvioletText">Unlock: <span class="greenText">Main reward unlocked after ${i.scalingOld[e].length-t.milestones[s][e]} more completions.</span></p>`:c.innerHTML=`<p class="darkvioletText">Reward: <span class="greenText">${i.rewardText[e]()}</span></p>`,l.style.minHeight=`${l.offsetHeight}px`}},$e=e=>{let s;if(e===-1)s=`<h3 class="orchidText">Vacuum state: <span ${t.inflation.vacuum?'class="greenText">true':'class="redText">false'}</span></h3>`;else{let n=o.challengesInfo,a=`${n.color[e]}Text`;s=`<h3 class="${a} bigWord">${n.name[e]}${t.challenges.active===e?', <span class="greenText">active</span>':""}</h3>
        <p class="whiteText">${n.description[e]}</p>
        <div><h4 class="${a} bigWord">Effect:</h4>
        <p>${n.effectText[e]()}</p></div>`}if(e===0){let n=t.challenges.void;r("voidRewards").style.display="",r("voidRewardSubmerged").style.display=n[1]>=3?"":"none",r("voidRewardAccretion").style.display=n[1]>=2?"":"none",r("voidRewardInterstellar").style.display=n[3]>=5?"":"none",r("voidRewardIntergalactic").style.display=n[4]>=4?"":"none"}else r("voidRewards").style.display="none";r("challengeMultiline").innerHTML=s},We=e=>{let s=o.challengesInfo.needText[0][e],n=o.challengesInfo.rewardText[0][e],a=t.challenges.void[e],i="";for(let c=0;c<s.length;c++)i+=`<div><p><span class="${a>c?"greenText":"redText"}">\u2192</span> ${e===2&&c===1?s[c].replace("1e4",f(1e4)):s[c]}</p>
        <p><span class="${a>c?"greenText":"redText"}">Reward:</span> ${a>c?n[c]:"Not yet unlocked"}</p></div>`;r("voidRewardsDivText").innerHTML=i},oe=(e,s,n)=>{if(n==="upgrades"){if(s!==t.stage.active)return;let a="",i=r(`upgrade${e+1}`);t.upgrades[s][e]===1?(s===1?a="green":s===2?a="darkgreen":s===3?a="#0000b1":s===4?a="#1f1f8f":s===5&&(a="#990000"),i.tabIndex=v.SRSettings[0]&&v.SRSettings[1]?0:-1):i.tabIndex=0,i.style.backgroundColor=a}else if(n==="elements"){let a=r(`element${e}`);t.elements[e]>=1?(a.classList.remove("awaiting"),a.classList.add("created"),a.tabIndex=v.SRSettings[0]&&v.SRSettings[1]?0:-1):t.elements[e]>0?(a.classList.add("awaiting"),a.classList.remove("created"),a.tabIndex=0):(a.classList.remove("awaiting"),a.classList.remove("created"),a.tabIndex=0)}},O=(e,s,n)=>{let a,i,c,l;if(n==="researches"||n==="researchesExtra"){if(s!==t.stage.active)return;a=o[`${n}Info`][s].max[e],i=t[n][s][e];let g=n==="researches"?"":"Extra";c=r(`research${g}${e+1}Level`),r(`research${g}${e+1}Max`).textContent=`${a}`,l=r(`research${g}${e+1}Image`)}else if(n==="researchesAuto")a=o.researchesAutoInfo.max[e],i=t.researchesAuto[e],c=r(`researchAuto${e+1}Level`),r(`researchAuto${e+1}Max`).textContent=`${a}`,l=r(`researchAuto${e+1}Image`);else if(n==="ASR"){if(s!==t.stage.active)return;a=o.ASRInfo.max[s],i=t.ASR[s],c=r("ASRLevel"),r("ASRMax").textContent=`${a}`,l=r("ASRImage")}else a=o.strangenessInfo[s].max[e],i=t.strangeness[s][e],c=r(`strange${e+1}Stage${s}Level`),r(`strange${e+1}Stage${s}Max`).textContent=`${a}`,l=r(`strange${e+1}Stage${s}Image`);c.textContent=`${i}`,i>=a?(c.style.color="var(--green-text)",l.tabIndex=v.SRSettings[0]&&v.SRSettings[1]?0:-1):i===0?(c.style.color="",l.tabIndex=0):(c.style.color="var(--orchid-text)",l.tabIndex=0)},Jt=()=>{let e=t.accretion.rank;if(o.debug.rankUpdated===e)return;let s=o.accretionInfo,n=r("rankName");r("rankMessage").textContent=e===0?"Might need more than just water... Increase Rank with Mass.":`Increase it with Mass. (Return back to ${t.inflation.vacuum?"Preons":"Dust"}, but unlock something new)`,r("reset1Button").textContent=e>=s.maxRank?"Max Rank achieved":`Next Rank is ${f(s.rankCost[e])} Mass`,r("rankImage").src=`Used_art/${s.rankImage[e]}`,n.textContent=s.rankName[e],n.style.color=`var(--${s.rankColor[e]}-text)`,o.debug.rankUpdated=e},Ce=()=>{let e=t.researchesExtra[4][2]>=1;r("special1").title=e?"White dwarfs (Red giants)":"Red giants",z("#special1 > img").src=`Used_art/${e?"White%20dwarf":"Red%20giant"}.png`,r("special1Cur").className=e?"cyanText":"redText"},Yt=()=>{if(o.debug.historyStage===t.stage.resets)return;let e=o.historyStorage.stage,s=Math.min(e.length,t.history.stage.input[1]),n="";if(s>0)for(let i=0;i<s;i++)n+=`<li class="whiteText"><span class="greenText">${f(e[i][1])} Strange quarks</span>${e[i][2]>0?`, <span class="greenText">${f(e[i][2])} Strangelets</span>`:""}, <span class="blueText">${f(e[i][0],{type:"time"})}</span>, <span class="darkorchidText">${f(e[i][1]/e[i][0],{type:"income",padding:!0})}</span></li>`;else n='<li class="redText">Reference list is empty</li>';r("stageResetsList").innerHTML=n;let a=t.history.stage.best;r("stageBest").innerHTML=`Best reset: <span class="whiteText"><span class="greenText">${f(a[1])} Strange quarks</span>${a[2]>0?`, <span class="greenText">${f(a[2])} Strangelets</span>`:""}, <span class="blueText">${f(a[0],{type:"time"})}</span>, <span class="darkorchidText">${f(a[1]/a[0],{type:"income",padding:!0})}</span></span>`,o.debug.historyStage=t.stage.resets},f=(e,s={})=>{if(typeof e=="object")return e?.format(s);let n=s.type??"number",a;if(n==="income"){let d=Math.abs(e);d>=1?a="per second":d>=1/60?(e*=60,a="per minute"):d>=1/3600?(e*=3600,a="per hour"):d>=1/86400?(e*=86400,a="per day"):d>=1/31556952?(e*=31556952,a="per year"):d>=1/31556952e3?(e*=31556952e3,a="per millennium"):d>=1/31556952e6?(e*=31556952e6,a="per megaannum"):(e*=31556952e9,a="per eon"),s.padding===void 0&&(s.padding=!0)}else if(n==="time"){let d=Math.abs(e);if(d<60)a="seconds";else if(d<3600){let u=Math.trunc(e/60),m=Math.trunc(e-u*60);return s.padding===!1&&m===0?`${u} minutes`:`${u} minutes ${m} seconds`}else if(d<86400){let u=Math.trunc(e/3600),m=Math.trunc(e/60-u*60);return s.padding===!1&&m===0?`${u} hours`:`${u} hours ${m} minutes`}else if(d<31556952){let u=Math.trunc(e/86400),m=Math.trunc(e/3600-u*24);return s.padding===!1&&m===0?`${u} days`:`${u} days ${m} hours`}else if(d<31556952e3){let u=Math.trunc(e/31556952),m=Math.trunc(e/86400-u*365.2425);return s.padding===!1&&m===0?`${u} years`:`${u} years ${m} days`}else d<31556952e6?(e/=31556952e3,a="millenniums"):d<31556952e9?(e/=31556952e6,a="megaannums"):(e/=31556952e9,a="eons");s.padding=!(s.padding===!1&&Math.trunc(e)===e),s.digits=e>=1e3&&e<1e6?0:3}if(!isFinite(e))return a!==void 0?`${e} ${a}`:`${e}`;let i=Math.abs(e);if(i>=1e6||i<.001&&i>0){let d=s.digits??2,u=Math.floor(Math.log10(i)),m=Math.round(e/10**(u-d))/10**d;Math.abs(m)===10&&(m/=10,u++);let h=s.padding?m.toFixed(d):`${m}`;return n==="input"?`${h}e${u}`:(h=`${h.replace(".",v.format[0])}e${u}`,a!==void 0?`${h} ${a}`:h)}let c=s.digits??Math.max(4-Math.floor(Math.log10(Math.max(i,1))),0),l=Math.round(e*10**c)/10**c,g=s.padding?l.toFixed(c):`${l}`;return n==="input"?g:(g=g.replace(".",v.format[0]),l>=1e3&&(g=g.replace(/\B(?=(\d{3})+(?!\d))/,v.format[1])),a!==void 0?`${g} ${a}`:g)},F=(e="normal")=>{let{stageInfo:s,buildingsInfo:n}=o,{active:a,current:i,true:c,resets:l}=t.stage,g=t.inflation.vacuum,d=t.challenges.active;s.activeAll=[g?1:i];let u=s.activeAll;if(g)t.researchesExtra[1][2]>=2&&u.push(2),t.researchesExtra[1][2]>=1&&u.push(3),t.accretion.rank>=6&&u.push(4),i>=5&&t.strangeness[5][5]>=1&&u.push(5);else{i===5&&u.unshift(4);for(let y=t.strangeness[5][0];y>=1;y--)i!==y&&u.unshift(y)}for(let y=1;y<=7;y++){for(let D of qe(`stage${y}Only`))D.style.display=a===y?"":"none";for(let D of qe(`stage${y}Include`))D.style.display=u.includes(y)?"":"none";for(let D of qe(`stage${y}Unlock`))D.style.display=c>=y?"":"none"}let m=r("stageWord"),h=r("stageStatus");if(d===-1?(h.textContent="Current Stage:",h.style.color="",m.textContent=s.word[i],m.style.color=`var(--${s.textColor[i]}-text)`):(h.textContent="Currently inside:",h.style.color="var(--red-text)",m.textContent=o.challengesInfo.name[d],m.style.color=`var(--${o.challengesInfo.color[d]}-text)`),r("stageSelect").style.display=u.length>1?"":"none",t.strange[0].total<=0&&(!g||i<5)&&(r("strangenessTabBtn").style.display="none"),g)r("stageReset").textContent=i>=5?"Return back to start":"Not ready for reset",r("milestonesProgressArea").style.display=d===0?"":"none",(l>=1||c>=7)&&(r("dischargeToggleReset").style.display="",r("vaporizationToggleReset").style.display="",r("rankToggleReset").style.display="",r("collapseToggleReset").style.display="");else for(let y=2;y<=4;y++){let D=c>=6||l>=y+3;r(`strangeness${v.MDSettings[0]?"Page":"Section"}${y}`).style.display=D?"":"none",r(`milestone1Stage${y}Div`).style.display=D?"":"none",r(`milestone2Stage${y}Div`).style.display=D?"":"none"}if(e==="soft"){Q(),ne();return}if(v.MDSettings[0]&&(r("reset1Footer").textContent=M.resetHTML[a],e==="reload"&&Ye(1)),v.SRSettings[0]){r("reset1Main").setAttribute("aria-label",`${M.resetHTML[a]} reset (hotkey ${["","D","V","R","C","Shift + M"][a]})`);for(let y=1;y<n.maxActive[a];y++)r(`building${y}`).setAttribute("aria-label",`${n.name[a][y]} (hotkey ${y})`);r("extraResearches").setAttribute("aria-label",`${["","Energy","Cloud","Rank","Collapse","Galaxy"][a]} Researches`),r("SRStage").textContent=`Current active Stage is '${s.word[a]}'${d!==-1?` inside the '${o.challengesInfo.name[d]}'`:""}`}for(let y of["upgrade","element"])r(`${y}Text`).textContent="Hover to see.",r(`${y}Effect`).textContent="Hover to see.",r(`${y}Cost`).textContent="Resource.";if(e==="reload"){for(let y=1;y<=5;y++)r(`${s.word[y]}Switch`).style.textDecoration=a===y?"underline":"",o.lastUpgrade[y][0]=-1;o.lastElement=-1,o.lastStrangeness=[-1,-1],o.lastMilestone=[-1,-1],o.debug.historyStage=-1;for(let y of["strangeness","milestones"])r(`${y}Stage`).textContent="",r(`${y}Text`).textContent="Hover to see.";r("strangenessEffect").textContent="Hover to see.",r("strangenessCost").textContent="Strange quarks.",r("milestonesMultiline").innerHTML='<p class="orchidText">Requirement: <span class="greenText">Hover to see.</span></p><p class="darkvioletText">Unlock: <span class="greenText">Hover to see.</span></p>',o.lastChallenge=[t.inflation.vacuum&&t.strangeness[5][0]>=1?0:-1,-1],$e(o.lastChallenge[0]),o.trueActive=a;for(let y=0;y<o.elementsInfo.startCost.length;y++)oe(y,4,"elements");Ce(),me("all"),se("researches","all"),se("researchesExtra","all"),pe()}let S=o.upgradesInfo[a],C=o.researchesInfo[a],w=o.researchesExtraInfo[a],x=M.footerStatsHTML[a];for(let y=n.maxActive[a];y<M.longestBuilding;y++)r(`building${y}Stats`).style.display="none",r(`building${y}`).style.display="none";for(let y=S.maxActive;y<M.longestUpgrade;y++)r(`upgrade${y+1}`).style.display="none";for(let y=C.maxActive;y<M.longestResearch;y++)r(`research${y+1}`).style.display="none";for(let y=w.maxActive;y<M.longestResearchExtra;y++)r(`researchExtra${y+1}`).style.display="none";for(let y=x.length;y<M.longestFooterStats;y++)r(`footerStat${y+1}`).style.display="none";let $=[],T=[],R=[],A=[];a===1?($.push(2,3,4,5),T.push(0,1,2,3,4,5),A.push(0,1,2),g?($.push(0,1),R.push(0,2),r("extraResearches").style.display=""):(r("upgrade1").style.display="none",r("upgrade2").style.display="none",r("extraResearches").style.display="none")):a===2?($.push(0),T.push(0,1),R.push(0,1),A.push(1,2),g&&(r("stageInfo").style.display="")):a===3?($.push(0,1),T.push(0,1),R.push(0),A.push(0),o.debug.rankUpdated=-1,r("reset1Main").style.display="",r("stageInfo").style.display=g?"":"none"):a===4?($.push(0,1,2),T.push(0,1,2),R.push(0),A.push(0,1),r("stageInfo").style.display="",r("extraResearches").style.display=""):a===5&&(R.push(0),A.push(0,1,2),r("reset1Main").style.display="none",r("stageInfo").style.display="",g&&(r("building2").style.display="",$.push(0,1),T.push(0,1),r("extraResearches").style.display="")),r("buildings").style.display="",r("building1").style.display="",r("upgrades").style.display="",r("researches").style.display="",r("stageResearches").style.display="",a!==4&&(r("specials").style.display="none"),r("autoWaitInput").value=f(t.toggles.shop.wait[a],{type:"input"});let H=M.buildingHTML[a],V=n.name[a],q=n.type[a],P=n.hoverText[a];for(let y=1;y<n.maxActive[a];y++)r(`building${y}Image`).src=`Used_art/${H[y-1]}`,r(`building${y}StatName`).textContent=V[y],r(`building${y}Name`).textContent=V[y],z(`#building${y}ProdDiv > span`).textContent=q[y],r(`building${y}ProdDiv`).title=P[y-1],G(y,"buildings");r("building0StatName").textContent=V[0],G(0,"buildings");let ee=M.upgradeHTML[a];for(let y=0;y<S.maxActive;y++){let D=r(`upgrade${y+1}`);$.includes(y)&&(D.style.display=""),D.src=`Used_art/${ee[y]}`,D.alt=S.name[y],oe(y,a,"upgrades")}let Re=M.researchHTML[a];for(let y=0;y<C.maxActive;y++){let D=r(`research${y+1}`);T.includes(y)&&(D.style.display=""),D.className=Re[y][1];let Ae=r(`research${y+1}Image`);Ae.src=`Used_art/${Re[y][0]}`,Ae.alt=C.name[y],O(y,a,"researches")}let ye=M.researchExtraHTML[a];for(let y=0;y<w.maxActive;y++){let D=r(`researchExtra${y+1}`);R.includes(y)&&(D.style.display=""),D.className=ye[y][1];let Ae=r(`researchExtra${y+1}Image`);Ae.src=`Used_art/${ye[y][0]}`,Ae.alt=w.name[y],O(y,a,"researchesExtra")}z("#extraResearches > div").className=M.researchExtraDivHTML[a][1],z("#extraResearches > img").src=`Used_art/${M.researchExtraDivHTML[a][0]}`,O(0,a,"ASR");for(let y=0;y<x.length;y++)A.includes(y)&&(r(`footerStat${y+1}`).style.display=""),z(`#footerStat${y+1} > img`).src=`Used_art/${x[y][0]}`,z(`#footerStat${y+1} > p`).className=x[y][1],r(`footerStat${y+1}Name`).textContent=x[y][2];let W=document.body.style;a===1?(W.removeProperty("--stage-text"),W.removeProperty("--stage-button-border"),W.removeProperty("--stage-image-borderColor"),W.removeProperty("--image-border")):(W.setProperty("--stage-text",`var(--${s.textColor[a]}-text)`),W.setProperty("--stage-button-border",s.buttonBorder[a]),W.setProperty("--stage-image-borderColor",s.imageBorderColor[a]),W.setProperty("--image-border",`url("Used_art/Stage${a} border.png")`)),r("currentSwitch").textContent=s.word[a],o.trueActive===a&&j(ce(o.tab)?o.tab:"stage"),pt()};var Te=(e,s)=>{if(e==="galaxy"){let{elements:n}=t;for(let a=1;a<n.length;a++)Se(a,4,"elements")&&(n[a]=0,oe(a,4,"elements"));pe(),t.collapse.mass=.01235,t.collapse.stars=[0,0,0]}for(let n of s){n===2?(o.vaporizationInfo.research0=0,o.vaporizationInfo.research1=0):n===4&&(o.collapseInfo.trueStars=0);let a=t.buildings[n];a[0].current.setValue(E.buildings[n][0].current),a[0].total.setValue(E.buildings[n][0].current);for(let g=1;g<o.buildingsInfo.maxActive[n];g++)Se(g,n,"structures")&&(a[g].true=0,a[g].current.setValue("0"),a[g].total.setValue("0"));if(e==="discharge")continue;let i=t.upgrades[n];for(let g=0;g<o.upgradesInfo[n].maxActive;g++)Se(g,n,"upgrades")&&(i[g]=0,oe(g,n,"upgrades"));if(me(n),e==="vaporization")continue;let c=t.researches[n];for(let g=0;g<o.researchesInfo[n].maxActive;g++)Se(g,n,"researches")&&(c[g]=0,O(g,n,"researches"),Me(g,n,"researches"));if(se("researches",n),e==="rank")continue;let l=t.researchesExtra[n];for(let g=0;g<o.researchesExtraInfo[n].maxActive;g++)Se(g,n,"researchesExtra")&&(l[g]=0,O(g,n,"researchesExtra"),Me(g,n,"researchesExtra"));se("researchesExtra",n),Ce()}if(t.inflation.vacuum){let n=o.dischargeInfo.energyType[5][3]*t.buildings[5][3].true;t.discharge.energy=n,o.dischargeInfo.energyTrue=n}else e==="discharge"&&(t.discharge.energy=0,o.dischargeInfo.energyTrue=0);te(),s.includes(t.stage.active)&&Q(),ne()},ht=(e,s="normal")=>{for(let n of e){let a=t.buildings[n],i=E.buildings[n][0].current;for(let c=1;c<o.buildingsInfo.maxActive[n];c++)a[c].true=0,a[c].current.setValue("0"),a[c].total.setValue("0"),a[c].trueTotal.setValue("0");if(a[0].current.setValue(i),a[0].total.setValue(i),a[0].trueTotal.setValue(i),t.upgrades[n]=_(E.upgrades[n]),t.researches[n]=_(E.researches[n]),t.researchesExtra[n]=_(E.researchesExtra[n]),me(n),o.lastUpgrade[n][0]=-1,n===1)t.strangeness[1][5]<1&&(t.ASR[1]=0),t.discharge.current=0,t.discharge.energy=0,o.dischargeInfo.energyTrue=0;else if(n===2)t.strangeness[2][5]<1&&(t.ASR[2]=0),t.vaporization.clouds.setValue("0"),o.vaporizationInfo.research0=0,o.vaporizationInfo.research1=0;else if(n===3)t.strangeness[3][5]<1&&(t.ASR[3]=0),t.inflation.vacuum?t.accretion.rank=1:(t.accretion.rank=0,a[0].current.setValue("5.9722e27"));else if(n===4){t.strangeness[4][5]<1&&(t.ASR[4]=0),o.collapseInfo.trueStars=0,t.collapse.mass=.01235,t.collapse.stars=[0,0,0],t.elements=_(E.elements),t.elements[0]=t.strangeness[4][8]>=1?1:0,pe();for(let c=0;c<t.elements.length;c++)oe(c,4,"elements");o.lastElement=-1}else n===5&&t.strangeness[5][6]<1&&(t.ASR[5]=0)}t.researchesAuto[0]=t.strangeness[3][6];for(let n=0;n<E.researchesAuto.length;n++)O(n,0,"researchesAuto");Ce();for(let n of e){for(let a=0;a<o.researchesInfo[n].maxActive;a++)k(a,n,"researches");for(let a=0;a<o.researchesExtraInfo[n].maxActive;a++)k(a,n,"researchesExtra");k(0,n,"ASR"),se("researches",n),se("researchesExtra",n)}if(te(),s!==!1&&(F(s),s==="soft")){let n=t.stage.active;for(let a=0;a<o.upgradesInfo[n].maxActive;a++)oe(a,n,"upgrades")}},Lt=()=>{for(let e=1;e<=5;e++){let s=t.buildings[e],n=E.buildings[e][0].current;for(let a=1;a<E.buildings[e].length;a++)s[a].true=0,s[a].current.setValue("0"),s[a].total.setValue("0"),s[a].trueTotal.setValue("0"),s[a].highest.setValue("0");s[0].current.setValue(n),s[0].total.setValue(n),s[0].trueTotal.setValue(n),s[0].highest.setValue(n),t.upgrades[e]=_(E.upgrades[e]),t.researches[e]=_(E.researches[e]),t.researchesExtra[e]=_(E.researchesExtra[e]),t.strangeness[e]=_(E.strangeness[e]),t.milestones[e]=_(E.milestones[e]),t.ASR[e]=0}for(let e=0;e<E.researchesAuto.length;e++)t.researchesAuto[e]=0,O(e,0,"researchesAuto");t.discharge.energy=0,t.discharge.energyMax=0,t.discharge.current=0,o.dischargeInfo.energyTrue=0,t.vaporization.clouds.setValue("0"),t.vaporization.cloudsMax.setValue("0"),o.vaporizationInfo.research0=0,o.vaporizationInfo.research1=0,t.inflation.vacuum?t.accretion.rank=1:(t.accretion.rank=0,t.buildings[3][0].current.setValue("5.9722e27")),o.collapseInfo.trueStars=0,t.collapse.mass=.01235,t.collapse.massMax=.01235,t.collapse.stars=[0,0,0],t.elements=_(E.elements),o.historyStorage.stage=[],t.history.stage.best=[1,0,0,0],t.stage.resets=0,t.stage.peak=0,t.stage.time=0,t.time.stage=0;for(let e=0;e<t.strange.length;e++)t.time.export[e+1]=0,t.strange[e].current=0,t.strange[e].total=0;te(),ie(),ke(),Xe();for(let e=1;e<=5;e++){for(let s=0;s<o.researchesInfo[e].maxActive;s++)k(s,e,"researches");for(let s=0;s<o.researchesExtraInfo[e].maxActive;s++)k(s,e,"researchesExtra");k(0,e,"ASR");for(let s=0;s<o.strangenessInfo[e].maxActive;s++)k(s,e,"strangeness");for(let s=0;s<E.milestones[e].length;s++)He(s,e)}F("reload")};var b={dischargeBase:(e=t.researches[1][4])=>{let s=4+e;return t.challenges.active===0&&(s/=2),s},S1Upgrade6:()=>10+3*t.researches[1][0],S1Upgrade7:()=>(102+t.researches[1][1])/100,S1Research2:()=>20+t.strangeness[1][1]*2,S1Research5:(e=0)=>{if(!t.inflation.vacuum)return 1.25+(t.researches[1][5]+e)/4;let s=o.dischargeInfo.total;return s>7?s+14:s*3},S1Extra1:(e=t.researchesExtra[1][1])=>e>=4?1.1:e>=3?1.2:(20-3*e)/10,S1Extra3:(e=t.researchesExtra[1][3])=>e/20,S1Extra4:()=>1+o.dischargeInfo.base/100,clouds:(e=!1)=>{let s=new p(t.vaporization.clouds).plus("1");return e&&s.plus(o.vaporizationInfo.get),s.moreThan("1e4")&&s.minus("1e4").power(.7).plus("1e4"),s},S2Upgrade1:()=>{let e=t.buildings[2][2],s=new p("1.02").power((e.current.toNumber()-e.true)**.7+Math.min(e.true,200));return e.true>200&&s.multiply(new p("1.01").power(e.true-200)),s},S2Upgrade2:()=>1e10/2**t.strangeness[2][3],S2Upgrade3:(e=t.researches[2][2])=>(1+e/2)/100,S2Upgrade4:(e=t.researches[2][3])=>(1+e/2)/100,S2Upgrade5:()=>1+t.researches[2][4],S2Upgrade6:()=>1+t.researches[2][5],S2Extra1_2:(e=!1,s=t.researchesExtra[2][1],n=t.researchesExtra[2][2])=>{if(s<1)return[1,1];let a=new p(t.vaporization.clouds);if(e&&a.plus(o.vaporizationInfo.get),n<1)return[Math.max(a.power(.1).toNumber(),1),1];let i=Math.max(a.power(.11).toNumber(),1);return[i,(i-1)/16+1]},submersion:()=>{let e=new p(t.buildings[2][1].current);return(e.moreThan("1e10")?e.power(.6).divide("1e4").plus("1.000000002"):e.plus("1").power(.2).plus("1")).log(2).toNumber()},S3Upgrade0:()=>(101+t.researches[3][1])/100,S3Upgrade1:(e=t.researchesExtra[3][3])=>(5+e)/100,S3Upgrade3:()=>(102+t.researches[3][4]/2)/100,S3Research6:(e=t.researches[3][6])=>e/40,S3Extra1:(e=t.researchesExtra[3][1])=>(1+e/10)**t.accretion.rank,S3Extra4:(e=t.researchesExtra[3][4])=>e>0?8**((t.accretion.rank+e)/8):1,mass:(e=!1)=>{let s=1,n=t.collapse.mass;return e&&(s=.5,o.collapseInfo.newMass>n&&(n=o.collapseInfo.newMass)),t.elements[21]>=s&&(n**=1.1),t.challenges.active===0&&(n>1&&(n**=.4),n/=2e4),n},star:[(e=!1)=>{let s=1,n=t.collapse.stars[0]+1;return e&&(s=.5,n+=o.collapseInfo.starCheck[0]),t.elements[27]>=s&&(n+=t.buildings[4][3].true),t.elements[6]>=s&&(n**=b.element6()),n},(e=!1)=>{let s=1,n=t.collapse.stars[1]*(1+t.strangeness[4][8]);e&&(s=.5,n+=o.collapseInfo.starCheck[1]*(1+t.strangeness[4][8]),t.elements[22]>=s&&(n+=o.collapseInfo.starCheck[0])),t.elements[22]>=s&&(n+=t.collapse.stars[0]);let a=(n+1)**(.5+t.strangeness[4][8]/8);if(t.elements[12]>=s){let i=b.element12();a*=et(n+i,i)}return a},(e=!1)=>{let s=1,n=t.collapse.stars[2];e&&(s=.5,n+=o.collapseInfo.starCheck[2]);let a=t.elements[18]>=s?3:2;return(n+1)/et(n+a,a)}],S4Research0:(e=t.researches[4][2])=>1.3+.15*e,S4Research1:(e=t.researches[4][1],s=t.researchesExtra[4][1])=>{let n=e>0?1+Math.min(e,4):0;return e>4&&(n+=.5),e>5&&(n+=Math.min(e-5,2)/4),e>7&&(n+=(e-7)/8),1+(s>=1?.006:.005)*n},S4Research4:(e=!1,s=t.researches[4][4])=>{if(s<1)return 1;let n=1,a=t.collapse.stars[2],i=t.collapse.mass;e&&(n=.5,t.strangeness[4][4]<2&&(a+=o.collapseInfo.starCheck[2]),o.collapseInfo.newMass>i&&(i=o.collapseInfo.newMass)),t.challenges.active===0&&(i**=.4);let c=s>=2?2:3,l=et(a+c,c);return t.elements[23]>=n&&(l*=i**.1),l},S4Extra1:()=>(10+t.researches[4][1])/10,S5Upgrade0:()=>{let e=12*2**t.strangeness[5][3];return t.challenges.active===0&&(e=e/128+6),e},S5Upgrade1:()=>{let e=4*3**t.strangeness[5][4];return t.challenges.active===0&&(e=e/1458+2),e},S5Upgrade2:()=>{let e=Math.log10(Math.max(t.collapse.mass/1e5,1))/4+.25;return t.inflation.vacuum||(e*=2),Math.min(e,1)},element6:()=>t.researchesExtra[4][2]>=1?2:1.5,element12:()=>10-t.strangeness[4][8],element24:()=>t.elements[28]===1?t.inflation.vacuum||t.milestones[1][1]>=6?.03:.015:.01,element26:()=>{if(!t.inflation.vacuum&&t.strange[0].total<1)return 0;let e=new p(t.buildings[4][0].trueTotal).log(10).toNumber()-48;return t.elements[29]===1&&(e=(199+e)*e/200),Math.max(Math.floor(e),0)},strangeGain:(e,s=0)=>{if(s===1&&e<4)return 0;let n=s===1?0:t.inflation.vacuum?t.strangeness[5][5]>=1?5:4:o.strangeInfo.instability+1;return e>=4&&(n=(n+b.element26())*(t.buildings[5][3].true+1),s===0&&(n*=2**t.strangeness[5][1]),t.inflation.vacuum&&t.strangeness[2][9]>=1&&(n*=b.S2Strange9())),Math.floor(n*b.strangeletsBuff())},strangeletsBuff:()=>t.strange[1].current**.4/80+1,strangeletsProd:()=>Math.log2(t.strange[1].current+2)/800*(t.history.stage.best[1]/t.history.stage.best[0]),S2Strange9:()=>new p(t.vaporization.clouds).plus("1").log(10).toNumber()/100+1},te=()=>{let{buildings:e,upgrades:s,researches:n,researchesExtra:a,elements:i,strangeness:c}=t,{dischargeInfo:l,collapseInfo:g}=o,d=o.buildingsInfo.producing,u=o.strangeInfo.stageBoost,m=o.stageInfo.activeAll,h=t.inflation.vacuum,S=t.challenges.active===0,C=Math.max(t.discharge.energy,1),w=s[2][3]===1?new p(e[2][0].current).max("1").power(b.S2Upgrade3()).toNumber():1,x=s[2][4]===1?new p(e[2][1].current).max("1").power(b.S2Upgrade4()).toNumber():1;if(m.includes(1)){let $=h?3:1,T=h?4:2,R=h?5:3;l.total=t.discharge.current+c[1][3]/2,l.base=b.dischargeBase();let A=2**c[1][0];s[1][5]===1&&(A*=l.base**l.total),c[1][6]>=1&&(A*=u[1]);let H=b.S1Upgrade7(),V=[e[1][R].current],q=.2*A;if(h&&s[1][4]===1&&(q*=5),s[1][7]===1&&V.push(new p(H).power(e[1][R].true)),d[1][R].setValue(q).multiply(...V),s[1][8]===1){let W=b.S1Research2()**n[1][2];s[1][9]===1&&(W*=C**(h?.5:1)),h?W*=b.S1Research5()**n[1][5]:n[1][5]>=1&&(W*=l.total**b.S1Research5()),l.tritium.setValue(d[1][R]).plus("1").log(b.S1Extra1()).multiply(W)}else l.tritium.setValue("0");let P=[e[1][T].current],ee=(h?.4:.6)*A;h?s[1][3]===1&&(ee*=5):s[1][4]===1&&(ee*=5),s[1][7]===1&&P.push(new p(H).power(e[1][T].true)),d[1][T].setValue(ee).multiply(...P);let Re=[e[1][$].current],ye=(h?.2:.4)*A;if(s[1][0]===1&&(ye*=5),!h&&s[1][3]===1&&(ye*=5),s[1][7]===1&&Re.push(new p(H).power(e[1][$].true)),d[1][$].setValue(ye).multiply(...Re),h){let W=[e[1][2].current];s[1][7]===1&&W.push(new p(H).power(e[1][2].true)),d[1][2].setValue(.3*A).multiply(...W);let y=[],D=new p(e[1][1].current).minus(e[1][1].true);D.moreThan("1")?y.push(D.power(.1).plus(e[1][1].true)):y.push(e[1][1].current),s[1][7]===1&&y.push(new p(H).power(e[1][1].true)),d[1][1].setValue(4e-4*A**.8).multiply(...y)}}if(m.includes(2)){let{vaporizationInfo:$}=o,T=b.S2Extra1_2(),R=1.4**c[2][7];$.strength=b.clouds(),e[2][6].true>0?d[2][6].setValue(s[2][8]===1?"1.1":"1.08").power(e[2][6].true).multiply(R):d[2][6].setValue("1"),d[2][5].setValue(2*T[1]*R).multiply(e[2][5].current,d[2][6]).max("1"),d[2][4].setValue(2*R).multiply(e[2][4].current,d[2][5]).max("1"),d[2][3].setValue(2*R).multiply(e[2][3].current,d[2][4]).max("1");let A=[e[2][2].current,d[2][3],$.strength],H=(S?.001:2)*w*x*T[0]*1.8**c[2][1];s[2][1]===1&&A.push(b.S2Upgrade1()),n[2][1]>=1&&($.research1!==n[2][1]&&($.research1=Math.min(n[2][1],Math.max(Math.floor(new p(e[2][1].total).divide("1e2").plus("1").log(5).toNumber()),0))),H*=2**$.research1),h&&(H*=b.S3Extra4()),c[2][6]>=1&&(H*=u[2]),d[2][2].setValue(H).multiply(...A);let V=new p(e[2][1].current);if(S)V.min(1);else if(h){let ee=new p(V).minus(e[2][1].true);ee.moreThan("1")&&V.setValue(ee.power(.2).plus(e[2][1].true))}let q=[V];s[2][0]===1&&q.push(new p(h?"1.02":"1.04").power(e[2][1].true));let P=(h?2:2e-4)*2**c[2][0];n[2][0]>=1&&($.research0!==n[2][0]&&($.research0=Math.min(n[2][0],Math.max(Math.floor(new p(e[2][1].total).divide("1e1").log(1.36).toNumber()+1),0))),P*=3**$.research0),d[2][1].setValue(P).multiply(...q)}else h&&d[2][1].setValue("1");if(m.includes(3)){let $=1.8**c[3][1];d[3][5].setValue("1.1").power(e[3][5].true),d[3][4].setValue(s[3][12]===1?"1.14":"1.1").power(e[3][4].true).multiply(d[3][5]);let T=c[3][3]<1?new p("1"):new p(d[3][4]).power(h?.2:.3),R=[e[3][3].current,d[3][4]],A=.2*$;a[3][2]>=1&&(A*=2),s[3][7]===1&&R.push(new p("1.02").power(e[3][3].true)),d[3][3].setValue(A).multiply(...R);let H=[e[3][2].current,T],V=3**n[3][2]*$;s[3][3]===1&&H.push(new p(b.S3Upgrade3()).power(e[3][2].true)),s[3][4]===1&&(V*=3),n[3][6]>=1&&H.push(new p(e[3][0].current).max("1").power(b.S3Research6())),d[3][2].setValue(V).multiply(...H);let q=[e[3][1].current,T],P=(h?2:8e-20)*3**n[3][0]*2**n[3][3]*3**n[3][5]*1.1**a[3][0]*2**c[3][0];h&&(P*=b.submersion()),s[3][0]===1&&q.push(new p(b.S3Upgrade0()).power(e[3][1].true)),s[3][1]===1&&(P*=new p(e[3][1].current).power(b.S3Upgrade1()).toNumber()),s[3][2]===1&&(P*=2),s[3][5]===1&&(P*=3),s[3][6]===1&&(P*=2*1.5**n[3][7]),s[3][9]===1&&(P*=2),s[3][10]===1&&(P*=8*2**n[3][8]),a[3][1]>=1&&(P*=b.S3Extra1()),d[3][1].setValue(P).multiply(...q),h?S?d[3][1].power(t.accretion.rank>=5?.8:.9):t.accretion.rank>=5&&d[3][1].power(.92):t.accretion.rank>=5&&d[3][1].power(d[3][1].lessThan("1")?1.1:.9)}else h&&d[3][1].setValue("1");if(m.includes(4)){g.massEffect=b.mass(),g.starEffect=[b.star[0](),b.star[1](),b.star[2]()];let $=[new p(b.S4Research1()).power(o.collapseInfo.trueStars)],T=b.S4Research0()**n[4][0]*g.massEffect*g.starEffect[1]*b.S4Research4()*1.8**c[4][0];i[4]===1&&(T*=1.2),i[14]===1&&(T*=1.4),i[19]===1&&(T*=2),i[24]===1&&(T*=new p(e[4][0].current).max("1").power(b.element24()).toNumber()),i[27]===1&&(T*=3),h&&(a[1][4]>=1&&(T*=b.S1Extra4()**l.total),a[2][3]>=1&&(T*=w),a[2][3]>=3?T*=x:a[2][3]>=2&&(T*=x**.5)),c[4][7]>=1&&(T*=u[4]);let R=new p(T).multiply(...$);d[4][5].setValue("1e11").multiply(e[4][5].current,R),d[4][4].setValue("2e9").multiply(e[4][4].current,R),d[4][3].setValue("3e7").multiply(e[4][3].current,R),d[4][2].setValue(400*g.starEffect[0]*2**n[4][3]).multiply(e[4][2].current,R);let A=50;i[1]===1&&(A*=2),d[4][1].setValue(A).multiply(e[4][1].current,R)}else g.starEffect[2]=1;if(m.includes(5)){let $=h?2:6;s[5][2]===1&&($+=b.S5Upgrade2()),d[5][3].setValue($).power(e[5][3].true);let T=[e[5][2].current,d[5][3]],R=1.5*2**n[5][1];s[5][1]===1&&(R*=b.S5Upgrade1()),d[5][2].setValue(R).multiply(...T).max("1");let A=[e[5][1].current,d[5][3]],H=3**n[5][0];s[5][0]===1&&(H*=b.S5Upgrade0()),d[5][1].setValue(H).multiply(...A),d[4][4].multiply(d[5][2]),n[5][1]>=1&&d[4][3].multiply(d[5][2]).divide("2"),n[5][1]>=2&&d[4][2].multiply(d[5][2]).divide("4"),n[5][1]>=3&&d[4][1].multiply(d[5][2]).divide("8")}if(h){let $=o.inflationInfo;$.preonTrue.setValue(d[1][1]),$.dustTrue.setValue(d[3][1].max("1")),l.tritium.multiply(d[2][1].max("1"));let T=1.4**c[3][8],R=Ot();$.dustCap.setValue(1e48*R*(S?1:T)),d[3][1].moreThan($.dustCap)&&d[3][1].setValue($.dustCap);let A=g.starEffect[2];i[10]===1&&(A*=2),a[4][1]>=1&&(A*=b.S4Extra1()),$.preonCap.setValue(1e14*C**b.S1Extra3()*A*(S?T:1)).multiply(d[3][1]),d[1][1].moreThan($.preonCap)&&d[1][1].setValue($.preonCap),$.massCap=.01235*R*A,c[5][7]>=1&&($.massCap*=u[5])}},de=(e,s=t.stage.active,n=null,a=!1)=>{if(!kt(e,s))return;let i=t.buildings[s][e],c,l,g=!1,d="";s===1?(c=t.buildings[1][e-1],e===1&&(g=t.researchesExtra[1][2]>=1&&t.strangeness[1][8]>=1)):s===2?e===1&&t.inflation.vacuum?(d="Moles",c=t.buildings[1][5],l=new p(c.current).divide("6.02214076e23")):c=t.buildings[2][e===1?0:1]:s===3?t.inflation.vacuum?(d="Mass",c=t.buildings[1][0],l=new p(c.current).multiply("1.78266192e-33")):c=t.buildings[3][0]:(c=t.buildings[4][0],s===5&&e===3&&(d="Galaxy",l=new p(t.collapse.mass))),l===void 0&&(l=new p(c.current));let u=new p(l);a&&i.true>0&&!g&&d!=="Galaxy"&&(d==="Mass"&&t.toggles.auto[3]&&t.strangeness[3][4]>=2&&o.inflationInfo.dustTrue.moreOrEqual(o.inflationInfo.dustCap)?u.minus(o.inflationInfo.massCap*198847e28):u.divide(t.stage.true>=3?t.toggles.shop.wait[s]:"2"));let m=Qe(e,s);if(m.moreThan(u))return;let h=1;if(n===null&&(n=o.hotkeys.shift?1:o.hotkeys.ctrl?10:t.toggles.shop.input),n!==1&&d!=="Galaxy"){let S=o.buildingsInfo.increase[s][e];if(g){if(h=Math.floor(u.divide(m).log(S).toNumber())+1,n>0){if(h<n)return;h=n}}else{if(h=Math.floor(u.multiply(S-1).divide(m).plus("1").log(S).toNumber()),n>0){if(h<n)return;h=n}h>1&&m.multiply(new p(S).power(h).minus("1").divide(S-1))}}i.true+=h,i.current.plus(h),i.total.plus(h),i.trueTotal.plus(h),i.highest.lessThan(i.current)&&i.highest.setValue(i.current),d==="Galaxy"?(Te("galaxy",t.inflation.vacuum?[1,2,3,4,5]:[4,5]),k(0,4,"researches"),k(1,4,"researches"),k(2,4,"researches"),!a&&v.SRSettings[0]&&(r("SRMain").textContent=`Caused Galaxy reset to gain ${f(h)} new 'Galaxies'`),be(5),X(1,5)):(g||(l.minus(m),d==="Moles"?(c.current=l.multiply("6.02214076e23"),t.buildings[2][0].current.setValue(c.current).divide("6.02214076e23")):d==="Mass"?(c.current=l.divide("1.78266192e-33"),t.buildings[3][0].current.setValue(c.current).multiply("1.78266192e-33")):c.current=l),(t.inflation.vacuum||s===1)&&(Bt(o.dischargeInfo.energyType[s][e]*h),X(1,1)),s===1?e===5&&t.upgrades[1][8]===0&&t.inflation.vacuum&&t.buildings[2][0].current.setValue(i.current).divide("6.02214076e23"):s===2?e!==1&&Oe():s===3?e>=4&&X(1,3):s===4&&(o.collapseInfo.trueStars+=h,X(0,5)),te(),a||(Q(),v.SRSettings[0]&&(r("SRMain").textContent=`Made ${f(h)} '${o.buildingsInfo.name[s][e]}'`)))},Bt=e=>{let{discharge:s}=t;o.dischargeInfo.energyTrue+=e,s.energy+=e,s.energyMax<s.energy&&(s.energyMax=s.energy)},Qe=(e,s)=>{let n=o.buildingsInfo,a=n.startCost[s][e];if(s===1){let i=140;t.upgrades[1][6]===1&&(i-=b.S1Upgrade6()),n.increase[1][e]=i/100,e===1?!t.inflation.vacuum&&t.upgrades[1][2]===1&&(a/=10):e===3?t.upgrades[1][1]===1&&(a/=10):e===4&&t.inflation.vacuum&&(t.upgrades[1][2]===1&&(a/=10),t.researchesExtra[1][0]>=1&&(a/=10))}else if(s===3)t.strangeness[3][7]>=1&&(a/=o.strangeInfo.stageBoost[3]),e===4&&(n.increase[3][4]=t.upgrades[3][11]===1?5:10);else if(s===4){let i=125+15*e;t.elements[2]===1&&(i-=10),t.elements[8]===1&&(i-=5),n.increase[4][e]=i/100,a/=2**t.strangeness[4][1],t.elements[13]===1&&(a/=1e3)}return new p(n.increase[s][e]).power(t.buildings[s][e].true).multiply(a)},Oe=(e=!1)=>{let s=t.buildings[2],n=t.upgrades[2],a=s[5].true,i=s[4].true,c=s[3].true,l=s[2].true;n[8]===1&&(a+=s[6].true),n[7]===1&&(i+=a),n[6]===1&&(c+=i*b.S2Upgrade6()),n[5]===1&&(l+=c*b.S2Upgrade5()),s[5].current.setValue(a),s[4].current.setValue(i),s[3].current.setValue(c),s[2].current.setValue(l),e||X(1,2)},xe=(e,s,n)=>{let a,i=s;if(s===1&&e===5?(a=new p(o.dischargeInfo.tritium).multiply(n),t.inflation.vacuum||(e=3)):s===5?(a=new p(o.buildingsInfo.producing[5][1]).multiply(n).divide(3**e),i=4,e++):(a=new p(o.buildingsInfo.producing[s][e+1]).multiply(n),s===4?e=0:s===2&&e===1&&t.buildings[2][2].current.lessOrEqual("0")&&t.researchesExtra[2][1]>=1&&a.plus(n*(b.S2Extra1_2()[0]-1))),a[0]===0)return;if(!a.isFinite()){o.debug.errorGain&&(o.debug.errorGain=!1,U(`Error while gaining ${a.toString()} '${o.buildingsInfo.name[i][e]}'`),setTimeout(()=>{o.debug.errorGain=!0},6e4));return}let c=t.buildings[i][e];c.current.plus(a),c.total.plus(a),c.trueTotal.plus(a),c.highest.lessThan(c.current)&&c.highest.setValue(c.current),s===1?t.inflation.vacuum?e===0?(t.buildings[3][0].current.setValue(c.current).multiply("1.78266192e-33"),X(0,3)):e===1?X(0,1):e===5&&t.buildings[2][0].current.setValue(c.current).divide("6.02214076e23"):e===0&&X(0,1):s===3&&e===0&&(t.accretion.rank<5&&c.current.moreThan("1e30")&&c.current.setValue("1e30"),X(0,3))},ie=()=>{let e=o.strangeInfo.stageBoost,s=t.strange[0].current+1;e[1]=s**.16,e[2]=s**.22,e[3]=s**.44,e[4]=s**.28,e[5]=s**.06},Nt=(e,s)=>{let n=t.strange[e],a=b.strangeletsProd()*s;n.current+=a,n.total+=a,ie()},J=(e,s,n,a=!1)=>{if(!a&&!ve(e,s,n))return!1;let i=!1,c;if(s===1?(c=new p(t.discharge.energy),i=t.accretion.rank>=6&&t.strangeness[1][9]>=1):s===2?c=new p(t.buildings[2][1].current):s===3?c=t.inflation.vacuum?new p(t.buildings[1][0].current).multiply("1.78266192e-33"):new p(t.buildings[3][0].current):c=new p(t.buildings[4][0].current),n==="upgrades"){if(t.upgrades[s][e]>=1)return!1;let l=o.upgradesInfo[s];if(c.lessThan(l.startCost[e]))return!1;t.upgrades[s][e]++,i||c.minus(l.startCost[e]),s===2?e>=5&&Oe():s===4&&e===1&&o.tab==="upgrade"&&j("upgrade"),!a&&v.SRSettings[0]&&(r("SRMain").textContent=`New upgrade '${l.name[e]}', has been created`)}else if(n==="researches"||n==="researchesExtra"){let l=o[`${n}Info`][s],g=t[n][s];if(g[e]>=l.max[e])return!1;let d=l.cost[e];if(c.lessThan(d))return!1;let u=1;if((a||t.toggles.max[0]&&t.stage.true>=2)&&l.max[e]>1){let m=l.scaling[e];if(s===1)if(i)u=Math.min(Math.floor((c.toNumber()-d)/m+1),l.max[e]-g[e]);else{let h=d-m/2;u=Math.min(Math.floor(((h**2+2*m*c.toNumber())**.5-h)/m),l.max[e]-g[e]),u>1&&(d=u*(u*m/2+h))}else u=Math.min(Math.floor(new p(c).multiply(m-1).divide(d).plus("1").log(m).toNumber()),l.max[e]-g[e]),u>1&&(d=new p(m).power(u).minus("1").divide(m-1).multiply(d).toNumber())}g[e]+=u,i||c.minus(d),n==="researches"?s===2?e>=4&&Oe():s===4&&(e===2||e===3)&&k(0,4,"researches",!0):n==="researchesExtra"&&(s===1?e===2&&(t.stage.current<4&&(t.stage.current=t.researchesExtra[1][2]>1?2:3),!o.stageInfo.activeAll.includes(3)&&v.toggles[2]?(re(3),F()):F("soft"),be(1)):s===4&&e===2&&(k(1,4,"researches",!0),Ce())),!a&&v.SRSettings[0]&&(r("SRMain").textContent=`Level increased ${g[e]>=l.max[e]?"and maxed at":"to"} ${f(g[e])} for '${l.name[e]}' ${n==="researches"?"Stage":["","Energy","Cloud","Rank","Collapse","Galaxy"][t.stage.active]} Research`)}else if(n==="researchesAuto"||n==="ASR"){n==="ASR"&&(e=s);let l=o[`${n}Info`],g=t[n];if(g[e]>=l.max[e])return!1;let d=l.costRange[e][g[e]];if(c.lessThan(d))return!1;g[e]++,i||c.minus(d),!a&&v.SRSettings[0]&&(r("SRMain").textContent=`Level increased ${g[e]>=l.max[e]?"and maxed at":"to"} ${f(g[e])} for '${n==="ASR"?l.name:l.name[e]}' automatization Research`)}else if(n==="elements"){let l=t.elements[e];if(l>=1)return!1;if(l===0){let g=o.elementsInfo.startCost[e];if(c.lessThan(g))return!1;c.minus(g)}else if(!a)return!1;l=t.strangeness[4][6]>=1||l===.5?1:.5,t.elements[e]=l,t.collapse.show<e&&(t.collapse.show=e),l===1&&(e===7||e===16||e===20||e===25?k(1,4,"researches",!0):e===9||e===17?k(0,4,"researches",!0):e===11?k(2,4,"researches",!0):e===26&&(t.stage.current=5,t.stage.true<5&&(t.stage.true=5,t.events[0]=!1),v.toggles[2]?(re(5),F()):F("soft"),be(5))),!a&&v.SRSettings[0]&&(r("SRMain").textContent=`New Element '${o.elementsInfo.name[e]}' ${t.elements[e]>=1?"obtained":"awaiting activation"}`)}if(s===1)i||(t.discharge.energy=c.toNumber());else if(s===2){if(t.buildings[2][1].current=c,t.buildings[2][2].current.lessOrEqual("0")&&t.buildings[2][1].current.lessThan(t.buildings[2][1].true)){let l=t.buildings[2][1].true;t.buildings[2][1].true=Math.floor(t.buildings[2][1].current.toNumber()),t.inflation.vacuum?Bt(-(l-t.buildings[2][1].true)*o.dischargeInfo.energyType[2][1]):t.buildings[2][1].current.lessOrEqual("0")&&t.buildings[2][0].current.lessThan("2.8e-3")&&t.buildings[2][0].current.setValue("2.8e-3")}}else s===3?t.inflation.vacuum?(t.buildings[1][0].current=c.divide("1.78266192e-33"),t.buildings[3][0].current.setValue(t.buildings[1][0].current).multiply("1.78266192e-33")):t.buildings[3][0].current=c:t.buildings[4][0].current=c;return te(),n==="upgrades"||n==="elements"?oe(e,s,n):(n!=="researchesAuto"&&n!=="ASR"&&Me(e,s,n),O(e,s,n)),a||Q(),!0},vt=(e,s,n,a=!1)=>{if(!a&&!ve(e,s,n))return!1;if(n==="strangeness"){let i=o.strangenessInfo[s];if(t.strangeness[s][e]>=i.max[e]||t.strange[0].current<o.strangenessInfo[s].cost[e])return!1;if(t.strangeness[s][e]++,t.strange[0].current-=i.cost[e],s===1)e===5?(t.ASR[1]=o.ASRInfo.max[1],O(0,1,"ASR")):e===7&&xt();else if(s===2)e===2?(k(4,2,"researches",!0),k(5,2,"researches",!0)):e===5?(t.ASR[2]=o.ASRInfo.max[2],O(0,2,"ASR")):e===8&&(k(2,2,"researches",!0),k(3,2,"researches",!0));else if(s===3)e===2?(k(0,3,"researchesExtra",!0),k(1,3,"researchesExtra",!0)):e===5?(t.ASR[3]=o.ASRInfo.max[3],O(0,3,"ASR")):e===6&&t.researchesAuto[0]<t.strangeness[3][6]&&(t.researchesAuto[0]=t.strangeness[3][6],O(0,0,"researchesAuto"));else if(s===4)if(e===5)t.ASR[4]=o.ASRInfo.max[4],O(0,4,"ASR");else if(e===6)for(let c=1;c<t.elements.length&&(c=t.elements.indexOf(.5,c),!(c<1));c++)J(c,4,"elements",!0);else e===8&&t.elements[0]<1&&(t.elements[0]=1,oe(0,4,"elements"));else s===5&&(e===0?!t.inflation.vacuum&&t.stage.current===t.strangeness[5][0]?(t.stage.current++,t.time.stage=0,t.stage.time=0,t.stage.peak=0,t.stage.active===t.stage.current-1&&(re(t.stage.current),F())):F("soft"):e===5?t.inflation.vacuum&&F("soft"):e===6&&(t.ASR[5]=2,O(0,5,"ASR")));ie(),!a&&v.SRSettings[0]&&(r("SRMain").textContent=`Level increased ${t.strangeness[s][e]>=i.max[e]?"and maxed at":"to"} ${f(t.strangeness[s][e])} for '${i.name[e]}' Strangeness from ${o.stageInfo.word[s]} section`)}return te(),Me(e,s,n),O(e,s,n),a||Q(),!0},Me=(e,s,n)=>{if(n==="researches"||n==="researchesExtra"){let a=o[`${n}Info`][s];a.cost[e]=s===1?a.startCost[e]+a.scaling[e]*t[n][s][e]:a.startCost[e]*a.scaling[e]**t[n][s][e]}else n==="strangeness"&&(o.strangenessInfo[s].cost[e]=t.inflation.vacuum?Math.floor(Math.round(o.strangenessInfo[s].startCost[e]*o.strangenessInfo[s].scaling[e]**t.strangeness[s][e]*100)/100):Math.floor(Math.round((o.strangenessInfo[s].startCost[e]+o.strangenessInfo[s].scaling[e]*t.strangeness[s][e])*100)/100))},k=(e,s,n,a=!1)=>{let i=null;n==="ASR"?s===1?i=t.inflation.vacuum?5:3:s===2?i=t.inflation.vacuum?6:5:s===3?i=t.inflation.vacuum?5:4:s===4?i=t.inflation.vacuum?5:4:s===5&&(i=t.stage.true>=6||t.milestones[5][0]>=8?3:2):n==="researches"?s===2?e===2?(i=4,t.strangeness[2][8]>=1&&(i+=3)):e===3?(i=4,t.strangeness[2][8]>=2&&i++):e===4?(i=2,t.strangeness[2][2]>=1&&i++):e===5&&(i=1,t.strangeness[2][2]>=2&&i++):s===4&&(e===0?(i=3+3*t.researches[4][2]+3*t.researches[4][3],t.elements[9]===1&&(i+=12),t.elements[17]===1&&(i+=24)):e===1?(i=2+t.researchesExtra[4][2],t.elements[7]===1&&(i+=2),t.elements[16]===1&&i++,t.elements[20]===1&&i++,t.elements[25]===1&&i++):e===2&&(i=1,t.elements[11]===1&&i++)):n==="researchesExtra"?s===3&&(e===0?(i=12,t.accretion.rank>=3&&(i+=17),t.strangeness[3][2]>=1&&(i+=9)):e===1?(i=5,t.strangeness[3][2]>=2&&(i+=3)):e===4&&(i=t.accretion.rank-2)):n==="strangeness"&&(s===1?e===0?i=6+Math.min(t.challenges.void[3],4):e===3?i=2+Math.min(Math.floor(t.challenges.void[3]/2),2):e===4&&(i=t.challenges.void[4]>=1?2:1):s===2?e===1?i=8+Math.min(t.challenges.void[3],4):e===3?i=2+Math.min(Math.floor(t.challenges.void[3]/2),2):e===4&&(i=t.challenges.void[4]>=1?2:1):s===3?e===0?i=8+Math.min(t.challenges.void[3],4):e===1?i=4+Math.min(Math.floor(t.challenges.void[3]/2),2):e===4&&(i=t.challenges.void[4]>=1?2:1):s===4?e===0?i=8+Math.min(t.challenges.void[3],4):e===1?i=4+Math.min(Math.floor(t.challenges.void[3]/2),2):e===4?i=t.challenges.void[4]>=1?2:1:e===6&&(i=t.inflation.vacuum||t.milestones[5][0]>=8?2:1):s===5&&(e===0?i=t.inflation.vacuum?1:3:e===1&&(i=1+Math.min(Math.floor(t.challenges.void[3]/2),2)))),i!==null&&(i<0&&(i=0),n==="ASR"?o.ASRInfo.max[s]=i:o[`${n}Info`][s].max[e]=i),n!=="ASR"&&Me(e,s,n),O(e,s,n),a&&(n==="researches"||n==="researchesExtra")&&se(n,[s,e])},me=e=>{if(!t.toggles.auto[5])return;let s=o.automatization.autoU,n=t.upgrades,a=o.upgradesInfo;if(e==="all")for(let i=1;i<=5;i++){s[i]=[];for(let l=0;l<a[i].maxActive;l++)n[i][l]<1&&s[i].push(l);let c=a[i].startCost;s[i].sort((l,g)=>c[l]-c[g])}else if(typeof e=="number"){s[e]=[];for(let c=0;c<a[e].maxActive;c++)n[e][c]<1&&s[e].push(c);let i=a[e].startCost;s[e].sort((c,l)=>i[c]-i[l])}},Pt=e=>{if(!t.toggles.auto[5]||t.researchesAuto[0]<1)return;let s=o.automatization.autoU[e];for(let n=0;n<s.length;n++){let a=s[n];if(ve(a,e,"upgrades"))if(J(a,e,"upgrades",!0),t.upgrades[e][a]>=1)s.splice(n,1),n--;else break}},se=(e,s)=>{if(!t.toggles.auto[e==="researches"?6:7])return;let n=o.automatization[e==="researches"?"autoR":"autoE"],a=t[e],i=o[`${e}Info`];if(s==="all")for(let c=1;c<=5;c++){n[c]=[];let{max:l,cost:g}=i[c];for(let d=0;d<i[c].maxActive;d++)a[c][d]<l[d]&&n[c].push(d);n[c].sort((d,u)=>g[d]-g[u])}else if(typeof s=="number"){n[s]=[];let{max:c,cost:l}=i[s];for(let g=0;g<i[s].maxActive;g++)a[s][g]<c[g]&&n[s].push(g);n[s].sort((g,d)=>l[g]-l[d])}else{let[c,l]=s;if(i[c].max[l]>a[c][l]){let{cost:g}=i[c],d;for(let u=0;u<n[c].length;u++){if(n[c][u]===l)return;d===void 0&&g[l]<g[n[c][u]]&&(d=u)}d!==void 0?n[c].splice(d,0,l):n[c].push(l)}}},dt=(e,s)=>{if(e==="researches"){if(!t.toggles.auto[6]||t.researchesAuto[0]<2)return}else if(!t.toggles.auto[7]||t.researchesAuto[0]<3)return;let n=o.automatization[e==="researches"?"autoR":"autoE"][s],a=o[`${e}Info`][s],i=!1;for(let c=0;c<n.length;c++){if(!ve(n[c],s,e))continue;let l=J(n[c],s,e,!0);if(t[e][s][n[c]]>=a.max[n[c]])n.splice(c,1),c--;else if(!l){if(a.cost[n[c]]>a.cost[n[c+1]]){i=!0;continue}break}}i&&n.sort((c,l)=>a.cost[c]-a.cost[l])},pe=()=>{if(!t.toggles.auto[8])return;let e=o.automatization.elements,s=o.elementsInfo.startCost,n=t.elements;for(let a=1;a<(t.inflation.vacuum?s.length:29);a++)n[a]===0&&e.push(a);e.sort((a,i)=>s[a]-s[i])},Ut=()=>{if(!t.toggles.auto[8]||t.strangeness[4][6]<2)return;let e=o.automatization.elements,s=t.elements;for(let n=0;n<e.length;n++){let a=e[n];if(!ve(a,4,"elements"))break;if(J(a,4,"elements",!0),s[a]===1)e.splice(n,1),n--;else break}},G=(e,s,n=!1)=>{let a=s==="buildings"?t.toggles.buildings[t.stage.active]:t.toggles[s];if(n)if(s==="buildings")if(e===0){a[0]=!a[0];for(let l=1;l<a.length;l++)a[l]=a[0],G(l,"buildings")}else{let l=t.buildings[t.stage.active];if(e>=l.length)return;let g=!1;a[e]=!a[e];for(let d=1;d<o.buildingsInfo.maxActive[t.stage.active];d++)if(a[d]&&l[d].highest.moreThan("0")){g=!0;break}a[0]!==g&&(a[0]=g,G(0,"buildings"))}else a[e]=!a[e];let i,c;s==="buildings"?(c=r(`toggleBuilding${e}`),i=e===0?"All ":"Auto "):s==="hover"?(c=r(`toggleHover${e}`),i="Hover to create "):s==="max"?(c=r(`toggleMax${e}`),i="Max create "):(c=r(`toggleAuto${e}`),i="Auto "),a[e]?(c.style.color="",c.style.borderColor="",c.textContent=`${i}ON`):(c.style.color="var(--red-text)",c.style.borderColor="crimson",c.textContent=`${i}OFF`)},tt=(e,s=!1)=>{let n=t.toggles.confirm;s&&(n[e]=n[e]==="All"?"Safe":n[e]==="Safe"?"None":"All");let a=r(`toggleConfirm${e}`);a.textContent=n[e],n[e]==="All"||n[e]==="Safe"?(a.style.color="",a.style.borderColor=""):(a.style.color="var(--red-text)",a.style.borderColor="crimson")},ge=(e,s=!1)=>{let n=!1;if(e>=5)n=t.elements[26]===1;else{if(e===4)return!1;e===3?n=t.buildings[3][0].current.moreOrEqual("2.45576045e31"):e===2?n=t.buildings[2][1].current.moreOrEqual("1.19444e29"):e===1&&(n=t.buildings[1][3].current.moreOrEqual("1.67133125e21"))}if(s&&n){if(t.strangeness[5][2]<1||e>=4&&(t.stage.input<=0||t.stage.input>b.strangeGain(e)))return!1;St(e)}return n},Ie=async()=>{let e=t.stage,s=t.inflation.vacuum||e.active>=4&&t.events[0]?5:e.active;if(ge(s)){if(t.toggles.confirm[0]!=="None"){let n=t.challenges.active;if(t.toggles.confirm[0]!=="Safe"||n!==-1){let a;if(s>=5?(a=`${t.inflation.vacuum?"Ready to reset progress":"Return back to Microworld"} for ${f(b.strangeGain(5))} Strange quarks${t.strangeness[5][8]>=1?` and ${f(b.strangeGain(5,1))} Strangelets`:""}?`,n!==-1&&(a+=`
(${o.challengesInfo.name[n]} is active)`)):e.true>=5?a=`${s===e.current?"Move to next Stage and gain":"Reset this Stage for"} ${f(b.strangeGain(s))} Strange quarks?`:a="Ready to enter next Stage? Next one will be harder than current",!await K(a))return;if(!ge(s))return U("Stage reset canceled, requirements are no longer met")}}St(s,v.SRSettings[0])}else{if(t.toggles.confirm[0]==="None"||e.true<2&&t.upgrades[1][9]<1)return;if(s>=5)return void N('Awaiting "[26] Iron" Element');if(s===4)return void N("Enter Intergalactic space first");if(s===3)return void N(`Self sustaining is not yet possible, obtain at least ${f(245576045e23)} Mass`);if(s===2)return void N(`Look's like more Mass expected, need even more Drops, around ${f(119444e24)} in total`);if(s===1)return void N(`Not enough to form a single Drop of water, need at least ${f(167133125e13)} Molecules`)}},St=(e,s=!1)=>{let{stage:n,time:a}=t,i=a.stage;n.resets++;let c="normal",l=t.inflation.vacuum?[1,2,3,4,5]:[e];if(t.inflation.vacuum?(re(1),a.stage=0,n.time=0,n.peak=0,n.current=1):e===n.current?(a.stage=0,n.time=0,n.peak=0,e<5?(n.current++,n.active===n.current-1?re(n.current):c="soft",n.current>n.true&&(n.true=n.current,t.events[0]=!1)):(n.current=1+t.strangeness[5][0],n.active===4&&n.current!==4||n.active===5?re(n.current):c="soft",l.unshift(4))):c=e===n.active?"soft":!1,n.true>=5){let{strange:g}=t,d=b.strangeGain(e),u=t.strangeness[5][8]>=1?b.strangeGain(e,1):0;if(g[0].current+=d,g[0].total+=d,g[1].current+=u,g[1].total+=u,d>a.export[1]&&(a.export[1]=d),u>a.export[2]&&(a.export[2]=u),ie(),e>=4){let m=o.historyStorage.stage,h=t.history.stage;m.unshift([i,d,u,0]),m.length>100&&(m.length=100),d/i>h.best[1]/h.best[0]&&(h.best=[i,d,u,0])}s&&(r("SRMain").textContent=`Caused Stage reset for ${f(d)} Strange quarks${t.strangeness[5][8]>=1?` and ${f(u)} Strangelets`:""}`)}else s&&(r("SRMain").textContent=`${o.stageInfo.word[n.true-1]} Stage ended, but new one started`);ht(l,c)},Xt=()=>{re(1),t.time.stage=0,t.stage.time=0,t.stage.peak=0,t.stage.current=1,ht([1,2,3,4,5])},he=e=>{if(o.stageInfo.activeAll.includes(e)){if(t.stage.active===e){o.trueActive!==e&&(o.trueActive=e,r(`${o.stageInfo.word[e]}Switch`).style.textDecoration="underline");return}e!==4&&e!==5&&(o.tab==="upgrade"&&o.subtab.upgradeCurrent==="Elements"||o.tab==="Elements")&&j("upgrade",o.tab==="upgrade"?"Upgrades":null),re(e),F()}},re=(e,s=e)=>{r(`${o.stageInfo.word[t.stage.active]}Switch`).style.textDecoration="",t.stage.active=e,o.trueActive=s,r(`${o.stageInfo.word[e]}Switch`).style.textDecoration="underline"+(o.trueActive!==e?" dashed":"")},wt=()=>(20-4*t.researches[1][3]-t.strangeness[1][2])/2,mt=()=>{o.dischargeInfo.next=Math.round(wt()**t.discharge.current)},Xe=()=>{if(!t.inflation.vacuum){o.dischargeInfo.energyType[1]=[0,1,5,20];return}let e=[[],[0,1,3,5,10,20],[0,20,30,40,50,60,100],[0,20,40,60,100,120],[0,80,160,240,320,400],[0,400,400,2e3]];for(let s=1;s<e.length;s++)for(let n=1;n<e[s].length;n++){let a=e[s][n];s===1?n===1&&(a+=t.strangeness[1][7]*2):t.challenges.active===0&&(a/=2),e[s][n]=a}o.dischargeInfo.energyType=e},xt=()=>{Xe();let{energyType:e}=o.dischargeInfo,s=0;for(let n=1;n<(t.inflation.vacuum?e.length:2);n++){let a=t.buildings[n];for(let i=1;i<e[n].length;i++)s+=e[n][i]*a[i].true}o.dischargeInfo.energyTrue=s},_e=(e=!1,s=!1)=>{if(t.upgrades[1][5]<1)return!1;mt();let n=o.dischargeInfo,a=t.discharge.energy;if(s){if(t.strangeness[1][4]>=2&&a>=n.next){if(bt(!0),!e)return!0}else if(!e)return!1}return e?t.strangeness[1][4]<1||a>=n.energyTrue&&(t.strangeness[1][4]>=2||a<n.next)?!1:(bt(),!0):a<n.energyTrue||a>=n.next},st=async()=>{if(!_e())return;let e=o.dischargeInfo,s=t.discharge.energy;if(t.toggles.confirm[1]!=="None"&&(t.toggles.confirm[1]!=="Safe"||t.stage.active!==1)){if(!await K(`Reset Structures and Energy to ${s>=e.next?"gain boost from a new goal":`regain ${f(e.energyTrue-s)} spent Energy`}?`))return;if(!_e())return U("Discharge canceled, requirements are no longer met")}v.SRSettings[0]&&(r("SRMain").textContent=`Caused Discharge to reset spent Energy${s>=e.next?", also reached new goal":""}`),bt()},bt=(e=!1)=>{t.discharge.energy>=o.dischargeInfo.next&&t.discharge.current++,be(1),e||Te("discharge",t.inflation.vacuum?[1,2,3,4,5]:[1])},Ee=()=>{let e=new p(t.buildings[2][1][t.researchesExtra[2][0]>=1?"total":"current"]).divide(b.S2Upgrade2());if(e.moreOrEqual("1")){let s=t.challenges.active===0?.4:t.inflation.vacuum?.5:.6;o.vaporizationInfo.get.setValue(t.vaporization.clouds).power(1/s).plus(e).power(s).minus(t.vaporization.clouds)}else o.vaporizationInfo.get.setValue("0")},Ke=(e=!1,s=null)=>{Ee();let n=o.vaporizationInfo;if(t.upgrades[2][2]<1||n.get.lessOrEqual("0"))return!1;if(s!==null){if(t.strangeness[2][4]>=2){if(yt(s),!e)return!0;if(Ee(),n.get.lessOrEqual("0"))return!1}else if(!e)return!1}if(e){if(t.strangeness[2][4]<1||t.vaporization.clouds.moreOrEqual(t.vaporization.input[1])&&t.vaporization.input[1]>0)return!1;let a=b.S2Extra1_2(!0),i=b.S2Extra1_2();if(b.clouds(!0).divide(n.strength).multiply(a[0]/i[0]*(a[1]/i[1])).lessThan(t.vaporization.input[0]))return!1;yt()}return!0},nt=async()=>{if(!Ke())return;let e=o.vaporizationInfo,s=t.vaporization.clouds.moreThan("0")?new p(e.get).divide(t.vaporization.clouds).multiply("1e2"):100;if(t.toggles.confirm[2]!=="None"){let n=b.S2Extra1_2(!0),a=b.S2Extra1_2();if(t.toggles.confirm[2]!=="Safe"||t.stage.active!==2||t.strangeness[2][4]>=2||b.clouds(!0).divide(e.strength).multiply(n[0]/a[0]*(n[1]/a[1])).lessThan("2")){if(!await K(`Reset Structures and Upgrades for ${f(e.get)} (+${f(s)}%) Clouds?`))return;if(!Ke())return U("Vaporization canceled, requirements are no longer met")}}v.SRSettings[0]&&(r("SRMain").textContent=`Caused Vaporization for ${f(e.get)} Clouds, +${f(s)}%`),yt()},yt=(e=null)=>{let s=t.vaporization;e!==null?s.clouds.plus(new p(o.vaporizationInfo.get).multiply(e/40)):s.clouds.plus(o.vaporizationInfo.get),s.cloudsMax.lessThan(s.clouds)&&s.cloudsMax.setValue(s.clouds),X(0,2),be(2),e===null&&Te("vaporization",t.inflation.vacuum?[1,2,3,4,5]:[2])},ke=()=>{t.inflation.vacuum?o.accretionInfo.maxRank=6:o.accretionInfo.maxRank=t.stage.true>=4||t.stage.true===3&&t.events[0]?5:4},je=(e=!1)=>{let s=t.accretion.rank;if(s>=o.accretionInfo.maxRank)return!1;if(t.inflation.vacuum){if(new p(t.buildings[1][0].current).multiply("1.78266192e-33").lessThan(o.accretionInfo.rankCost[s]))return!1}else if(t.buildings[3][0].current.lessThan(o.accretionInfo.rankCost[s]))return!1;if(e){if(t.strangeness[3][4]<1)return!1;Ht()}return!0},rt=async()=>{if(je()){if(t.toggles.confirm[3]!=="None"&&t.accretion.rank!==0&&(t.toggles.confirm[3]!=="Safe"||t.stage.active!==3)){if(!await K("Reset Structures, Upgrades and Stage Researches to increase current Rank?"))return;if(!je())return U("Rank increase canceled, requirements are no longer met")}Ht(),v.SRSettings[0]&&(r("SRMain").textContent=`Rank increased to '${o.accretionInfo.rankName[t.accretion.rank]}' (Rank number is ${t.accretion.rank})`)}},Ht=()=>{t.accretion.rank++,t.accretion.rank===6&&(t.stage.current=4,v.toggles[2]?(re(4),F()):F("soft")),be(3),Te("rank",t.inflation.vacuum?[1,2,3,4,5]:[3]),k(0,3,"researchesExtra",!0),k(4,3,"researchesExtra",!0)},Ot=()=>{let e=t.elements,s=.004;return e[3]===1&&(s+=.002),e[5]===1&&(s+=2e-4*t.buildings[4][1].true),s*=e[15]===1?o.collapseInfo.trueStars:t.buildings[4][1].true,t.inflation.vacuum?s=s*(t.challenges.active===0?60:96)+1:(e[10]===1&&(s*=2),t.researchesExtra[4][1]>=1&&(s*=b.S4Extra1()),s*=o.collapseInfo.starEffect[2],t.strangeness[5][7]>=1&&(s*=o.strangeInfo.stageBoost[5])),s},Le=()=>{o.collapseInfo.newMass=t.inflation.vacuum?Math.min(new p(t.buildings[1][0].current).multiply("8.96499278339628e-67").toNumber(),o.inflationInfo.massCap):Ot()},Pe=()=>{let e=t.buildings[4],s=o.collapseInfo.starCheck,n=t.collapse.stars;s[0]=e[2].trueTotal.moreThan("0")?Math.max(e[2].true+Math.floor(e[1].true*t.strangeness[4][3]/10)-n[0],0):0,s[1]=Math.max(e[3].true-n[1],0),s[2]=Math.max(e[4].true-n[2],0)},Je=(e=!1,s=!1)=>{if(t.upgrades[4][0]<1)return!1;Pe();let n=o.collapseInfo;if(s){if(t.strangeness[4][4]>=2&&(n.starCheck[0]>0||n.starCheck[1]>0||n.starCheck[2]>0)){if(Ze(!0),!e)return!0;Pe()}else if(!e)return!1}if(Le(),e){if(t.strangeness[4][4]<1||t.inflation.vacuum&&t.collapse.input[1]&&new p(t.buildings[1][0].current).multiply("8.96499278339628e-67").toNumber()<o.inflationInfo.massCap&&t.collapse.mass<n.newMass)return!1;let a=b.mass(!0)/n.massEffect*(b.S4Research4(!0)/b.S4Research4());return a>=t.collapse.input[0]?(Ze(),!0):t.strangeness[4][4]>=2||a*(b.star[0](!0)/n.starEffect[0])*(b.star[1](!0)/n.starEffect[1])*(b.star[2](!0)/n.starEffect[2])<t.collapse.input[0]?!1:(Ze(),!0)}return n.newMass>t.collapse.mass||t.strangeness[4][4]<2&&(n.starCheck[0]>0||n.starCheck[1]>0||n.starCheck[2]>0)||t.elements.includes(.5,1)},De=async()=>{if(!Je())return;let{newMass:e,starCheck:s}=o.collapseInfo,n=t.collapse.mass,a=0;for(let i=1;i<t.elements.length&&(i=t.elements.indexOf(.5,i),!(i<1));i++)a++;if(t.toggles.confirm[4]!=="None"){let i=t.researchesExtra[5][0]>=1,c=Qe(3,5).moreThan(e),l=t.inflation.vacuum&&new p(t.buildings[1][0].current).multiply("8.96499278339628e-67").toNumber()<o.inflationInfo.massCap;if(t.toggles.confirm[4]!=="Safe"||t.stage.active!==4&&t.stage.active!==5||e>n&&l&&(!i||c)){let g="This will reset all special and Stage Researches, Upgrades and Structures";if(e>n?(g+=`
Solar mass will increase to ${f(e)}`,l&&(g+=`
(Hardcap is not reached)`),i&&c&&(g+=`
(Not enough for a new Galaxy)`)):g+=`
Solar mass won't change`,(s[0]>0||s[1]>0||s[2]>0)&&(g+=`
Also will gain new Star remnants:`,s[0]>0&&(g+=`
'Red giants' - ${f(s[0])}`),s[1]>0&&(g+=`
'Neutron stars' - ${f(s[1])}`),s[2]>0&&(g+=`
'Black holes' - ${f(s[2])}`)),a>0&&(g+=`
${f(a)} new Elements will activate`),!await K(g+`
Continue?`))return;if(!Je())return U("Collapse canceled, requirements are no longer met")}}if(v.SRSettings[0]){let i=`Caused Collapse to${a>0?` activate ${f(a)} new Elements and`:""} ${e>n?`increase Solar mass to ${f(e)}`:""}`;(s[0]>0||s[1]>0||s[2]>0)&&(i+=e>n?", also gained":"gain",s[0]>0&&(i+=` ${f(s[0])} Red giants`),s[1]>0&&(i+=`, ${f(s[1])} Neutron stars`),s[2]>0&&(i+=`, ${f(s[2])} Black holes`)),r("SRMain").textContent=i}Ze()},Ze=(e=!1)=>{let s=o.collapseInfo,n=t.collapse;if(n.stars[0]+=s.starCheck[0],n.stars[1]+=s.starCheck[1],n.stars[2]+=s.starCheck[2],X(1,4),!e){for(let a=1;a<t.elements.length&&(a=t.elements.indexOf(.5,a),!(a<1));a++)J(a,4,"elements",!0);s.newMass>n.mass&&(n.mass=s.newMass,n.massMax<n.mass&&(n.massMax=n.mass)),X(0,4),Te("collapse",t.inflation.vacuum?[1,2,3,4,5]:t.strangeness[5][5]<1?[4,5]:[4]),k(0,4,"researches")}be(4)},Et=()=>{let e=t.milestones,s=0;e[1][0]>=6&&s++,e[2][1]>=7&&s++,e[3][1]>=7&&s++,e[4][1]>=8&&s++,e[5][1]>=8&&s++,o.strangeInfo.instability=s},He=(e,s)=>{let{need:n,reward:a}=o.milestonesInfo[s],i=t.milestones[s][e];if(t.inflation.vacuum)s===1?e===0?(n[0].setValue("1e80").power(i).multiply("1e80"),a[0]=1.04**i):e===1&&(n[1].setValue(4e4+4e4*i),a[1]=2*i):s===2?e===0?(n[0].setValue("1e1").power(i).multiply("1e1"),a[0]=1.02**i):e===1&&(n[1].setValue(80+(80+8*i)*i),a[1]=1.04**i):s===3?e===0?(n[0].setValue("1e3").power(i).multiply("1e-15"),a[0]=1.03**i):e===1&&(n[1].setValue(4+4*i),a[1]=i/400):s===4?e===0?(n[0].setValue("1e4").power(i).multiply("1e4"),a[0]=1.05**i):e===1&&(n[1].setValue(40+40*i),a[1]=1.03**i):s===5&&(e===0?(n[0].setValue(160+160*i),a[0]=1.14**i):e===1&&(n[1].setValue(1+2*i),a[1]=i/40));else{let c=o.milestonesInfo[s].scalingOld[e];n[e].setValue(i<c.length?c[i]:"0")}},X=(e,s,n=0)=>{if(!It(e,s)){n>0&&(U(`Milestone '${o.milestonesInfo[s].name[e]}' ${n>1?`${f(n)} new tiers`:"new tier"} reached
Total is now: ${f(t.milestones[s][e])}`),t.inflation.vacuum||(s===5&&e===0&&t.milestones[5][0]>=8&&(k(6,4,"strangeness",!0),k(0,5,"ASR",!0)),t.strange[0].current+=n,t.strange[0].total+=n,Et(),ie()),o.lastMilestone[1]===s&&o.lastMilestone[0]===e&&Be(e,s,"milestones"));return}t.milestones[s][e]++,He(e,s),X(e,s,n+1)},be=e=>{if(t.challenges.active!==0)return;let s=t.challenges.void[e],n=1;if(e===1?n+=t.researchesExtra[1][2]:e===2?t.vaporization.clouds.moreThan("1e4")&&n++:e===3?n=Math.min(t.accretion.rank-1,5):e===4?(t.collapse.stars[0]>1&&n++,t.collapse.stars[1]>1&&n++,t.collapse.stars[2]>1&&n++):e===5&&t.buildings[5][3].true>=1&&n++,!(s>=n)){t.challenges.void[e]=n;for(let a=s;a<n;a++)U(`New Void reward achieved
Reward: ${o.challengesInfo.rewardText[0][e][a]}`);e===3?(k(0,1,"strangeness",!0),k(3,1,"strangeness",!0),k(1,2,"strangeness",!0),k(3,2,"strangeness",!0),k(0,3,"strangeness",!0),k(1,3,"strangeness",!0),k(0,4,"strangeness",!0),k(1,4,"strangeness",!0),k(1,5,"strangeness",!0)):e===4&&(k(4,1,"strangeness",!0),k(4,2,"strangeness",!0),k(4,3,"strangeness",!0),k(4,4,"strangeness",!0)),o.lastChallenge[0]===0&&($e(0),o.lastChallenge[1]===e&&We(e))}},Dt=async e=>{let s=e;if(t.challenges.active===e){if(!await K(`Leave the '${o.challengesInfo.name[e]}'?`))return;e=-1}else if(!t.inflation.vacuum||e===0&&t.strangeness[5][0]<1||!await K(`Enter the '${o.challengesInfo.name[e]}'?`))return;let n=ge(5);t.challenges.active=e,n?St(5):Xt(),s===0&&Xe(),$e(s),v.SRSettings[0]&&(r("SRMain").textContent=e===-1?`You left the '${o.challengesInfo.name[s]}'`:`'${o.challengesInfo.name[e]}' is now active`)};var v={intervals:{main:20,numbers:80,visual:1e3,autoSave:2e4},toggles:[!1,!1,!1],format:[".",""],theme:null,fontSize:16,MDSettings:[!1,!1],SRSettings:[!1,!1,!1],developerMode:!1},ae=()=>localStorage.setItem("fundamentalSettings",btoa(JSON.stringify(v))),le=(e,s,n=!1,a=!1)=>{let i;if(s==="mobile"?i=v.MDSettings:s==="reader"?i=v.SRSettings:i=v.toggles,n){if(a)return void(async()=>{if(await K(`Changing this setting will reload game, confirm?
(Game will not autosave)`))return o.paused=!0,Y(),i[e]=!i[e],ae(),window.location.reload(),void N("Awaiting game reload")})();i[e]=!i[e],ae()}let c;s==="mobile"?c=r(`MDToggle${e}`):s==="reader"?c=r(`SRToggle${e}`):c=r(`toggleNormal${e}`),i[e]?(c.style.color="var(--red-text)",c.style.borderColor="crimson",c.textContent="ON"):(c.style.color="",c.style.borderColor="",c.textContent="OFF")},M={resetHTML:["","Discharge","Vaporization","Rank","Collapse","Merge"],longestBuilding:7,buildingHTML:[[],["Preon.png","Quarks.png","Particle.png","Atom.png","Molecule.png"],["Drop.png","Puddle.png","Pond.png","Lake.png","Sea.png","Ocean.png"],["Cosmic%20dust.png","Planetesimal.png","Protoplanet.png","Natural%20satellite.png","Subsatellite.png"],["Brown%20dwarf.png","Orange%20dwarf.png","Red%20supergiant.png","Blue%20hypergiant.png","Quasi%20star.png"],["Nebula.png","Star%20cluster.png","Galaxy.png"]],longestUpgrade:13,upgradeHTML:[[],["UpgradeQ1.png","UpgradeQ2.png","UpgradeQ3.png","UpgradeQ4.png","UpgradeQ5.png","UpgradeQ6.png","UpgradeQ7.png","UpgradeQ8.png","UpgradeQ9.png","UpgradeQ10.png"],["UpgradeW1.png","UpgradeW2.png","UpgradeW3.png","UpgradeW4.png","UpgradeW5.png","UpgradeW6.png","UpgradeW7.png","UpgradeW8.png","UpgradeW9.png"],["UpgradeA1.png","UpgradeA2.png","UpgradeA3.png","UpgradeA4.png","UpgradeA5.png","UpgradeA6.png","UpgradeA7.png","UpgradeA8.png","UpgradeA9.png","UpgradeA10.png","UpgradeA11.png","UpgradeA12.png","UpgradeA13.png"],["UpgradeS1.png","UpgradeS2.png","UpgradeS3.png","UpgradeS4.png","UpgradeS5.png"],["UpgradeG1.png","UpgradeG2.png","UpgradeG3.png"]],longestResearch:9,researchHTML:[[],[["ResearchQ1.png","stage1borderImage"],["ResearchQ2.png","stage1borderImage"],["ResearchQ3.png","stage1borderImage"],["ResearchQ4.png","stage4borderImage"],["ResearchQ5.png","stage4borderImage"],["ResearchQ6.png","stage4borderImage"]],[["ResearchW1.png","stage2borderImage"],["ResearchW2.png","stage2borderImage"],["ResearchW3.png","stage2borderImage"],["ResearchW4.png","stage2borderImage"],["ResearchW5.png","stage2borderImage"],["ResearchW6.png","stage2borderImage"]],[["ResearchA1.png","stage3borderImage"],["ResearchA2.png","stage2borderImage"],["ResearchA3.png","stage3borderImage"],["ResearchA4.png","stage3borderImage"],["ResearchA5.png","stage3borderImage"],["ResearchA6.png","stage3borderImage"],["ResearchA7.png","stage1borderImage"],["ResearchA8.png","stage7borderImage"],["ResearchA9.png","stage1borderImage"]],[["ResearchS1.png","stage5borderImage"],["ResearchS2.png","stage5borderImage"],["ResearchS3.png","stage7borderImage"],["ResearchS4.png","stage5borderImage"],["ResearchS5.png","stage6borderImage"]],[["ResearchG1.png","stage1borderImage"],["ResearchG2.png","stage6borderImage"]]],longestResearchExtra:5,researchExtraDivHTML:[[],["Energy%20Researches.png","stage4borderImage"],["Cloud%20Researches.png","stage2borderImage"],["Rank%20Researches.png","stage6borderImage"],["Collapse%20Researches.png","stage6borderImage"],["Missing.png","stage7borderImage"]],researchExtraHTML:[[],[["ResearchEnergy1.png","stage1borderImage"],["ResearchEnergy2.png","stage5borderImage"],["ResearchEnergy3.png","stage3borderImage"],["ResearchEnergy4.png","stage1borderImage"],["ResearchEnergy5.png","stage6borderImage"]],[["ResearchClouds1.png","stage3borderImage"],["ResearchClouds2.png","stage2borderImage"],["ResearchClouds3.png","stage4borderImage"],["ResearchClouds4.png","stage2borderImage"]],[["ResearchRank1.png","stage3borderImage"],["ResearchRank2.png","stage3borderImage"],["ResearchRank3.png","stage3borderImage"],["ResearchRank4.png","stage2borderImage"],["ResearchRank5.png","stage2borderImage"]],[["ResearchCollapse1.png","stage6borderImage"],["ResearchCollapse2.png","stage7borderImage"],["ResearchCollapse3.png","stage1borderImage"]],[["ResearchGalaxy1.png","stage3borderImage"]]],longestFooterStats:3,footerStatsHTML:[[],[["Energy%20mass.png","stage1borderImage cyanText","Mass"],["Energy.png","stage4borderImage orangeText","Energy"]],[["Clouds.png","stage3borderImage grayText","Clouds"],["Water.png","stage2borderImage blueText","Moles"],["Drop.png","stage2borderImage blueText","Drops"]],[["Mass.png","stage3borderImage grayText","Mass"]],[["Main_sequence%20mass.png","stage1borderImage cyanText","Mass"],["Elements.png","stage4borderImage orangeText","Elements"]],[["Main_sequence%20mass.png","stage1borderImage cyanText","Mass"],["Elements.png","stage4borderImage orangeText","Elements"],["Stars.png","stage7borderImage redText","Stars"]]],cache:{imagesDiv:document.createElement("div"),idMap:new Map,classMap:new Map,queryMap:new Map},notifications:[],styleSheet:document.createElement("style")},Vt=()=>{let{footerStatsHTML:e,buildingHTML:s,upgradeHTML:n,researchHTML:a,researchExtraHTML:i,researchExtraDivHTML:c}=M,l='<img src="Used_art/Red%20giant" loading="lazy"><img src="Used_art/White%20dwarf" loading="lazy">';for(let g=1;g<=5;g++){for(let d=0;d<e[g].length;d++){if(g===2){if(d===2)continue}else if(g===5&&d<2)continue;l+=`<img src="Used_art/${e[g][d][0]}" loading="lazy">`}for(let d=0;d<s[g].length;d++)l+=`<img src="Used_art/${s[g][d]}" loading="lazy">`;for(let d=0;d<n[g].length;d++)l+=`<img src="Used_art/${n[g][d]}" loading="lazy">`;for(let d=0;d<a[g].length;d++)l+=`<img src="Used_art/${a[g][d][0]}" loading="lazy">`;for(let d=0;d<i[g].length;d++)l+=`<img src="Used_art/${i[g][d][0]}" loading="lazy">`;c[g].length>0&&(l+=`<img src="Used_art/${c[g][0]}" loading="lazy">`),l+=`<img src="Used_art/Stage${g}%20border.png" loading="lazy">`}M.cache.imagesDiv.innerHTML=l},at=(e,s=!1)=>{e!==null&&(t.stage.true<e&&(e=null),e===6&&t.stage.true<7&&(e=null),s&&e!==null)||(v.theme=e,ae(),pt())},pt=()=>{let e=document.body.style,s=v.theme??t.stage.active;r("currentTheme").textContent=v.theme===null?"Default":o.stageInfo.word[s];let n="",a="";switch(e.setProperty("--transition-all","1s"),e.setProperty("--transition-buttons","700ms"),e.removeProperty("--background-color"),e.removeProperty("--window-color"),e.removeProperty("--window-border"),e.removeProperty("--footer-color"),e.removeProperty("--button-color"),e.removeProperty("--button-border"),e.removeProperty("--button-hover"),e.removeProperty("--building-afford"),e.removeProperty("--tab-active"),e.removeProperty("--tab-elements"),e.removeProperty("--tab-strangeness"),e.removeProperty("--hollow-hover"),e.removeProperty("--footerButton-hover"),e.removeProperty("--input-border"),e.removeProperty("--input-text"),e.removeProperty("--button-text"),e.removeProperty("--main-text"),e.removeProperty("--white-text"),e.removeProperty("--blue-text"),e.removeProperty("--orange-text"),e.removeProperty("--gray-text"),e.removeProperty("--orchid-text"),e.removeProperty("--darkorchid-text"),e.removeProperty("--darkviolet-text"),e.removeProperty("--red-text"),e.removeProperty("--green-text"),e.removeProperty("--yellow-text"),s){case 1:for(let i of["upgrade","element"])r(`${i}Text`).style.color="",r(`${i}Effect`).style.color="",r(`${i}Cost`).style.color="";break;case 2:for(let i of["upgrade","element"])r(`${i}Text`).style.color="var(--white-text)",r(`${i}Effect`).style.color="var(--green-text)",r(`${i}Cost`).style.color="var(--cyan-text)";e.setProperty("--background-color","#070026"),e.setProperty("--window-color","#000052"),e.setProperty("--window-border","blue"),e.setProperty("--footer-color","#0000db"),e.setProperty("--button-color","#0000eb"),e.setProperty("--button-border","#386cc7"),e.setProperty("--button-hover","#2929ff"),e.setProperty("--building-afford","#b30000"),e.setProperty("--tab-active","#990000"),e.setProperty("--hollow-hover","#2400d7"),e.setProperty("--input-border","#4747ff"),e.setProperty("--input-text","dodgerblue"),e.setProperty("--main-text","var(--blue-text)"),e.setProperty("--gray-text","#9b9b9b"),e.setProperty("--darkorchid-text","#c71bff"),e.setProperty("--darkviolet-text","#8b6bff"),e.setProperty("--green-text","#82cb3b"),e.setProperty("--red-text","#f70000"),t.stage.active===2&&(n="#3099ff",a="#3099ff");break;case 3:for(let i of["upgrade","element"])r(`${i}Text`).style.color="var(--orange-text)",r(`${i}Effect`).style.color="",r(`${i}Cost`).style.color="var(--green-text)";e.setProperty("--background-color","#000804"),e.setProperty("--window-color","#2e1200"),e.setProperty("--window-border","#31373e"),e.setProperty("--footer-color","#221a00"),e.setProperty("--button-color","#291344"),e.setProperty("--button-border","#424242"),e.setProperty("--button-hover","#382055"),e.setProperty("--building-afford","#9e0000"),e.setProperty("--tab-active","#8d4c00"),e.setProperty("--tab-elements","var(--tab-active)"),e.setProperty("--hollow-hover","#5a2100"),e.setProperty("--footerButton-hover","#1a1a1a"),e.setProperty("--input-border","#8b4a00"),e.setProperty("--input-text","#e77e00"),e.setProperty("--main-text","var(--gray-text)"),e.setProperty("--white-text","#dfdfdf"),e.setProperty("--orange-text","#f58600"),e.setProperty("--green-text","#00db00"),t.stage.active===2&&(n="#3099ff",a="#3099ff");break;case 4:for(let i of["upgrade","element"])r(`${i}Text`).style.color="var(--blue-text)",r(`${i}Effect`).style.color="var(--green-text)",r(`${i}Cost`).style.color="var(--cyan-text)";e.setProperty("--background-color","#140e04"),e.setProperty("--window-color","#4e0000"),e.setProperty("--window-border","#894800"),e.setProperty("--footer-color","#4e0505"),e.setProperty("--button-color","#6a3700"),e.setProperty("--button-border","#a35700"),e.setProperty("--button-hover","#8a4700"),e.setProperty("--building-afford","#007f95"),e.setProperty("--tab-active","#008297"),e.setProperty("--tab-elements","var(--tab-active)"),e.setProperty("--tab-strangeness","#00a500"),e.setProperty("--hollow-hover","#605100"),e.setProperty("--footerButton-hover","#212121"),e.setProperty("--input-border","#008399"),e.setProperty("--input-text","#05c3c3"),e.setProperty("--button-text","#d9d900"),e.setProperty("--main-text","var(--orange-text)"),e.setProperty("--white-text","#e5e500"),e.setProperty("--blue-text","#2e96ff"),e.setProperty("--gray-text","#8b8b8b"),e.setProperty("--darkorchid-text","#c71bff"),e.setProperty("--darkviolet-text","#9457ff"),e.setProperty("--red-text","red"),e.setProperty("--green-text","#00e600"),e.setProperty("--yellow-text","var(--green-text)");break;case 5:for(let i of["upgrade","element"])r(`${i}Text`).style.color="var(--orange-text)",r(`${i}Effect`).style.color="var(--green-text)",r(`${i}Cost`).style.color="var(--red-text)";e.setProperty("--background-color","#060010"),e.setProperty("--window-color","#001d42"),e.setProperty("--window-border","#35466e"),e.setProperty("--footer-color","#2f005c"),e.setProperty("--button-color","#4a008f"),e.setProperty("--button-border","#8f004c"),e.setProperty("--button-hover","#6800d6"),e.setProperty("--building-afford","#8603ff"),e.setProperty("--tab-active","#8500ff"),e.setProperty("--hollow-hover","#3b0080"),e.setProperty("--footerButton-hover","#1a1a1a"),e.setProperty("--input-border","#3656a1"),e.setProperty("--input-text","#6a88cd"),e.setProperty("--button-text","#fc9cfc"),e.setProperty("--main-text","var(--darkorchid-text)"),e.setProperty("--white-text","#ff79ff"),e.setProperty("--orchid-text","#ff00f4"),e.setProperty("--darkorchid-text","#c000ff"),e.setProperty("--darkviolet-text","#9f52ff"),e.setProperty("--yellow-text","var(--darkviolet-text)");break;case 6:for(let i of["upgrade","element"])r(`${i}Text`).style.color="var(--orchid-text)",r(`${i}Effect`).style.color="var(--red-text)",r(`${i}Cost`).style.color="";e.setProperty("--background-color","black"),e.setProperty("--window-color","#01003c"),e.setProperty("--window-border","#7100ff"),e.setProperty("--footer-color","#00007a"),e.setProperty("--button-color","#2b0095"),e.setProperty("--button-border","#6c1ad1"),e.setProperty("--button-hover","#3d00d6"),e.setProperty("--building-afford","#b30000"),e.setProperty("--tab-active","#8d0000"),e.setProperty("--hollow-hover","#490070"),e.setProperty("--input-border","#a50000"),e.setProperty("--input-text","red"),e.setProperty("--button-text","#efe0ff"),e.setProperty("--main-text","var(--darkviolet-text)"),e.setProperty("--gray-text","#9b9b9b"),e.setProperty("--darkviolet-text","#8157ff"),e.setProperty("--white-text","#f9f5ff"),e.setProperty("--red-text","red"),e.setProperty("--yellow-text","var(--red-text)")}z("#footerStat2 > p").style.color=n,z("#footerStat3 > p").style.color=a,setTimeout(()=>{e.removeProperty("--transition-all"),e.removeProperty("--transition-buttons")},1e3)},N=async e=>await new Promise(s=>{let n=r("blocker");if(n.style.display!=="none"){s(),U(`Another Alert is already active${v.developerMode?`, type: 'Alert'
Text: ${e}`:""}`);return}r("alertText").textContent=e;let a=document.body,i=r("alertConfirm");n.style.display="",i.focus();let c=async g=>{(g.key==="Escape"||g.key==="Enter"||g.key===" ")&&(g.preventDefault(),l())},l=()=>{n.style.display="none",a.removeEventListener("keydown",c),i.removeEventListener("click",l),s()};a.addEventListener("keydown",c),i.addEventListener("click",l)}),K=async e=>await new Promise(s=>{let n=r("blocker");if(n.style.display!=="none"){s(!1),U(`Another Alert is already active${v.developerMode?`, type: 'Confirm'
Text: ${e}`:""}`);return}r("alertText").textContent=e;let a=document.body,i=r("alertCancel"),c=r("alertConfirm");n.style.display="",i.style.display="",c.focus();let l=()=>{u(!0)},g=()=>{u(!1)},d=m=>{if(m.key==="Escape")m.preventDefault(),g();else if(m.key==="Enter"||m.key===" "){if(document.activeElement===i)return;m.preventDefault(),l()}},u=m=>{n.style.display="none",i.style.display="none",a.removeEventListener("keydown",d),c.removeEventListener("click",l),i.removeEventListener("click",g),s(m)};a.addEventListener("keydown",d),c.addEventListener("click",l),i.addEventListener("click",g)}),ot=async(e,s="")=>await new Promise(n=>{let a=r("blocker");if(a.style.display!=="none"){n(null),U(`Another Alert is already active${v.developerMode?`, type: 'Prompt'
Text: ${e}`:""}`);return}r("alertText").textContent=e;let i=document.body,c=r("alertInput"),l=r("alertCancel"),g=r("alertConfirm");a.style.display="",l.style.display="",c.style.display="",c.placeholder=s,c.value="",c.focus();let d=()=>{h(c.value===""?c.placeholder:c.value)},u=()=>{h(null)},m=S=>{if(S.key==="Escape")S.preventDefault(),u();else if(document.activeElement!==l){if(S.key==="Enter")S.preventDefault(),d();else if(S.key===" "){if(document.activeElement===c)return;S.preventDefault(),d()}}},h=S=>{a.style.display="none",l.style.display="none",c.style.display="none",i.removeEventListener("keydown",m),g.removeEventListener("click",d),l.removeEventListener("click",u),n(S)};i.addEventListener("keydown",m),g.addEventListener("click",d),l.addEventListener("click",u)}),U=e=>{let{notifications:s}=M,n;for(let a=0;a<s.length;a++)if(s[a][0]===e){n=a;break}if(n===void 0){let a=1,i,c=document.createElement("p");c.textContent=e,c.style.animation="hideX 800ms ease-in-out reverse",c.style.pointerEvents="none",v.SRSettings[0]&&c.setAttribute("role","alert"),r("notifications").append(c);let l=s[s.push([e,()=>{c.textContent=`${e} | x${++a}`,clearTimeout(i),i=setTimeout(g,7200)}])-1],g=()=>{s.splice(s.indexOf(l),1),c.removeEventListener("click",g),c.style.animation="hideX 800ms ease-in-out forwards",c.style.pointerEvents="none",setTimeout(()=>c.remove(),800),clearTimeout(i)};setTimeout(()=>{c.style.animation="",c.style.pointerEvents="",i=setTimeout(g,7200),c.addEventListener("click",g)},800)}else s[n][1]()},it=()=>{let e=r("hideToggle").dataset;if(e.disabled==="true")return;let s=r("footer"),n=r("footerMain"),a=r("hideArrow"),i=()=>{s.style.animation="",a.style.animation="",e.disabled=""};o.footer=!o.footer,e.disabled="true",o.footer?(n.style.display="",a.style.transform="",s.style.animation="hideY 800ms reverse",a.style.animation="rotate 800ms reverse",r("hideText").textContent="Hide",r("stageSelect").classList.add("active"),setTimeout(i,800),Q(),ne()):(s.style.animation="hideY 800ms backwards",a.style.animation="rotate 800ms backwards",r("hideText").textContent="Show",r("stageSelect").classList.remove("active"),setTimeout(()=>{n.style.display="none",a.style.transform="rotate(180deg)",i()},800))},$t=e=>{let s=r("customFontSize"),n=Math.min(Math.max(e?v.fontSize:s.value===""?16:Math.floor(Number(s.value)*100)/100,12),24);e||(v.fontSize=n,ae()),document.documentElement.style.fontSize=n===16?"":`${n}px`,s.value=`${n}`,zt(e)},zt=e=>{let s=r("primaryRules").sheet;if(s==null){if(e){U("Failed to adjust CSS, will retry after its loading is finished"),r("primaryRules").addEventListener("load",()=>{U(`Trying to adjust CSS again
(Ignore it if no more notifications about it afterwards)`),zt(!1)});return}return U(`Failed to adjust CSS due to style sheet being ${s}`)}let n=s.cssRules.length-1,a=v.fontSize/16,i=s.cssRules[n-1],c=s.cssRules[n];s.deleteRule(n),s.deleteRule(n-1),s.insertRule(i.cssText.replace(i.conditionText,`screen and (max-width: ${893*a+32}px)`),n-1),s.insertRule(c.cssText.replace(c.conditionText,`screen and (max-width: ${362*a+32}px)`),n)},Ct=e=>{let s=e?r("decimalPoint"):r("thousandSeparator");(![".","\xB7",","," ","_","'",'"',"`","|"].includes(s.value)||v.format[e?1:0]===s.value)&&(e&&v.format[1]==="."&&(r("thousandSeparator").value="",v.format[1]=""),s.value=e?".":""),v.format[e?0:1]=s.value,ae()},Ye=e=>{for(let s=1;s<=5;s++)r(`strangenessSection${s}`).style.display="none";r(`strangenessSection${e}`).style.display=""},Ft=async()=>{if(r("blocker").style.display!=="none")return;let e;if(t.stage.true>=6)e=6;else if(e=t.stage.true-(t.events[0]?0:1),e<1)return void N("There are no unlocked events");let s=`Which event do you want to see again?
Event 1: Discharge requirement`;e>=2&&(s+=`
Event 2: Clouds softcap`),e>=3&&(s+=`
Event 3: New Rank`),e>=4&&(s+=`
Event 4: Element activation`),e>=5&&(s+=`
Event 5: Intergalactic space`),e>=6&&(s+=`
Event 6: True Vacuum`);let n=Number(await ot(s,`${e}`));n>e||ue(n,-1)},ue=async(e,s)=>{if(r("blocker").style.display==="none")switch(s>=0&&(t.events[s]=!0),e){case 1:return void N("Spent Energy can be regained only with Discharge, reaching new goal isn't required");case 2:return void N("Cloud density is too high... Strength of new Clouds will be weaker");case 3:return s>=0&&(o.debug.rankUpdated=-1,ke()),void N("Accretion can't continue without a new Rank. Next Rank is going to be softcapped");case 4:return void N("Elements require Collapse to be activated. Solar mass won't decrease from Collapse");case 5:return void N("Intergalactic space is currently empty, but completing different Milestones from previous Stages will allow creation of new Structures");case 6:return await N("Vacuum is too unstable. Vacuum instability is imminent"),void N("False Vacuum decayed, new Forces and Structures are expected")}};var p=class e extends Array{constructor(s){let n=L.convert(s);super(n[0],n[1])}get mantissa(){return this[0]}get exponent(){return this[1]}clone(){return new e(this)}setValue(s){return this.#e(L.convert(s))}#e(s){return this[0]=s[0],this[1]=s[1],this}plus(...s){let n=this;for(let a=0;a<s.length;a++)n=L.add(n,L.convert(s[a]));return this.#e(n)}minus(...s){let n=this;for(let a=0;a<s.length;a++)n=L.sub(n,L.convert(s[a]));return this.#e(n)}multiply(...s){let n=this;for(let a=0;a<s.length;a++)n=L.mult(n,L.convert(s[a]));return this.#e(n)}divide(...s){let n=this;for(let a=0;a<s.length;a++)n=L.div(n,L.convert(s[a]));return this.#e(n)}power(s){return this.#e(L.pow(this,s))}log(s=2.718281828459045){return this.#e(L.log(this,s))}abs(){return this[0]=Math.abs(this[0]),this}trunc(){return this.#e(L.trunc(this))}floor(){return this.#e(L.floor(this))}ceil(){return this.#e(L.ceil(this))}round(){return this.#e(L.round(this))}isNaN(){return isNaN(this[0])}isFinite(){return isFinite(this[0])}lessThan(s){return L.less(this,L.convert(s))}lessOrEqual(s){return L.lessOrEqual(this,L.convert(s))}moreThan(s){return L.more(this,L.convert(s))}moreOrEqual(s){return L.moreOrEqual(this,L.convert(s))}notEqual(s){return L.notEqual(this,L.convert(s))}allEqual(...s){let n=this;for(let a=0;a<s.length;a++){let i=L.convert(s[a]);if(L.notEqual(n,i))return!1;n=i}return!0}max(...s){let n=this;for(let a=0;a<s.length;a++){let i=L.convert(s[a]);if(isNaN(i[0]))return this.#e([NaN,NaN]);L.less(n,i)&&(n=i)}return this.#e(n)}min(...s){let n=this;for(let a=0;a<s.length;a++){let i=L.convert(s[a]);if(isNaN(i[0]))return this.#e([NaN,NaN]);L.more(n,i)&&(n=i)}return this.#e(n)}format(s={}){return L.format(this,s)}toNumber(){return Number(L.turnString(this))}toString(){return L.turnString(this)}},L={convert:e=>{if(typeof e=="object"&&e!==null)return e;typeof e!="string"&&(e=`${e}`);let s=e.indexOf("e"),n=s===-1?[Number(e),0]:[Number(e.slice(0,s)),Number(e.slice(s+1))];if(!isFinite(n[0])||!isFinite(n[1]))return n[0]===0||n[1]===-1/0?[0,0]:isNaN(n[0])||isNaN(n[1])?[NaN,NaN]:[n[0]<0?-1/0:1/0,1/0];let a=Math.abs(n[0]);if(a===0)return[0,0];if(a<1||a>=10){let i=Math.floor(Math.log10(a));n[0]/=10**i,n[1]+=i,Math.abs(n[0])<1&&(n[0]*=10,n[1]--)}return n[0]=Math.round(n[0]*1e14)/1e14,Math.abs(n[0])===10&&(n[0]/=10,n[1]++),n},turnString:e=>e[1]===0||!isFinite(e[0])?`${e[0]}`:`${e[0]}e${e[1]}`,add:(e,s)=>{if(s[0]===0)return e;if(e[0]===0)return[s[0],s[1]];if(!isFinite(e[0])||!isFinite(s[0])){let i=e[0]+s[0];return isNaN(i)?[NaN,NaN]:[i,1/0]}let n=e[1]-s[1];if(Math.abs(n)>15)return n>0?e:[s[0],s[1]];n===0?e[0]+=s[0]:n>0?e[0]+=s[0]/10**n:(e[0]=s[0]+e[0]*10**n,e[1]=s[1]);let a=Math.abs(e[0]);if(a===0)return[0,0];if(a>=10)e[0]/=10,e[1]++;else if(a<1){let i=-Math.floor(Math.log10(a));e[0]*=10**i,e[1]-=i}return e[0]=Math.round(e[0]*1e14)/1e14,Math.abs(e[0])===10&&(e[0]/=10,e[1]++),e},sub:(e,s)=>L.add(e,[-s[0],s[1]]),mult:(e,s)=>e[0]===0||s[0]===0?[0,0]:(e[1]+=s[1],e[0]*=s[0],isFinite(e[1])?(Math.abs(e[0])>=10&&(e[0]/=10,e[1]++),e[0]=Math.round(e[0]*1e14)/1e14,Math.abs(e[0])===10&&(e[0]/=10,e[1]++),e):e[1]===-1/0?[0,0]:isNaN(e[1])?[NaN,NaN]:[1/0,1/0]),div:(e,s)=>s[0]===0?[NaN,NaN]:e[0]===0?[0,0]:(e[1]-=s[1],e[0]/=s[0],isFinite(e[1])?(Math.abs(e[0])<1&&(e[0]*=10,e[1]--),e[0]=Math.round(e[0]*1e14)/1e14,Math.abs(e[0])===10&&(e[0]/=10,e[1]++),e):e[1]===-1/0?[0,0]:isNaN(e[1])?[NaN,NaN]:[1/0,1/0]),pow:(e,s)=>{if(s===0)return e[0]===0||isNaN(e[0])?[NaN,NaN]:[1,0];if(e[0]===0)return s<0?[NaN,NaN]:[0,0];if(!isFinite(s))return e[1]===0&&e[0]===1||e[0]<0?e[0]===1?[1,0]:[NaN,NaN]:s===-1/0&&e[1]>=0||s===1/0&&e[1]<0?[0,0]:isNaN(s)||isNaN(e[0])?[NaN,NaN]:[1/0,1/0];let n=e[0]<0?Math.abs(s)%2:null;if(n!==null){if(Math.floor(s)!==s)return[NaN,NaN];e[0]*=-1}let a=s*(Math.log10(e[0])+e[1]);if(!isFinite(a))return a===-1/0?[0,0]:isNaN(e[0])?[NaN,NaN]:[n===1?-1/0:1/0,1/0];let i=Math.floor(a);return e[0]=10**(a-i),e[1]=i,e[0]=Math.round(e[0]*1e14)/1e14,e[0]===10&&(e[0]=1,e[1]++),n===1&&(e[0]*=-1),e},log:(e,s)=>{if(Math.abs(s)===1||e[0]===-1&&e[1]===0)return[NaN,NaN];if(e[0]===1&&e[1]===0)return[0,0];if(s===0)return[NaN,NaN];if(e[0]===0)return isNaN(s)?[NaN,NaN]:[Math.abs(s)>1?-1/0:1/0,1/0];if(!isFinite(s))return[NaN,NaN];if(!isFinite(e[0]))return isNaN(e[0])||e[0]===-1/0?[NaN,NaN]:[Math.abs(s)<1?-1/0:1/0,1/0];let n=e[0]<0;if(n){if(s>0)return[NaN,NaN];e[0]*=-1}let a=e[1]<0,i=Math.log10(Math.abs(Math.log10(e[0])+e[1])),c=Math.floor(i);if(e[0]=10**(i-c),e[1]=c,a&&(e[0]*=-1),s!==10){e[0]/=Math.log10(Math.abs(s));let l=Math.abs(e[0]);if(l<1||l>=10){let g=Math.floor(Math.log10(l));e[0]/=10**g,e[1]+=g}}if(s<0||n){if(e[1]<0)return[NaN,NaN];let l=e[1]<16?Math.abs(Math.round(e[0]*1e14)/10**(14-e[1]))%2:0;if(s<0&&!n){if(l!==0)return[NaN,NaN]}else if(l!==1)return[NaN,NaN]}return e[0]=Math.round(e[0]*1e14)/1e14,Math.abs(e[0])===10&&(e[0]/=10,e[1]++),e},less:(e,s)=>e[0]===0||s[0]===0||e[1]===s[1]?e[0]<s[0]:e[0]>0&&s[0]>0?e[1]<s[1]:e[0]<0&&s[0]>0?!0:s[0]<0&&e[0]>0?!1:e[1]>s[1],lessOrEqual:(e,s)=>e[0]===0||s[0]===0||e[1]===s[1]?e[0]<=s[0]:e[0]>0&&s[0]>0?e[1]<s[1]:e[0]<0&&s[0]>0?!0:s[0]<0&&e[0]>0?!1:e[1]>s[1],more:(e,s)=>e[0]===0||s[0]===0||e[1]===s[1]?e[0]>s[0]:e[0]>0&&s[0]>0?e[1]>s[1]:e[0]<0&&s[0]>0?!1:s[0]<0&&e[0]>0?!0:e[1]<s[1],moreOrEqual:(e,s)=>e[0]===0||s[0]===0||e[1]===s[1]?e[0]>=s[0]:e[0]>0&&s[0]>0?e[1]>s[1]:e[0]<0&&s[0]>0?!1:s[0]<0&&e[0]>0?!0:e[1]<s[1],notEqual:(e,s)=>e[1]!==s[1]||e[0]!==s[0],trunc:e=>e[1]<0?[0,0]:(e[1]===0?e[0]=Math.trunc(e[0]):e[1]<=14&&(e[0]=Math.trunc(e[0]*10**e[1])/10**e[1]),e),floor:e=>e[1]<0?[e[0]<0?-1:0,0]:(e[1]===0?e[0]=Math.floor(e[0]):e[1]<=14&&(e[0]=Math.floor(e[0]*10**e[1])/10**e[1]),e[0]===-10&&(e[0]=-1,e[1]++),e),ceil:e=>e[1]<0?[e[0]<0?0:1,0]:(e[1]===0?e[0]=Math.ceil(e[0]):e[1]<=14&&(e[0]=Math.ceil(e[0]*10**e[1])/10**e[1]),e[0]===10&&(e[0]=1,e[1]++),e),round:e=>e[1]<0?[e[1]===-1?Math.round(e[0]/10):0,0]:(e[1]===0?e[0]=Math.round(e[0]):e[1]<=14&&(e[0]=Math.round(e[0]*10**e[1])/10**e[1]),Math.abs(e[0])===10&&(e[0]/=10,e[1]++),e),format:(e,s)=>{let[n,a]=e;if(!isFinite(n))return`${n}`;if(a>=1e4||a<=-1e4){let g=s.digits??2,d=a,u=Math.round(n*10**g)/10**g;Math.abs(u)===10&&(u/=10,d++),d=Math.floor(Math.log10(Math.abs(d)));let m=Math.round(a/10**(d-g))/10**g;Math.abs(m)===10&&(m/=10,d++);let h=s.padding?m.toFixed(g):`${m}`;if(s.type!=="input")return m=Math.abs(m),n<0&&(m*=-1),`${h.replace(".",v.format[0])}e${a<0?"-":""}e${d}`;let S=s.padding?u.toFixed(g):`${u}`;return s.type==="input"?`${S}e${h}e${d}`:`${S.replace(".",v.format[0])}e${h.replace(".",v.format[0])}e${d}`}if(a>=6||a<-3){let g=s.digits??2,d=a,u=Math.round(n*10**g)/10**g;Math.abs(u)===10&&(u/=10,d++);let m=s.padding?u.toFixed(g):`${u}`;return s.type==="input"?`${m}e${d}`:`${m.replace(".",v.format[0])}e${d}`}let i=s.digits??Math.max(4-Math.max(a,0),0),c=Math.round(n*10**(i+a))/10**i,l=s.padding?c.toFixed(i):`${c}`;return s.type==="input"?l:c>=1e3?l.replace(".",v.format[0]).replace(/\B(?=(\d{3})+(?!\d))/,v.format[1]):l.replace(".",v.format[0])}};var t={version:"v0.2.0",fileName:"Fundamental, [dateD.M.Y] [timeH-M-S], [stage]",stage:{true:1,current:1,active:1,resets:0,time:0,peak:0,input:0},discharge:{energy:0,energyMax:0,current:0},vaporization:{clouds:new p("0"),cloudsMax:new p("0"),input:[3,0]},accretion:{rank:0},collapse:{mass:.01235,massMax:.01235,stars:[0,0,0],show:0,input:[2,!1]},inflation:{vacuum:!1,age:0},time:{updated:Date.now(),started:Date.now(),offline:0,export:[0,0,0,0],online:0,stage:0,universe:0},buildings:[[],[{current:new p("3"),total:new p("3"),trueTotal:new p("3"),highest:new p("3")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")}],[{current:new p("2.8e-3"),total:new p("2.8e-3"),trueTotal:new p("2.8e-3"),highest:new p("2.8e-3")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")}],[{current:new p("1e-19"),total:new p("1e-19"),trueTotal:new p("1e-19"),highest:new p("1e-19")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")}],[{current:new p("1"),total:new p("1"),trueTotal:new p("1"),highest:new p("1")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")}],[{current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")},{true:0,current:new p("0"),total:new p("0"),trueTotal:new p("0"),highest:new p("0")}]],strange:[{current:0,total:0},{current:0,total:0}],upgrades:[],researches:[],researchesExtra:[],researchesAuto:[],ASR:[],elements:[],strangeness:[],milestones:[],challenges:{active:-1,void:[0,0,0,0,0,0]},toggles:{confirm:[],buildings:[],hover:[],max:[],auto:[],shop:{input:1,wait:[2]}},history:{stage:{best:[1,0,0,0],list:[],input:[5,10]}},events:[!1,!1]},o={tab:"stage",subtab:{stageCurrent:"Structures",settingsCurrent:"Settings",upgradeCurrent:"Upgrades",strangenessCurrent:"Matter"},tabList:{tabs:["stage","upgrade","strangeness","settings"],stageSubtabs:["Structures","Advanced"],settingsSubtabs:["Settings","History","Stats"],upgradeSubtabs:["Upgrades","Elements"],strangenessSubtabs:["Matter","Milestones"]},debug:{errorID:!0,errorQuery:!0,errorGain:!0,rankUpdated:-1,historyStage:-1},trueActive:1,lastSave:0,paused:!0,footer:!0,hotkeys:{shift:!1,ctrl:!1},automatization:{autoU:[[],[],[],[],[],[]],autoR:[[],[],[],[],[],[]],autoE:[[],[],[],[],[],[]],elements:[]},dischargeInfo:{energyType:[[]],energyTrue:0,tritium:new p("0"),base:4,total:0,next:1},vaporizationInfo:{strength:new p("1"),research0:0,research1:0,get:new p("0")},accretionInfo:{unlockA:[2,4,8,11],rankU:[1,1,2,2,3,3,4,4,4,4,5,5,5],rankR:[1,1,2,2,3,3,3,4,5],rankE:[2,3,4,5,3],maxRank:4,rankCost:[59722e23,1e-7,1e10,1e24,5e29,245576045e23],rankColor:["blue","cyan","gray","gray","gray","darkviolet","orange"],rankName:["Ocean world","Cosmic dust","Meteoroid","Asteroid","Planet","Jovian planet","Protostar"],rankImage:["Ocean%20world.png","Dust.png","Meteoroids.png","Asteroid.png","Planet.png","Giant.png","Protostar.png"]},collapseInfo:{massEffect:1,starEffect:[1,1,1],unlockB:[0,.01235,.23,10,40,1e3],unlockU:[.01235,.076,1.3,10,40],unlockR:[.18,.3,.8,1.3],newMass:0,starCheck:[0,0,0],trueStars:0},inflationInfo:{globalSpeed:1,preonCap:new p("1e14"),dustCap:new p("1e48"),massCap:.01235,preonTrue:new p("0"),dustTrue:new p("0")},intervalsId:{main:void 0,numbers:void 0,visual:void 0,autoSave:void 0,mouseRepeat:void 0},stageInfo:{word:["","Microworld","Submerged","Accretion","Interstellar","Intergalactic","Void"],textColor:["","cyan","blue","gray","orange","darkorchid","darkviolet"],buttonBorder:["","darkcyan","#386cc7","#424242","#a35700","#8f004c","#6c1ad1"],imageBorderColor:["","#008b8b","#1460a8","#5b5b75","#e87400","#b324e2","#5300c1"],activeAll:[1]},buildingsInfo:{maxActive:[0,4,6,5,5,4],name:[[],["Mass","Preons","Quarks","Particles","Atoms","Molecules"],["Moles","Drops","Puddles","Ponds","Lakes","Seas","Oceans"],["Mass","Cosmic dust","Planetesimals","Protoplanets","Satellites","Subsatellites"],["Elements","Brown dwarfs","Main sequence","Red supergiants","Blue hypergiants","Quasi stars"],["Stars","Nebulas","Star clusters","Galaxies"]],hoverText:[[],["Mass","Preons","Quarks","Particles","Atoms"],["Tritium","Drops","Puddles","Ponds","Lakes","Seas"],["Preons hardcap","Cosmic dust","Planetesimals","Protoplanets","Satellites"],["Elements","Elements","Elements","Elements","Elements"],["Interstellar Stars","Interstellar Stars","Nebulas and Star clusters"]],type:[[],["","producing","producing","producing","producing","producing"],["","producing","producing","improving","improving","improving","improving"],["","producing","producing","producing","improving","improving"],["","producing","producing","producing","producing","producing"],["","producing","improving","improving"]],startCost:[[],[0,.005476,6,3,24,3],[0,.0028,100,1e7,1e18,1e23,2676e22],[0,1e-19,1e-9,1e21,1e17,1e22],[0,1,1e5,1e15,1e28,1e51],[0,1e50,1e54,1e5]],increase:[[],[0,1.4,1.4,1.4,1.4,1.4],[0,1.15,1.2,1.25,1.35,1.4,4],[0,1.15,1.25,1.35,10,10],[0,1.4,1.55,1.7,1.85,2],[0,4,4,1.11]],producing:[]},strangeInfo:{name:["Strange quarks","Strangelets"],stageBoost:[1,1,1,1,1,1],instability:0},upgradesInfo:[{},{name:["Weak force","Strong force","Bigger electrons","Stronger protons","More neutrons","Superposition","Protium","Deuterium","Tritium","Nuclear fusion"],effectText:[()=>"Particles will produce 5 times more Quarks.",()=>"Gluons will now bind Quarks into Particles, which will make Particles 10 times cheaper.",()=>`${t.inflation.vacuum?"Atoms":"Particles"} will be 10 times cheaper.`,()=>`${t.inflation.vacuum?"Atoms":"Particles"} will produce 5 times more ${t.inflation.vacuum?"Particles":"Quarks"}.`,()=>`${t.inflation.vacuum?"Molecules":"Atoms"} will produce 5 times more ${t.inflation.vacuum?"Atoms":"Particles"}.`,()=>`Ability to regain spent Energy and if had enough Energy will also boost production for all Structures by ${f(o.dischargeInfo.base)}.`,()=>`Decrease Structures cost scaling by -${f(b.S1Upgrade6()/100)}.`,()=>`Make self-made Structures boost themselves by ${f(b.S1Upgrade7())}.`,()=>"Molecules will produce Molecules. At a reduced rate.",()=>`Unspent Energy${t.inflation.vacuum?` ^${f(.5)}`:""} will boost 'Tritium' production of Molecules${t.inflation.vacuum?"":" 1 to 1"}.
(Boost: ${f(Math.max(t.discharge.energy,1)**(t.inflation.vacuum?.5:1),{padding:!0})})`],startCost:[40,60,120,140,200,400,2e3,4e3,16e3,84e3],maxActive:10},{name:["Molecules to Moles","Water spread","Vaporization","Surface tension","Surface stress","Stream","River","Tsunami","Tide"],effectText:[()=>`Drops will ${t.inflation.vacuum?"improve Tritium":"produce Moles"} ${f(t.inflation.vacuum?1.02:1.04)} times ${t.inflation.vacuum?"more":"faster"} for every self-made Drop.`,()=>`Spread water faster with every Puddle, weaker for non self-made ones.
(Total effect: ${f(b.S2Upgrade1(),{padding:!0})})`,()=>`Gain ability to convert Drops into Clouds. (Boost after Vaporization can be seen in Stats subtab)
Current Cloud gain is (Drops / ${f(b.S2Upgrade2())}) ^${f(t.challenges.active===0?.4:t.inflation.vacuum?.5:.6)}.`,()=>{let e=b.S2Upgrade3();return`Puddles will get a boost based on Moles ^${f(e)}.
(Boost: ${f(new p(t.buildings[2][0].current).max("1").power(e),{padding:!0})})`},()=>{let e=b.S2Upgrade4();return`Puddles will get a boost based on Drops ^${f(e)}.
(Boost: ${f(new p(t.buildings[2][1].current).max("1").power(e),{padding:!0})})`},()=>`Ponds will now create extra Puddles. (${f(b.S2Upgrade5())} extra Puddles per Pond)`,()=>`Lakes will now create extra Ponds. (${f(b.S2Upgrade6())} extra Ponds per Lake)`,()=>"Spreads enough water to make each Sea create 1 extra Lake.",()=>`Spreads water too fast. 1 extra Sea per Ocean.
Also will improve Oceans effect scaling.`],startCost:[10,1e6,1e10,1e3,1e4,2e9,5e20,1e30,4e48],maxActive:8},{name:["Brownian motion","Gas","Micrometeoroid","Streaming instability","Gravitational field","Rubble pile","Magma ocean","Hydrostatic equilibrium","Satellite system","Atmosphere","Pebble accretion","Tidal force","Ring system"],effectText:[()=>`Through random collisions every self-made Cosmic dust will ${t.inflation.vacuum?"delay Preons hardcap even more":"produce even more Mass"}.
(By ${f(b.S3Upgrade0())} per self-made Cosmic dust)`,()=>{let e=b.S3Upgrade1();return`New substance for Accretion, will provide boost to Cosmic dust based on its current quantity ^${f(e)}.
(Boost: ${f(new p(t.buildings[3][1].current).power(e),{padding:!0})})`},()=>`Just a small meteoroid, but it will be a good base for what to come.
(Unlock a new Structure and get 2x boost to Cosmic dust)`,()=>`Small bodies will spontaneously concentrate into clumps.
(Self-made Planetesimals will boost each other by ${f(b.S3Upgrade3())})`,()=>`Bodies will now be massive enough to affect each other with gravity.
(Unlock a new Structure and get 3x boost to Planetesimals)`,()=>`Shattered pieces will fall back together. ${t.inflation.vacuum?"Preons hardcap delay":"Mass production"} from Cosmic dust will be increased by 3.`,()=>`Melt the core to increase Accretion speed.
(Cosmic dust strength will be increased by ${f(2*1.5**t.researches[3][7])})`,()=>`After reaching equilibrium self-made Protoplanets will boost each other by ${f(1.02)}.`,()=>"Unlock yet another Structure.",()=>`${t.inflation.vacuum?"Preons hardcap delay":"Mass production"} from Cosmic dust will be increased again (because of drag and escape velocity), by 2.`,()=>`${t.inflation.vacuum?"Preons hardcap delay":"Mass production"} from Cosmic dust will be greatly increased by ${8*2**t.researches[3][8]}.`,()=>`Satellites cost scaling will now be 2 times smaller.${t.inflation.vacuum?`
Also unlock a new Structure.`:""}`,()=>"Satellites effect will scale better."],startCost:[1e-16,1e-13,1e-13,1,1e14,1e17,1e10,1e22,1e22,1e23,1e9,1e26,1e29],maxActive:13},{name:["Gravitational Collapse","Proton-proton chain","Carbon-Nitrogen-Oxygen cycle","Helium fusion","Nucleosynthesis"],effectText:[()=>`As fuel runs out, every Star will boost production in its own special way. (Hover over effect to see what it boosts)
(Boost after Collapse can be seen in Stats subtab${t.inflation.vacuum?", also Solar mass gain is based on Mass from other Stages":""})`,()=>"Fuse with Protium instead of Deuterium. Unlock 5 first Elements (Elements subtab).",()=>"Unlock CNO cycle which is a better source of Helium and Energy. Unlock 5 more Elements.",()=>"Through Triple-alpha and then Alpha process unlock 2 more Elements.",()=>`Create new Atomic nuclei with Neutron capture (s-process and p-process).
Unlock 1 more Element and +1 extra for every (unknown) reset.`],startCost:[100,1e3,1e9,1e48,1e124],maxActive:4},{name:["Jeans instability","Super Star cluster","Quasar"],effectText:[()=>`Gravitational Collapse within Nebulas will increase speed for production of Stars by ${f(b.S5Upgrade0())} times.`,()=>`A very massive Star clusters, that will boost Stars by ${f(b.S5Upgrade1())}.`,()=>`Boost per Galaxy will be increased by +${f(b.S5Upgrade2(),{padding:!0})}.
(Effect will be stronger with more Solar mass past ${f(1e5)}, maxed at +1)`],startCost:[1e56,1e60,1e120],maxActive:3}],researchesInfo:[{},{name:["Stronger Protium","Better Deuterium","Improved Tritium","Requirement decrease","Discharge improvement","Radioactive Discharge"],effectText:[()=>`Cost scaling will be -${f(.03)} smaller with each level.`,()=>`Self-made Structures will boost each other by additional +${f(.01)}.`,()=>`Molecules will produce themselves ${f(b.S1Research2())} times quicker.`,()=>`Next goal for Discharge bonus will scale by -2 less.
(Creating this Research will make next Discharge goal to be ${f((wt()-2)**t.discharge.current)} Energy)`,()=>`Discharge production boost from reached goals will now be +1.
(Boost increase: ${f((b.dischargeBase(t.researches[1][4]+1)/o.dischargeInfo.base)**o.dischargeInfo.total,{padding:!0})})`,()=>`Discharge goals will now be able to boost 'Tritium'.
(Current effect: ${t.inflation.vacuum?`${f(b.S1Research5())} ^ level`:`${t.researches[1][5]>=1?f(o.dischargeInfo.total**b.S1Research5()):1} \u27F6 ${f(o.dischargeInfo.total**b.S1Research5(1))}`})`],cost:[],startCost:[2400,6e3,2e4,36e3,2e4,28e3],scaling:[400,2e3,8e3,48e3,16e3,16e3],max:[5,4,8,2,4,3],maxActive:6},{name:["Better Mole production","Better Drop production","Stronger surface tension","Stronger surface stress","More streams","Distributary channel"],effectText:[()=>`Drops will ${t.inflation.vacuum?"improve Tritium":"produce Moles"} 3 times more.${o.vaporizationInfo.research0!==t.researches[2][0]?`
Weakened by recent ${t.inflation.vacuum?"reset":"Vaporization"}, effective level is ${f(o.vaporizationInfo.research0)} (will be increased after ${f(new p(10*1.36**o.vaporizationInfo.research0).minus(t.buildings[2][1].total),{padding:!0})} more Drops).`:""}`,()=>`Puddles will produce Drops 2 times more.${o.vaporizationInfo.research1!==t.researches[2][1]?`
Weakened by recent ${t.inflation.vacuum?"reset":"Vaporization"}, effective level is ${f(o.vaporizationInfo.research1)} (will be increased after ${f(new p((5**(o.vaporizationInfo.research1+1)-1)*100).minus(t.buildings[2][1].total),{padding:!0})} more Drops).`:""}`,()=>`'Surface tension' base will be +${f(.005)} stronger.
(Effect increase: ${f(new p(t.buildings[2][0].current).max("1").power(b.S2Upgrade3(t.researches[2][2]+1)-b.S2Upgrade3()).toNumber(),{padding:!0})})`,()=>`'Surface stress' base will be +${f(.005)} stronger.
(Effect increase: ${f(new p(t.buildings[2][1].current).max("1").power(b.S2Upgrade4(t.researches[2][3]+1)-b.S2Upgrade4()).toNumber(),{padding:!0})})`,()=>"With more streams, will be able to have even more extra Puddles. (+1 extra Puddles per Pond)",()=>"Rivers will be able to split now, which will allow even more Ponds per Lake. (+1 per)"],cost:[],startCost:[10,400,1e4,1e5,1e14,1e22],scaling:[1.36,5,1e3,100,1e3,1e4],max:[8,8,4,4,2,1],maxActive:6},{name:["More massive bodies","Adhesion","Space weathering","Inelastic collisions","Destructive collisions","Contact binary","Gravity","Planetary differentiation","Aerodynamic drag"],effectText:[()=>"Increase strength of Cosmic dust by 3.",()=>`Cosmic dust particles will cling to each other. (+${f(.01)} to 'Brownian motion')`,()=>"Planetesimals will produce more Cosmic dust. (3 times more)",()=>`Slow encounter velocities will result in a more efficient growth.
${t.inflation.vacuum?"Preons hardcap delay":"Mass production"} from Cosmic dust will be increased by 2.`,()=>`Planetesimals when shatter will replenish small grains quantity.
'Streaming instability' effect will be increased by +${f(.005)}.`,()=>`Some Planetesimals instead of shattering will form a contact binary or even trinary.
${t.inflation.vacuum?"Preons hardcap delay":"Mass production"} from Cosmic dust will be increased by 3.`,()=>{let e=b.S3Research6(),s=new p(t.buildings[3][0].current).max("1");return`Planetesimals will attract other bodies and get a boost to own production based on unspent Mass ^${f(e)}.
(Boost: ${f(new p(s).power(e),{padding:!0})} \u27F6 ${f(s.power(b.S3Research6(t.researches[3][6]+1)),{padding:!0})})`},()=>`'Magma Ocean' will become stronger, by ${f(1.5)}.`,()=>`Improve 'Pebble accretion' Accretion speed even more.
${t.inflation.vacuum?"Preons hardcap delay":"Mass production"} from Cosmic dust will increased by 2.`],cost:[],startCost:[1e-16,1e-15,1e-5,100,1e10,1e11,1e15,1e14,1e12],scaling:[11,111,22,10,100,100,10,1e4,1e3],max:[9,3,8,8,2,2,5,4,4],maxActive:9},{name:["Planetary system","Star system","Protoplanetary disk","Planetary nebula","Gamma-ray burst"],effectText:[()=>{let e=b.S4Research0();return`From Planetesimals to Planets, will get ${f(e)}x boost to all Stars per level.
(Total boost: ${f(e**t.researches[4][0],{padding:!0})})`},()=>{let e=b.S4Research1();return`All self-made Stars will boost each other by ${f(e)}.
(Total boost: ${f(new p(e).power(o.collapseInfo.trueStars),{padding:!0})} \u27F6 ${f(new p(b.S4Research1(t.researches[4][1]+1)).power(o.collapseInfo.trueStars),{padding:!0})})`},()=>`Improve effect scaling of 'Planetary system', as well increase its max level by +3.
(Total boost from 'Planetary system' will be increased by ${f((b.S4Research0(t.researches[4][2]+1)/b.S4Research0())**t.researches[4][0],{padding:!0})})`,()=>"Matter expelled from Red giants, this will boost Main-sequence stars by 2, as well increase 'Planetary system' max level by +3.",()=>`An immensely energetic explosion that will boost all Stars by ${f(b.S4Research4(),{padding:!0})}${t.researches[4][4]<2?` \u27F6 ${f(b.S4Research4(!1,t.researches[4][4]+1),{padding:!0})}`:""}.
(Effect will be stronger with more Black holes${t.elements[23]===1?" and Solar mass":""})`],cost:[],startCost:[1e3,5e4,1e8,1e11,1e28],scaling:[10,200,1e12,1,2e8],max:[3,2,1,1,2],maxActive:5},{name:["Higher density","Type frequency"],effectText:[()=>`Higher density of Nebulas, will allow them to produce higher tier of Stars, but each tier is 3 times slower than previous one. Also will boost Nebulas by 3.
Next tier will be ${o.buildingsInfo.name[4][Math.min(t.researches[5][0]+2,4)]}.`,()=>`More of same Star type will be found within Star cluster. Will increase effect by 2 and also boost lower tier of Stars. (2 times less than higher one)
Next tier will be ${o.buildingsInfo.name[4][Math.max(3-t.researches[5][1],1)]}.`],cost:[],startCost:[1e54,1e58],scaling:[1e8,1e8],max:[3,3],maxActive:2}],researchesExtraInfo:[{},{name:["Extra strong force","Improved formula","Accretion","Later Preons","Impulse"],effectText:[()=>`Mesons will now bind Particles to form Atoms, which will make Atoms to be affected by 'Strong force'.
(Atoms will be 10 times cheaper)`,()=>`Improve scaling for 'Tritium' formula, current formula is log${f(b.S1Extra1())}${t.researchesExtra[1][1]<4?` \u27F6 log${f(b.S1Extra1(t.researchesExtra[1][1]+1))}`:""}.`,()=>`First level is to begin the Accretion, second level is to Submerge it.
All Structures produce Energy on creation, as well Mass from all Stages is connected.`,()=>{let e=b.S1Extra3();return`Delay Preons hardcap by current Energy ^${f(e)}.
(Effect: ${f(Math.max(t.discharge.energy,1)**e,{padding:!0})} \u27F6 ${f(Math.max(t.discharge.energy,1)**b.S1Extra3(t.researchesExtra[1][3]+1),{padding:!0})})`},()=>{let e=b.S1Extra4();return`Discharge goals will now be able to boost all Interstellar Stars, but at reduced base.
Current base is ${f(e)}, total boost is ${f(new p(e).power(o.dischargeInfo.total))}.`}],cost:[],startCost:[8e3,76e3,16e3,2e4,14e4],scaling:[0,16e3,76e3,16e3,0],max:[1,4,2,4,1],maxActive:0},{name:["Natural Vaporization","Rain Clouds","Storm Clouds","Water Accretion"],effectText:[()=>"When formed Clouds will use Drops produced this reset instead of current ones.",()=>`Some Clouds will start pouring Drops themselves. This will produce Drops until a Puddle, afterwards it will boost Puddles.
(Effect: ${f(b.S2Extra1_2(!1,1)[0]-(t.buildings[2][2].current.lessOrEqual("0")?1:0),{padding:!0})})`,()=>`Improve 'Rain Clouds', and also boost Seas at a reduced rate.
(Boost to Seas: ${f(b.S2Extra1_2(!1,void 0,1)[1],{padding:!0})})`,()=>{let e=t.researchesExtra[2][3],s=t.upgrades[2][3]===1?new p(t.buildings[2][0].current).max("1").power(b.S2Upgrade3()).toNumber():1,n=t.upgrades[2][4]===1?new p(t.buildings[2][1].current).max("1").power(b.S2Upgrade4()).toNumber():1;return`Submerge and boost Stars with 'Surface tension'. Also with 'Surface stress' ^${f(.5)} at level 2, full power at level 3.
(Boost to Stars: ${e<3?`${f(e<1?1:s*(e>1?n**.5:1),{padding:!0})} \u27F6 `:""}${f(s*(e<1?1:n**(e>1?1:.5)),{padding:!0})})`}],cost:[],startCost:[1e18,1e13,1e28,1e14],scaling:[1,1,1,1e8],max:[1,1,1,3],maxActive:3},{name:["Rank boost","Efficient growth","Weight","Viscosity","Efficient submersion"],effectText:[()=>`Increase strength of Cosmic dust by another ${f(1.1)}x per level.
(Total increase: ${f(1.1**t.researchesExtra[3][0],{padding:!0})})`,()=>`${t.inflation.vacuum?"Preons hardcap delay":"Mass production"} from Cosmic dust will now be even bigger, improved by current Rank.
(Total boost: ${f(b.S3Extra1())} \u27F6 ${f(b.S3Extra1(t.researchesExtra[3][1]+1))})`,()=>"'Gravitational field' will now be able to boost Protoplanets, but at reduced strength. (2x boost)",()=>`'Gas' will be a little stronger.
(Boost: ${f(new p(t.buildings[3][1].current).power(b.S3Upgrade1(t.researchesExtra[3][3]+1)-b.S3Upgrade1()).toNumber(),{padding:!0})})`,()=>`Submerge quicker by boosting Puddles, improved by current Rank.
(Current boost: ${f(b.S3Extra4())} \u27F6 ${f(b.S3Extra4(t.researchesExtra[3][4]+1))})`],cost:[],startCost:[1e-18,1e-16,1e26,1e-6,1e-10],scaling:[10,100,1,1e5,1e12],max:[12,5,1,8,1],maxActive:4},{name:["Nova","Mass transfer","White dwarfs"],effectText:[()=>`This violent stellar explosion is main source of Elements, but will also start new Star formation.
Unlock new Structure and even more, after Collapse of that Structure.`,()=>`Star material will transfer from one Star to another, improving Solar mass gain${t.inflation.vacuum?" (also delaying Preons hardcap)":""} by ${f(b.S4Extra1())}.
Improved by 'Star system' levels and also improves its scaling (effect increase for 'Star system' is ${f(new p(b.S4Research1(void 0,1)/b.S4Research1(void 0,0)).power(o.collapseInfo.trueStars),{padding:!0})}).`,()=>`After matter were dispeled from Red giant, White dwarf was all that remained. Will improve effect of '[6] Carbon' by +${f(.5)} and increase max level of 'Star system' by +1.`],cost:[],startCost:[4e4,2e9,1e54],scaling:[1e10,1,1],max:[3,1,1],maxActive:3},{name:["Hypercompact stellar system"],effectText:[()=>`Super dense core which will allow creation of a new Structure. That Structure will increase Stage reset reward, boost Nebulas and Star clusters, but creating it fully resets ${t.inflation.vacuum?"all":"Interstellar and Intergalactic"} Stages${t.inflation.vacuum?", Energy from creating it won't reset on this or any lower Reset tiers":""}.`],cost:[],startCost:[1e80],scaling:[1],max:[1],maxActive:1}],researchesAutoInfo:{name:["Upgrade automatization"],effectText:[()=>`Automatically create all ${["Upgrades","Stage Researches","Special Researches"][Math.min(t.researchesAuto[0],2)]} from any Stage. (Need to be enabled in Settings)`],costRange:[[1e13,8e34,1e30]],autoStage:[[2,3,4]],max:[3]},ASRInfo:{name:"Auto Structures",effectText:()=>{let e=t.stage.active,s=Math.min(t.ASR[e]+1,o.ASRInfo.max[e]);return`Automatically make ${t.buildings[e][s].highest.moreThan("0")?o.buildingsInfo.name[e][s]:"(unknown)"} (counts as self-made).
(Auto will wait until ${f(t.stage.true>=3?t.toggles.shop.wait[e]:2)} times of the Structure cost)`},costRange:[[],[4e3,12e3,2e4,36e3,6e4],[1e10,1e14,1e18,1e23,1e28,1e30],[1e-7,1e10,5e29,2e30,2e36],[1e6,1e17,1e28,1e39,1e54],[1e58,1e62,1e100]],max:[0,3,5,4,4,2]},elementsInfo:{name:["[0] Neutronium","[1] Hydrogen","[2] Helium","[3] Lithium","[4] Beryllium","[5] Boron","[6] Carbon","[7] Nitrogen","[8] Oxygen","[9] Fluorine","[10] Neon","[11] Sodium","[12] Magnesium","[13] Aluminium","[14] Silicon","[15] Phosphorus","[16] Sulfur","[17] Chlorine","[18] Argon","[19] Potassium","[20] Calcium","[21] Scandium","[22] Titanium","[23] Vanadium","[24] Chromium","[25] Manganese","[26] Iron","[27] Cobalt","[28] Nickel","[29] Copper"],effectText:[()=>`Element with no protons, true head of this table.
This one is ${Math.random()<.1?Math.random()<.1?"an illusive Tetraneutron, or maybe even Pentaneutron, wait where did it go? Was it even there?":"a rare Dineutron, but it is already gone...":"a simple Mononeutron, it will stay with you for as long as it can."}`,()=>"Most basic Element, increases Brown dwarf production by 2.",()=>`Fusion reaction by product, makes Interstellar Stars cost scale -${f(.1)} less.`,()=>`First metal, Solar mass gain${t.inflation.vacuum?" (and hardcap for Cosmic dust)":""} per Brown dwarf will be lightly increased.`,()=>`Brittle earth metal, so is brittle increase to production. (${f(1.2)}x to all Stars)`,()=>`A new color, and a new boost to Solar mass gain${t.inflation.vacuum?" (and delay to Cosmic dust hardcap)":""} that is based on current Dwarf Stars.`,()=>`Base for organics, boost from Red giants will now be increased by ^${f(b.element6())}.`,()=>"Most abundant uncombined Element in atmosphere of some Planets that allows to have 2 extra levels of 'Star system'.",()=>`An oxidizing agent that will make Interstellar Stars cost scale even slower. (-${f(.05)} less)`,()=>"Highly toxic and reactive, +12 to max level of 'Planetary system'.",()=>`A noble 2x boost to Solar mass gain${t.inflation.vacuum?" and delay to Preons hardcap":""}.`,()=>"Through leaching will get 1 extra level of 'Protoplanetary disk'.",()=>`Stars are inside you, as well Neutrons stars strength will be increased by log${f(b.element12())}.`,()=>`Has a great affinity towards Oxygen and to decrease cost for all Stars by ${f(1e3)}.`,()=>`Just another tetravalent metalloid, and so is another ${f(1.4)}x boost to all Stars.`,()=>`One of the Fundamentals of Life and to make all Stars boost Solar mass gain${t.inflation.vacuum?" and also delay Cosmic dust hardcap":""}.`,()=>"From hot area to increase max level of 'Star system' by 1.",()=>"Extremely reactive to extend max level of 'Planetary system', by another 24 levels.",()=>"Less noble, but Black holes effect will scale better.",()=>"Don't forget about it and will get a 2x boost to all Stars.",()=>"Get stronger with 1 extra level of 'Star system'.",()=>`A new color and a rare bonus of ^${f(1.1)} to effective Solar mass amount, but only affects Solar mass effect.`,()=>"New alloy that allows Red giants to be added into effective amount of Neutron stars.",()=>`Catalyst for production of Elements. 'Gamma-ray burst' effect will be increased by Solar mass ^${f(.1)}.
(Effect increase: ${f(t.collapse.mass**.1,{padding:!0})})`,()=>{let e=b.element24();return`No corrosion, only boost to all Stars that is based on unspent Elements ^${f(e)}.
(Boost to Stars: ${f(new p(t.buildings[4][0].current).power(e),{padding:!0})})`},()=>"Brittle Element, but not the bonus - 1 more level in 'Star system'.",()=>{let e=b.element26();return`Any further fusion will be an endothermic process. ${t.inflation.vacuum?`Unlock Stage reset and a new Star type${t.strangeness[5][5]>=1?", as well Intergalactic Stage":""}`:"Enter Intergalactic space"}.
(${t.inflation.vacuum||t.strange[0].total>=1?`Current base increase for Stage reset reward is ${f(e,{padding:e>=1e6})}, improve it further with every new digit of Elements produced this Stage`:"Can change active Stage from footer"})`},()=>"Combined and ready to make all self-made Red supergiants count as Red giants, and boost all Stars by 3.",()=>`Slow to react, but will improve '[24] Chromium' Element by +${t.inflation.vacuum||t.milestones[1][1]>=6?f(.2):`${f(.05)}, not yet at full power, requires more Energy`}.`,()=>`Does not need to be prepared to increase Stage reset reward base from '[26] Iron' by Arithmetic progression with step of ${f(.01)}.`],startCost:[0,1e3,4e3,2e4,1e5,1e8,1e10,4e11,8e12,6e13,1e15,1e20,1e22,1e24,14e25,1e28,1e30,1e32,1e35,2e36,1e39,1e41,2e42,3e43,4e44,5e45,1e48,1e50,1e52,1e144]},strangenessInfo:[{},{name:["Fundamental boost","Better improvement","Cheaper Discharge","Free Discharge","Automatic Discharge","Auto Structures","Strange boost","Energy increase","Conservation of Mass","Conservation of Energy"],effectText:[()=>"Boost all Microworld Structures by 2.",()=>"Base for 'Improved Tritium' Research will be bigger by +2.",()=>`Discharge goals requirement will scale slower. (-${f(.5)})`,()=>`Obtain +${f(.5)} bonus Discharge goals.`,()=>`Automatically Discharge upon reaching next goal or spending Energy. (Need to be enabled in Settings)${o.strangenessInfo[1].max[4]>1?`
Second level will allow to gain Discharge goals based on current Energy instead of needing to reset.`:""}`,()=>"Make auto for all Microworld Structures permanent.",()=>`Unspent Strange quarks will boost Microworld by improving its Structures.
(Current effect: ${f(o.strangeInfo.stageBoost[1],{padding:!0})})`,()=>"Increase Energy gain from creating Preons by +2.",()=>"No Mass will be lost when creating Preons, only works when Accretion Stage is unlocked.",()=>"No Energy will be lost when creating any Upgrades or Researches, only works when Interstellar Stage is unlocked."],cost:[],startCost:[1,2,1,4,12,2,24,2,16,15600],scaling:[2.46,4,6,8,100,1,1,6,1,1],max:[6,2,4,2,1,1,1,2,1,1],maxActive:7},{name:["More Moles","Bigger Puddles","More spread","Cloud density","Automatic Vaporization","Auto Structures","Strange boost","Better water flow","Mechanical spread","Ocean world"],effectText:[()=>`Moles will ${t.inflation.vacuum?"improve":"produce"} 2 times more.`,()=>`Puddles will produce ${f(1.8)} times more.`,()=>{let e="none";return t.strangeness[2][2]>=1&&(e="max level increased for 'More streams' (+1)"),t.strangeness[2][2]>=2&&(e+=" and 'Distributary channel' (+1)"),t.strangeness[2][2]>=3&&(e+=", a new Upgrade - 'Tsunami'"),`Increase max level for one of Researches.
Final level will instead unlock a new Upgrade.
(Current effect: ${e})`},()=>"Decrease required Drops quantity for a Cloud by 2 times.",()=>`Automatically Vaporize when reached enough boost from new Clouds. (Need to be enabled in Settings)${o.strangenessInfo[2].max[4]>1?`
Second level will allow to automatically gain ${f(2.5)}% of Clouds per second. (Not affected by global speed)`:""}`,()=>"Make auto for all Submerged Structures permanent.",()=>`Unspent Strange quarks will boost Submerged by improving Puddles.
(Current effect: ${f(o.strangeInfo.stageBoost[2],{padding:!0})})`,()=>`With improved flow all Submerged Structures that improve other Submerged Structures will do it ${f(1.4)} times stonger.`,()=>{let e="none";return t.strangeness[2][8]>=1&&(e="max level increased for 'Stronger surface tension' (+3)"),t.strangeness[2][8]>=2&&(e+=" and 'Stronger surface stress' (+1)"),t.strangeness[2][8]>=3&&(e+=", a new Upgrade - 'Tide'"),`Increase max level for one of Researches.
Final level will instead unlock an even better new Upgrade.
(Current effect: ${e})`},()=>`Increase Stage reset reward based on current Cloud amount.
(Current effect: ${f(b.S2Strange9(),{padding:!0})})`],cost:[],startCost:[1,1,2,4,12,4,24,80,1200,9600],scaling:[2.46,2,3,6,800,1,1,3.4,3,1],max:[6,8,3,2,1,1,1,4,3,1],maxActive:7},{name:["Faster Accretion","Intense weathering","More levels","Improved Satellites","Automatic Rank","Auto Structures","Upgrade automatization","Strange boost","Mass delay","Rank raise"],effectText:[()=>"Increase strength of Cosmic dust by 2.",()=>`Accretion Structures that produce other Structures now do it ${f(1.8)} times faster.`,()=>{let e="none";return t.strangeness[3][2]>=1&&(e="max level increased for 'Rank boost' (+9)"),t.strangeness[3][2]>=2&&(e+=" and 'Efficient growth' (+3)"),t.strangeness[3][2]>=3&&(e+=", a new Upgrade - 'Hydrostatic equilibrium'"),`Increase max level for one of the Rank Researches.
Final level will instead unlock a new Upgrade.
(Current effect: ${e})`},()=>`Satellites will now be able to improve all${t.inflation.vacuum?" lower tier":""} Accretion Structures with reduced strength (^${f(t.inflation.vacuum?.2:.3)}).`,()=>`Automatically increase Rank when possible. (Need to be enabled in Settings)${o.strangenessInfo[3].max[4]>1?`
Second level will make auto Rank to always keep enough Mass for highest Solar mass conversion from Collapse by disabling Accretion auto Structures if Cosmic dust is hardcapped`:""}`,()=>"Make auto for all Accretion Structures permanent.",()=>`Always automatically create all ${["Upgrades","Stage Researches","Special Researches"][Math.min(t.strangeness[3][6],2)]} from any Stage. (Need to be enabled in Settings)`,()=>`Unspent Strange quarks will boost Accretion by making its Structures cheaper.
(Current effect: ${f(o.strangeInfo.stageBoost[3],{padding:!0})})`,()=>`Delay Cosmic dust hardcap by ${f(1.4)} per level.
(Will delay Preons hardcap instead if inside the Void)`,()=>"Unlock a new Accretion Rank to achieve. (Not yet in game)"],cost:[],startCost:[1,2,4,16,12,4,4,24,9600,1/0],scaling:[2,3.4,2,1,400,1,1.74,1,2.46,1],max:[8,4,3,1,1,1,3,1,6,1],maxActive:8},{name:["Hotter Stars","Cheaper Stars","New Upgrade","Main giants","Automatic Collapse","Auto Structures","Element automatization","Strange boost","Neutronium","Newer Upgrade"],effectText:[()=>`All Stars will produce ${f(1.8)} times more Elements.`,()=>"Stars will be 2 times cheaper.",()=>{let e="none";return t.strangeness[4][2]>=1&&(e="'Planetary nebula' (Stage Research)"),t.strangeness[4][2]>=2&&(e+=", 'Helium fusion' (Upgrade)"),t.strangeness[4][2]>=3&&(e+=", 'White dwarfs' (Collapse Research)"),`Unlock a new Upgrade.
(Current unlocks: ${e})`},()=>"10% of Brown dwarfs will turn into Red giants.",()=>`Automatically Collapse once reached enough boost. (Need to be enabled in Settings)${o.strangenessInfo[4].max[4]>1?`
Second level will allow to automatically gain Star remnants without needing to reset.`:""}`,()=>"Make auto for all Interstellar Structures permanent.",()=>`Elements will not require Collapse for activation.
Second level will unlock auto creation of Elements. (${o.strangenessInfo[4].max[6]>1?"Need to be enabled in settings":"Not yet unlocked for Interstellar space"})`,()=>`Unspent Strange quarks will boost Interstellar by improving all Stars.
(Current effect: ${f(o.strangeInfo.stageBoost[4],{padding:!0})})`,()=>`Increase effective amount of Neutrons stars (doesn't include one's from '[22] Titanium') by 1 + level, improve Neutron Stars strength by +^${f(.125)} and '[12] Magnesium' log base by -1.`,()=>`Unlock yet another new Upgrade.
(Current unlocks: ${t.strangeness[4][9]>=1?"'Nucleosynthesis' (Upgrade)":"none"})`],cost:[],startCost:[1,2,4,4,12,6,6,24,6400,1/0],scaling:[2,3.4,3,4,1300,1,2,1,2,3],max:[8,4,3,2,1,1,1,1,8,1],maxActive:8},{name:["Omnipresent reality","Strange gain","Automatic Stage","Bigger Nebulas","Denser Clusters","Gravitational bound","Auto Structures","Strange boost","Strange growth"],effectText:[()=>t.inflation.vacuum?`Unlock the Void (advanced subtab).
Also 20% global speed bonus while outside of Void.`:`${o.stageInfo.word[t.strangeness[5][0]+1]} will now be permanent and removed from Stage reset cycle.
Permanent Stages do not affect Stage time.`,()=>`Gain 2 times more Strange quarks from${t.inflation.vacuum?"":" Interstellar"} Stage resets.`,()=>"Automatically trigger Stage reset. (Need to be enabled in Settings)",()=>`Bigger Nebulas, more matter for Accretion. (Flavor text)
'Jeans instability' will be 2 times stronger.`,()=>"'Super star cluster' will be even bigger. Increase effect by 3.",()=>t.inflation.vacuum?"Unlock Intergalactic Stage.":`Intergalactic Stage will no longer be affected by Collapse reset.
Also unlock first Intergalactic Milestone which as a reward will unlock better auto for Elements and more.`,()=>`Make auto for first two Intergalactic Structures permanent${t.stage.true>=6||t.buildings[5][3].highest.moreThan("0")?" and also prevent rest from resetting":""}.`,()=>`Unspent Strange quarks will boost Intergalactic by increasing Solar mass gain.
(Current effect: ${f(o.strangeInfo.stageBoost[5],{padding:!0})})`,()=>`Unlock another Strange Structure.
(Click on Structure to see its effects)`],cost:[],startCost:[4,24,360,24,36,36,40,120,6e3],scaling:[1,10,1,2,2,1,1,1,1],max:[3,1,1,8,8,1,1,1,1],maxActive:8}],lastUpgrade:[[-1,"upgrades"],[-1,"upgrades"],[-1,"upgrades"],[-1,"upgrades"],[-1,"upgrades"],[-1,"researches"]],lastElement:-1,lastStrangeness:[-1,-1],lastMilestone:[-1,-1],lastChallenge:[-1,-1],milestonesInfo:[{},{name:["Fundamental Matter","Energized"],needText:[()=>`Produce at least ${f(o.milestonesInfo[1].need[0])} ${t.inflation.vacuum?"Preons":"Quarks"} this reset.`,()=>`Have current Energy reach ${f(o.milestonesInfo[1].need[1])}.`],rewardText:[()=>t.inflation.vacuum?`All Microworld Structures receive ${f(o.milestonesInfo[1].reward[0],{padding:!0})}x boost.`:`Unknown Structure, it doesn't belong to this Universe.
Vacuum instability increased.`,()=>t.inflation.vacuum?`Energy from creating Structures increased by ${f(o.milestonesInfo[1].reward[1])}%. (Rounds down)`:"Unlock full strength of '[28] Nickel'."],need:[new p("1e160"),new p("2.4e4")],reward:[1,1],scalingOld:[[1e160,1e170,1e180,1e190,1e205,1e220],[24e3,25e3,26e3,27e3,28500,3e4]]},{name:["A Nebula of Drops","Just a bigger Puddle"],needText:[()=>`Vaporize ${t.inflation.vacuum?"to":"with"} at least ${f(o.milestonesInfo[2].need[0])} ${t.inflation.vacuum?"Clouds":"Drops this reset"}.`,()=>`Have at least ${f(o.milestonesInfo[2].need[1])} Puddles at same time.`],rewardText:[()=>t.inflation.vacuum?`Clouds gain increased by ${f(o.milestonesInfo[2].reward[0],{padding:!0})}.`:"A new Intergalactic Structure. (Nebula)",()=>t.inflation.vacuum?`Puddles are now stronger by ${f(o.milestonesInfo[2].reward[1],{padding:!0})}.`:`Unknown Structure, it doesn't belong to this Universe.
Vacuum instability increased.`],need:[new p("1e30"),new p("1.5e3")],reward:[1,1],scalingOld:[[1e30,1e34,1e38,1e42,1e47,1e52,1e58],[1500,2500,3500,5e3,6500,8e3,1e4]]},{name:["Cluster of Mass","Satellites of Satellites"],needText:[()=>`Produce at least ${f(o.milestonesInfo[3].need[0])} Mass this reset.`,()=>`Have more or equal to ${f(o.milestonesInfo[3].need[1])} Satellites${t.inflation.vacuum?" and Subsatellites":""}.`],rewardText:[()=>t.inflation.vacuum?`Cosmic dust strength increased by ${f(o.milestonesInfo[3].reward[0],{padding:!0})}.`:"A new Intergalactic Structure. (Star cluster)",()=>t.inflation.vacuum?`Improve effect of 'Planetary system' base by +${f(o.milestonesInfo[3].reward[1])}.`:`Unknown Structure, it doesn't belong to this Universe.
Vacuum instability increased.`],need:[new p("1e32"),new p("24")],reward:[1,1],scalingOld:[[1e32,1e35,1e38,1e41,1e44,1e47,1e50],[24,28,32,36,42,48,54]]},{name:["Supermassive","Biggest of all"],needText:[()=>`Collapse ${t.inflation.vacuum?"with":"to"} at least ${f(o.milestonesInfo[4].need[0])} ${t.inflation.vacuum?"Elements this reset":"Solar mass"}.`,()=>`Collapse to ${f(o.milestonesInfo[4].need[1])} Black holes or more.`],rewardText:[()=>t.inflation.vacuum?`Stars produce ${f(o.milestonesInfo[4].reward[0],{padding:!0})} times more Elements.`:"New Intergalactic themed Strangeness.",()=>t.inflation.vacuum?`Preons hardcap delayed by ${f(o.milestonesInfo[4].reward[1],{padding:!0})}.`:`Unknown Structure, it doesn't belong to this Universe.
Vacuum instability increased.`],need:[new p("9e3"),new p("1e2")],reward:[1,1],scalingOld:[[9e3,11e3,13e3,15e3,17e3,19e3,21500,24e3],[100,115,130,145,160,180,200,220]]},{name:["Light in the dark","End of Greatness"],needText:[()=>`Have self-made Stars count reach at least ${f(o.milestonesInfo[5].need[0])}.`,()=>`Have ${f(o.milestonesInfo[5].need[1])} self-made Galaxies or more.`],rewardText:[()=>t.inflation.vacuum?`Decrease cost for all Stars by ${f(o.milestonesInfo[5].reward[0],{padding:!0})}.`:`Unlock last Milestone and new Intergalactic Research.
Also increase max level of 'Element automatization'.`,()=>t.inflation.vacuum?`Boost per Galaxy is now +${f(o.milestonesInfo[5].reward[1])} bigger.`:`Unknown Structure, it cannot exist in false Vacuum.
Vacuum instability increased.`],need:[new p("1.5e3"),new p("2")],reward:[1,1],scalingOld:[[1500,1550,1600,1650,1700,1750,1850,2e3],[2,4,6,8,10,13,16,20]]}],challengesInfo:{name:["Void"],description:[`Result of Vacuum Instabillity, investigate at your own will
(Entering will force a Stage reset)`],effectText:[()=>{let e=t.challenges.void,s=`<span class="orangeText">- Discharge base is divided by 2${e[1]>=2?`
- Energy gain from creating non Microworld Structures is decreased by 50%`:""}</span>`;e[1]>=3&&(s+=`

<span class="blueText">- Effective Drops amount is capped at 1
- Puddles are ${f(2e3)} times weaker
- Clouds gain is decreased by ^${f(.8)}</span>`),e[1]>=2&&(s+=`

<span class="grayText">- Cosmic dust is softcapped (^${f(.9)})${e[3]>=4?`
- Softcap is stronger after reaching 'Jovian planet' Rank (^${f(.8)})`:""}</span>`),e[3]>=5&&(s+=`

<span class="orchidText">- Solar mass effect is ${f(2e4)} times weaker
- Effective Solar mass amount above 1 is ^${f(.4)}
- Solar mass gain from Stars is decreased by ${f(1.6)}</span>`),e[5]>=1&&(s+=`

<span class="cyanText">- First 2 Intergalactic Upgrades are weaker</span>`);let n=e[1]<2?"orange":e[3]<5?"gray":e[5]<1?"orchid":null;return n!==null&&(s+=`
<span class="${n}Text">More will be shown after getting further into Void</span>`),s}],needText:[[[],["Perform Discharge","Get first level of 'Accretion'","Get second level of 'Accretion'"],["Have more than 1 Cloud","Have more than 1e4 Clouds"],["Reach 'Meteoroid' Rank","Reach 'Asteroid' Rank","Reach 'Planet' Rank","Reach 'Jovian planet' Rank","Reach 'Protostar' Rank"],["Cause the Collapse","Get first Red giant","Get first Neutron star","Get first Black hole"],["Unlock Intergalactic","Create a Galaxy"]]],rewardText:[[[],["'Energy increase' (Microworld)","'Conservation of Mass' (Microworld)","'Better water flow' (Submerged)"],["'Mechanical spread' (Submerged)","'Ocean world' (Submerged)"],["Multiple max level increases","Multiple max level increases","Multiple max level increases","Multiple max level increases","'Strange growth' (Intergalactic)"],["Max level increased for Auto resets","'Conservation of Energy' (Microworld)","'Neutronium' (Interstellar)","'Mass delay' (Accretion)"],["'Newer Upgrade' (Interstellar)","'Rank raise' (Accretion)"]]],color:["darkviolet"]},historyStorage:{stage:[]}},et=(e,s)=>Math.log(e)/Math.log(s),_=e=>e.slice(0),fe=e=>{if(typeof e!="object"||e===null)return e;let s;if(Array.isArray(e)){if(e instanceof p)return new p(e);s=[];for(let n=0;n<e.length;n++)s.push(fe(e[n]))}else{s={};for(let n in e)s[n]=fe(e[n])}return s},I=(e,s)=>{let n=[];for(let a=0;a<e;a++)n.push(s);return n};for(let e=0;e<o.buildingsInfo.startCost.length;e++){o.buildingsInfo.producing[e]=[];for(let s=0;s<o.buildingsInfo.startCost[e].length;s++)o.buildingsInfo.producing[e].push(new p("0"))}for(let e of["researches","researchesExtra","strangeness"]){let s=o[`${e}Info`];for(let n=1;n<s.length;n++)s[n].cost=_(s[n].startCost)}Object.assign(t,{upgrades:[[],I(o.upgradesInfo[1].startCost.length,0),I(o.upgradesInfo[2].startCost.length,0),I(o.upgradesInfo[3].startCost.length,0),I(o.upgradesInfo[4].startCost.length,0),I(o.upgradesInfo[5].startCost.length,0)],researches:[[],I(o.researchesInfo[1].startCost.length,0),I(o.researchesInfo[2].startCost.length,0),I(o.researchesInfo[3].startCost.length,0),I(o.researchesInfo[4].startCost.length,0),I(o.researchesInfo[5].startCost.length,0)],researchesExtra:[[],I(o.researchesExtraInfo[1].startCost.length,0),I(o.researchesExtraInfo[2].startCost.length,0),I(o.researchesExtraInfo[3].startCost.length,0),I(o.researchesExtraInfo[4].startCost.length,0),I(o.researchesExtraInfo[5].startCost.length,0)],researchesAuto:I(o.researchesAutoInfo.costRange.length,0),ASR:I(o.ASRInfo.costRange.length,0),maxASR:I(o.ASRInfo.costRange.length,0),elements:I(o.elementsInfo.startCost.length,0),strangeness:[[],I(o.strangenessInfo[1].startCost.length,0),I(o.strangenessInfo[2].startCost.length,0),I(o.strangenessInfo[3].startCost.length,0),I(o.strangenessInfo[4].startCost.length,0),I(o.strangenessInfo[5].startCost.length,0)],milestones:[[],I(o.milestonesInfo[1].need.length,0),I(o.milestonesInfo[2].need.length,0),I(o.milestonesInfo[3].need.length,0),I(o.milestonesInfo[4].need.length,0),I(o.milestonesInfo[5].need.length,0)]});Object.assign(t.toggles,{confirm:I(document.getElementsByClassName("toggleConfirm").length,"All"),buildings:[[],I(t.buildings[1].length,!1),I(t.buildings[2].length,!1),I(t.buildings[3].length,!1),I(t.buildings[4].length,!1),I(t.buildings[5].length,!1)],hover:I(document.getElementsByClassName("toggleHover").length,!1),max:I(document.getElementsByClassName("toggleMax").length,!1),auto:I(document.getElementsByClassName("toggleAuto").length,!1)});var E=fe(t),lt=e=>{if(e.player!==void 0&&(e=e.player),e.vaporization===void 0)throw new ReferenceError("This save file is not from this game or too old");e.version===void 0&&(e.version="0.0.0"),we(!!e.inflation?.vacuum);let s=e.version;if(s!==E.version&&e.version!==E.version)throw new ReferenceError("Because update isn't finished only save files created in this version are allowed");{typeof e.vaporization.input!="object"&&(e.vaporization.input=_(E.vaporization.input)),typeof e.collapse.input!="object"&&(e.collapse.input=_(E.collapse.input));let a=e.history.stage;if(a.best.length<4){let i=_(a.best);a.best=[i[1],i[0],0,0];for(let c=0;c<a.list.length;c++){let l=a.list[c];a.list[c]=[l[1],l[0],0,0]}}typeof e.time.export!="object"&&(e.time.export=_(E.time.export)),delete e.stage.best,delete e.stage.export}for(let a=1;a<=5;a++){for(let i=e.buildings[a].length;i<E.buildings[a].length;i++)e.buildings[a][i]=fe(E.buildings[a][i]);for(let i=e.toggles.buildings[a].length;i<E.toggles.buildings[a].length;i++)e.toggles.buildings[a][i]=!1;isNaN(e.toggles.shop.wait[a])&&(e.toggles.shop.wait[a]=2);for(let i=e.upgrades[a].length;i<E.upgrades[a].length;i++)e.upgrades[a][i]=0;for(let i=e.researches[a].length;i<E.researches[a].length;i++)e.researches[a][i]=0;for(let i=e.researchesExtra[a].length;i<E.researchesExtra[a].length;i++)e.researchesExtra[a][i]=0;e.ASR[a]===void 0&&(e.ASR[a]=0);for(let i=e.strangeness[a].length;i<E.strangeness[a].length;i++)e.strangeness[a][i]=0;for(let i=e.milestones[a].length;i<E.milestones[a].length;i++)e.milestones[a][i]=0}for(let a=e.strange.length;a<E.strange.length;a++)e.strange[a]=fe(E.strange[a]);for(let a=e.researchesAuto.length;a<E.researchesAuto.length;a++)e.researchesAuto[a]=0;for(let a=e.elements.length;a<E.elements.length;a++)e.elements[a]=0;for(let a=e.toggles.confirm.length;a<E.toggles.confirm.length;a++)e.toggles.confirm[a]="All";for(let a=e.toggles.hover.length;a<E.toggles.hover.length;a++)e.toggles.hover[a]=!1;for(let a=e.toggles.max.length;a<E.toggles.max.length;a++)e.toggles.max[a]=!1;for(let a=e.toggles.auto.length;a<E.toggles.auto.length;a++)e.toggles.auto[a]=!1;for(let a=e.events.length;a<E.events.length;a++)e.events[a]=!1;e.vaporization.clouds=new p(e.vaporization.clouds),e.vaporization.cloudsMax=new p(e.vaporization.cloudsMax);for(let a=1;a<e.buildings.length;a++)for(let i=0;i<e.buildings[a].length;i++){let c=e.buildings[a][i];c.current=new p(c.current),c.total=new p(c.total),c.trueTotal=new p(c.trueTotal),c.highest=new p(c.highest)}Object.assign(t,e),o.debug.errorID=!0,o.debug.errorQuery=!0,o.debug.errorGain=!0,o.vaporizationInfo.research0=0,o.vaporizationInfo.research1=0;let n=t.buildings[4];o.collapseInfo.trueStars=n[1].true+n[2].true+n[3].true+n[4].true+n[5].true,o.historyStorage.stage=t.history.stage.list,t.inflation.vacuum?(t.buildings[2][0].current.setValue(t.buildings[1][5].current).divide("6.02214076e23"),t.buildings[3][0].current.setValue(t.buildings[1][0].current).multiply("1.78266192e-33"),t.events[0]=!0):(t.researchesAuto[0]=t.strangeness[3][6],t.accretion.rank===0&&t.buildings[3][0].current.setValue("5.9722e27"),Et()),t.stage.current<5&&t.elements[26]===1&&(t.elements[26]=0);for(let a=1;a<=5;a++){let i=t.strangeness[a],c=o.strangenessInfo[a].max;for(let m=0;m<o.strangenessInfo[a].maxActive;m++)k(m,a,"strangeness"),i[m]>c[m]&&(i[m]=c[m],O(m,a,"strangeness"));for(let m=0;m<E.milestones[a].length;m++)He(m,a);let l=t.researchesExtra[a],g=o.researchesExtraInfo[a].max;for(let m=0;m<o.researchesExtraInfo[a].maxActive;m++)k(m,a,"researchesExtra"),l[m]>g[m]&&(l[m]=g[m]);let d=t.researches[a],u=o.researchesInfo[a].max;for(let m=0;m<o.researchesInfo[a].maxActive;m++)k(m,a,"researches"),d[m]>u[m]&&(d[m]=u[m]);k(0,a,"ASR")}for(let a=0;a<E.researchesAuto.length;a++)O(a,0,"researchesAuto");te(),ie(),Oe(!0),ke(),xt(),r("saveFileNameInput").value=t.fileName,r("stageInput").value=f(t.stage.input,{type:"input"}),r("vaporizationInput").value=f(t.vaporization.input[0],{type:"input"}),r("vaporizationInputMax").value=f(t.vaporization.input[1],{type:"input"}),r("collapseStarsInput").value=`${f(t.collapse.input[0],{type:"input"})}${t.collapse.input[1]?"!":""}`,r("stageResetsSave").value=`${t.history.stage.input[0]}`,r("stageResetsShow").value=`${t.history.stage.input[1]}`;for(let a=0;a<E.toggles.confirm.length;a++)tt(a);for(let a=0;a<E.toggles.hover.length;a++)G(a,"hover");for(let a=0;a<E.toggles.max.length;a++)G(a,"max");for(let a=0;a<E.toggles.auto.length;a++)G(a,"auto");return r("buyAnyInput").value=f(t.toggles.shop.input,{type:"input"}),s},qt=()=>{r("closeVersionInfo",!0)===null&&(r("versionInfo").innerHTML=`<div>
        <div id="versionText">
            <label>v0.2.0</label><p>- <a href="https://docs.google.com/document/d/1Kwy-NhKUx3cnfv04I5wwbr-WKyg3yZAZ4t-GA2AAm0k/edit?usp=sharing" target="_blank" rel="noopener noreferrer">Link</a></p>
            <label>v0.1.9</label><p>- More true Vacuum balance
- Reworked time related formats
- Warp and Offline time usage reworked</p>
            <label>v0.1.8</label><p>- True Vacuum small balance changes
- Upgrades and Researches merged
- Added copy to clipboard, load from string save file options</p>
            <label>v0.1.7</label><p>- New content (Void)
- Further balance changes</p>
            <label>v0.1.6</label><p>- Massive rebalance and reworks for all Stages</p>
            <label>v0.1.5</label><p>- True Vacuum minor balance
- Images no longer unload
- Screen reader support reworked</p>
            <label>v0.1.4</label><p>- Custom scrolls
- Notifications</p>
            <label>v0.1.3</label><p>- True Vacuum balance changes
- Submerged Stage minor balance
- Replay event button

- History for Stage resets</p>
            <label>v0.1.2</label><p>- New content (Vacuum)
- Offline time reworked
- Added version window (removed change log on game load)
- Permanently removed text movement</p>
            <label>v0.1.1</label><p>- More balance changes for late game</p>
            <label>v0.1.0</label><p>- New content (Intergalactic)
- Balance changes for late game</p>
            <label>v0.0.9</label><p>- New content (Milestones)
- More Interstellar and late game balance</p>
            <label>v0.0.8</label><p>- Minor speed up to all Stages past Microworld</p>
            <label>v0.0.7</label><p>- New content (Strangeness)
- Microworld Stage rework

- Added stats for Save file name</p>
            <label>v0.0.6</label><p>- Added hotkeys list

- Option to remove text movement
- Ability to rename save file</p>
            <label>v0.0.5</label><p>- New content (Interstellar)
- Basic loading screen

- Added hotkeys</p>
            <label>v0.0.4</label><p>- Speed up to all Stages
- Added events

- Added numbers format</p>
            <label>v0.0.3</label><p>- New content (Accretion)
- Submerged Stage extended
- Offline time calculated better</p>
            <label>v0.0.2</label><p>- Stats subtab</p>
            <label>v0.0.1</label><p>- Submerged Stage rework
- Added change log on game load

- Mobile device support</p>
            <label>v0.0.0</label><p>- First published version

- Submerged Stage placeholder</p>
        </div>
        <button type="button" id="closeVersionInfo">Close</button>
    </div>`,M.styleSheet.textContent+="#versionInfo > div { display: flex; flex-direction: column; justify-content: space-between; align-items: center; width: clamp(42vw, 36em, 80vw); height: clamp(26vh, 36em, 90vh); background-color: var(--window-color); border: 3px solid var(--window-border); border-radius: 12px; padding: 1em 1em 0.8em; row-gap: 1em; } #versionInfo button { flex-shrink: 0; width: 6em; border-radius: 4px; font-size: 0.92em; } #versionText { width: 100%; overflow-y: auto; } #versionText label { font-size: 1.18em; } #versionText p { line-height: 1.3em; white-space: pre-line; color: var(--white-text); margin-top: 0.2em; margin-bottom: 1.4em; } #versionText p:last-of-type { margin-bottom: 0; }",r("closeVersionInfo").addEventListener("click",()=>{r("versionInfo").style.display="none"}))};var Gt=e=>{if(e.code==="Tab"){document.body.classList.remove("noFocusOutline");return}else{let c=document.activeElement?.type;if(c==="text"||c==="number")return;document.body.classList.add("noFocusOutline")}if(o.paused)return;let{key:s,code:n}=e,{shiftKey:a}=e;if(a&&(o.hotkeys.shift=!0),e.ctrlKey)return void(o.hotkeys.ctrl=!0);if(e.altKey)return;let i=Number(n.slice(-1));if(isNaN(i)){if(s.length===1){let c=(v.toggles[0]?s:n.replace("Key","")).toLowerCase();a?c==="a"&&G(0,"buildings",!0):c==="m"?Ve():c==="w"?(e.preventDefault(),Mt()):c==="s"?Ie():c==="d"?o.stageInfo.activeAll.includes(1)&&st():c==="v"?o.stageInfo.activeAll.includes(2)&&nt():c==="r"?o.stageInfo.activeAll.includes(3)&&rt():c==="c"?o.stageInfo.activeAll.includes(4)&&De():c==="p"&&v.developerMode&&Tt()}else if(s==="ArrowLeft"||s==="ArrowRight"){if(e.repeat)return;if(a){let c=o.stageInfo.activeAll;if(c.length===1)return;let l=c.indexOf(t.stage.active);s==="ArrowLeft"?(l<=0?l=c.length-1:l--,he(c[l])):(l>=c.length-1?l=0:l++,he(c[l]))}else{let c=o.tabList.tabs,l=c.indexOf(o.tab);if(s==="ArrowLeft"){do l<=0?l=c.length-1:l--;while(!ce(c[l]));j(c[l])}else{do l>=c.length-1?l=0:l++;while(!ce(c[l]));j(c[l])}}}else if(s==="ArrowDown"||s==="ArrowUp"){let c=o.subtab[`${o.tab}Current`];if(a||e.repeat||c===void 0)return;let l=o.tabList[`${o.tab}Subtabs`],g=l.indexOf(c);if(s==="ArrowDown"){do g<=0?g=l.length-1:g--;while(!ce(o.tab,l[g]));j(o.tab,l[g])}else{do g>=l.length-1?g=0:g++;while(!ce(o.tab,l[g]));j(o.tab,l[g])}}}else{if(isNaN(Number(s))){if(n===""||n[0]==="F")return;a||(a=!0,e.preventDefault())}if(a){if(e.repeat)return;G(i,"buildings",!0)}else de(i)}};var r=(e,s=!1)=>{let n=M.cache.idMap.get(e);if(n!==void 0)return n;let a=document.getElementById(e);if(a!==null)return M.cache.idMap.set(e,a),a;if(s)return null;throw o.debug.errorID&&(o.debug.errorID=!1,U(`Error encountered, ID - '${e}' doesn't exist`),setTimeout(()=>{o.debug.errorID=!0},6e4)),new ReferenceError(`ID - '${e}' doesn't exist`)},Wt=e=>{M.cache.idMap.delete(e)},qe=e=>{let s=M.cache.classMap.get(e);if(s!==void 0)return s;let n=document.getElementsByClassName(e);return M.cache.classMap.set(e,n),n},z=e=>{let s=M.cache.queryMap.get(e);if(s!==void 0)return s;let n=document.querySelector(e);if(n!==null)return M.cache.queryMap.set(e,n),n;throw o.debug.errorQuery&&(o.debug.errorQuery=!1,U(`Error encountered, Query - '${e}' failed to find anything`),setTimeout(()=>{o.debug.errorQuery=!0},6e4)),new ReferenceError(`Query - '${e}' failed`)},gt=()=>{let e=t.time,s=Date.now(),n=(s-e.updated)/1e3;return e.updated=s,e.offline=Math.min(e.offline+n,Ue()),e.export[0]+=n,n},Y=()=>{let e=o.intervalsId,s=v.intervals,n=o.paused;clearInterval(e.main),clearInterval(e.numbers),clearInterval(e.visual),clearInterval(e.autoSave),e.main=n?void 0:setInterval(Ge,s.main),e.numbers=n?void 0:setInterval(Q,s.numbers),e.visual=n?void 0:setInterval(ne,s.visual),e.autoSave=n?void 0:setInterval(Fe,s.autoSave)},Fe=async(e=!1)=>{if(o.paused)return U("No saving while game is paused"),null;try{t.history.stage.list=o.historyStorage.stage.slice(0,t.history.stage.input[0]);let s=btoa(JSON.stringify(t));return e||(localStorage.setItem("testing_save",s),clearInterval(o.intervalsId.autoSave),o.intervalsId.autoSave=setInterval(Fe,v.intervals.autoSave),r("isSaved").textContent="Saved",o.lastSave=0),s}catch(s){let n=s.stack;throw N(`Failed to save game
${typeof n=="string"?n.replaceAll(`${window.location.origin}/`,""):s}`),s}},_t=e=>{if(o.paused)return U("No loading while game is paused");o.paused=!0,Y();try{let s=lt(JSON.parse(atob(e)));o.lastSave=gt(),U(`This save is ${f(o.lastSave,{type:"time",padding:!1})} old. Save file version is ${s}`),F("reload")}catch(s){we(!!t.inflation.vacuum),N(`Incorrect save file format
${s}`)}o.paused=!1,Y()},Zt=async()=>{let e=t.time.export;if((t.stage.true>=7||t.stage.resets>=(t.inflation.vacuum?1:4))&&e[0]>0){let{strange:a}=t,i=Math.min(e[0]/86400,1),c=Math.floor((e[1]/2.5+1)*i);a[0].current+=c,a[0].total+=c,e[1]=Math.max(e[1]-c,0);let l=c>=1;if(t.strangeness[5][8]>=1){let g=Math.floor(e[2]/2.5*i);a[1].current+=g,a[1].total+=g,e[2]-=g,l||(l=g>=1)}l&&(e[0]=0,ie())}let s=await Fe(!0);if(s===null)return;let n=document.createElement("a");n.href=`data:text/plain,${s}`,n.download=Kt(),n.click()},es=async()=>{let e=await ot(`Available options:
'Copy' - copy save file to clipboard
'Delete' - delete your save file
'Reset' - reset game global settings
'Clear' - clear all domain data
Or insert save file string here to load it`);if(e===null||e==="")return;let s=e.toLowerCase();if(s==="copy"){let n=await Fe(!0);n!==null&&navigator.clipboard.writeText(n)}else if(s==="delete"||s==="reset"||s==="clear")o.paused=!0,Y(),s==="delete"?localStorage.removeItem("testing_save"):s==="reset"?localStorage.removeItem("fundamentalSettings"):localStorage.clear(),window.location.reload(),N("Awaiting game reload");else if(e==="devMode")v.developerMode=!v.developerMode,U(`Developer mode is ${v.developerMode?"now":"no longer"} active`),ae();else if(s==="achievement")U("Unlocked a new Achievement");else if(s==="slow"||s==="free")U("Game speed was increased by 1x");else if(s==="neutronium"||s==="element0")U(`${o.elementsInfo.effectText[0]().replace("this","Elements")}`);else{if(e.length<20)return void N(`Input '${e}' doesn't match anything`);if(!await K(`Press 'Confirm' to load input as a save file
(Input is too long to be displayed)`))return;_t(e)}},Kt=()=>{let e=t.fileName,s=new Date,n=e.indexOf("[date");if(n>=0){let l=e.indexOf("]",n+5);if(l>=0){let g=e.substring(n+5,l),d=["Y","M","D"],u=[`${s.getFullYear()}`,`${s.getMonth()+1}`.padStart(2,"0"),`${s.getDate()}`.padStart(2,"0")];for(let m=0;m<d.length;m++)g=g.replace(d[m],u[m]);e=e.replace(e.substring(n,l+1),g)}}let a=e.indexOf("[time");if(a>=0){let l=e.indexOf("]",a+5);if(l>=0){let g=e.substring(a+5,l),d=["H","M","S"],u=[`${s.getHours()}`.padStart(2,"0"),`${s.getMinutes()}`.padStart(2,"0"),`${s.getSeconds()}`.padStart(2,"0")];for(let m=0;m<d.length;m++)g=g.replace(d[m],u[m]);e=e.replace(e.substring(a,l+1),g)}}let i=["[stage]","[true]","[strange]","[vacuum]"],c=[o.stageInfo.word[t.stage.active],o.stageInfo.word[t.stage.true],`${t.strange[0].total}`,`${t.inflation.vacuum}`];for(let l=0;l<i.length;l++)e=e.replace(i[l],c[l]);return`${e}.txt`},B=e=>{o.intervalsId.mouseRepeat===void 0&&(o.intervalsId.mouseRepeat=setTimeout(()=>{o.intervalsId.mouseRepeat=setInterval(e,50)},200))},ut=()=>{clearInterval(o.intervalsId.mouseRepeat),o.intervalsId.mouseRepeat=void 0},Z=(e,s)=>{t.toggles.hover[0]&&t.stage.true>=4&&J(e,t.stage.active,s),s==="elements"?o.lastElement=e:o.lastUpgrade[t.stage.active]=[e,s],Ne(e,s)},ze=(e,s,n)=>{n==="strangeness"?o.lastStrangeness=[e,s]:o.lastMilestone=[e,s],Be(e,s,n)},ct=(e,s)=>{s==="challenge"?(o.lastChallenge[0]=e,$e(e)):(o.lastChallenge[1]=e,We(e))},Ve=()=>{let e=t.stage.active;for(let s=1;s<M.longestBuilding;s++)de(s,e,0)},Mt=async()=>{if(o.paused)return U("No warping while game is paused");let e=t.time.offline;if(e<60)return void N("Need at least 1 minute in Offline storage to Warp");let s=t.stage.true<5?await K(`Ready to use Offline?
(Offline storage is ${f(e,{type:"time",padding:!1})})`)?e:0:Math.min(Number(await ot(`How many seconds to Warp?
(Offline storage is ${f(e,{digits:0})} seconds)
Not using entire Offline storage will remove additional time from storage without using it (from half an hour up to same amount as Warp time)`,"1800")),e);if(s<60||!isFinite(s))return s>0?void N("Warp has to be at least 1 minute"):void 0;if(s<e){let n=Math.max(s,1800);s+n>=e?s=e:t.time.offline-=n}o.paused=!0,Y(),r("alertMain").style.display="none",r("warpMain").style.display="",r("blocker").style.display="",jt(s),t.time.offline-=s},jt=(e,s=e)=>{let n=Math.min(600,e);e-=n;try{Ge(n)}catch(a){Qt();let i=a.stack;throw N(`Warp failed
${typeof i=="string"?i.replaceAll(`${window.location.origin}/`,""):a}`),a}e>0?(setTimeout(jt,0,e,s),r("warpRemains").textContent=f(e,{type:"time"}),r("warpPercentage").textContent=f(100-e/s*100,{padding:!0}),v.SRSettings[0]&&r("warpMain").setAttribute("aria-valuetext",`${f(100-e/s*100)}% done`)):Qt(),Q(),ne()},Qt=()=>{U(`Warp ended after ${f(gt(),{type:"time",padding:!1})}`),o.paused=!1,Y(),r("blocker").style.display="none",r("warpMain").style.display="none",r("alertMain").style.display=""},Tt=async()=>{if(o.paused)return U("Game is already paused");o.paused=!0,Y(),await N("Game is currently paused. Press 'confirm' to unpause it. Time spent here will be moved into Offline storage");let e=gt();U(`Game was paused for ${f(e,{type:"time",padding:!1})}`),o.lastSave+=e,o.paused=!1,Y(),Q(),ne()};try{Vt();let e=fe(v),s=localStorage.getItem("fundamentalSettings");if(s!==null){Object.assign(v,JSON.parse(atob(s))),r("decimalPoint").value=v.format[0],r("thousandSeparator").value=v.format[1],r("mainInterval").value=`${v.intervals.main}`,r("numbersInterval").value=`${v.intervals.numbers}`,r("visualInterval").value=`${v.intervals.visual/1e3}`,r("autoSaveInterval").value=`${v.intervals.autoSave/1e3}`;for(let u=0;u<e.toggles.length;u++)le(u,"normal");if(v.fontSize!==16&&$t(!0),v.MDSettings[0]){document.getElementById("MDMessage1").remove(),M.styleSheet.textContent+='input[type = "image"], img { -webkit-touch-callout: none; }',M.styleSheet.textContent+="#themeArea.windowOpen > div > div { display: flex; } #themeArea.windowOpen > div > button { clip-path: circle(0); }",r("file").accept="";let u=document.createElement("button");u.append(document.createElement("div")),u.type="button";let m=document.createElement("button");m.append(document.createElement("div")),m.type="button",r("resetStage").append(u),u.addEventListener("click",()=>r("resetStage").classList.toggle("open")),u.addEventListener("blur",()=>r("resetStage").classList.remove("open")),r("reset1Main").append(m),m.addEventListener("click",()=>r("reset1Main").classList.toggle("open")),m.addEventListener("blur",()=>r("reset1Main").classList.remove("open")),M.styleSheet.textContent+="#resets { row-gap: 1em; } #resets > section { position: relative; flex-direction: row; justify-content: center; width: unset; padding: unset; row-gap: unset; background-color: unset; border: unset; } #resets > section:not(.open) > p { display: none !important; } #stageReset { width: 15.5em; font-size: 0.86em; }",M.styleSheet.textContent+="#resets > section > button:last-of-type { width: 2.2em !important; margin-left: -2px; } #resets button > div { clip-path: polygon(0 0, 50% 100%, 100% 0, 50% 25%); width: 1.24em; height: 1.24em; background-color: var(--main-text); pointer-events: none; margin: auto; } #resets p { position: absolute; width: 17.9em; padding: 0.5em 0.6em 0.6em; background-color: var(--window-color); border: 2px solid var(--window-border); top: calc(1.892em - 2px); z-index: 1; }";let h=document.createElement("button");h.textContent="Stage",h.id="stageFooter",h.type="button";let S=document.createElement("button");S.id="reset1Footer",S.type="button";let C=document.createElement("button");C.textContent="Collapse",C.id="resetCollapseFooter",C.type="button",r("phoneHotkeys").prepend(S,C,h),C.addEventListener("click",De),r("toggleMax0").classList.add("stage2Unlock"),r("researchToggles").classList.remove("stage2Unlock");let w=document.createElement("button");w.classList.add("hollowButton"),w.textContent="Create",w.id="upgradeCreate",w.type="button",M.styleSheet.textContent+="#upgradeCreate { height: 1.76em; padding: 0 0.44em; border-radius: 2px; font-size: 0.92em; }",r("toggleHover0").after(w);let x=document.createElement("div");x.id="strangenessPages",x.innerHTML='<button type="button" id="strangenessPage1" class="stage1borderImage hollowButton">1</button><button type="button" id="strangenessPage2" class="stage2borderImage hollowButton">2</button><button type="button" id="strangenessPage3" class="stage3borderImage hollowButton">3</button><button type="button" id="strangenessPage4" class="stage4borderImage hollowButton">4</button><button type="button" id="strangenessPage5" class="stage5borderImage hollowButton">5</button><button type="button" id="strangenessCreate" class="hollowButton">Create</button>',M.styleSheet.textContent+="#strangenessPages { display: flex; justify-content: center; column-gap: 0.3em; } #strangenessPages button { width: 2.08em; height: calc(2.08em - 2px); border-top: none; border-radius: 0 0 4px 4px; } #strangenessCreate { width: unset !important; padding: 0 0.4em; }",r("strangenessResearch").append(x);let $=document.createElement("li");$.innerHTML='<label>Keep mouse events<button type="button" id="MDToggle1" class="specialToggle">OFF</button></label>',r("MDLi").after($),r("MDToggle1").addEventListener("click",()=>le(1,"mobile",!0,!0));for(let T=0;T<e.MDSettings.length;T++)le(T,"mobile")}if(v.SRSettings[0]){document.getElementById("SRMessage1").remove();for(let C=0;C<3;C++){let w=r(C===0?"solarMassExplanation":`star${C}Explanation`);w.textContent=` (${w.textContent})`}let u=document.createElement("article");u.innerHTML='<h3>Information for Screen reader</h3><p id="SRTab" aria-live="polite"></p><p id="SRStage" aria-live="polite"></p><p id="SRMain" aria-live="assertive"></p>',u.className="reader",r("fakeFooter").before(u);let m=document.createElement("li");m.innerHTML='<label>Keep tab index on created Upgrades<button type="button" id="SRToggle1" class="specialToggle">OFF</button></label>';let h=document.createElement("li");h.innerHTML='<label>Keep tab index on primary buttons<button type="button" id="SRToggle2" class="specialToggle">OFF</button></label>',r("SRLi").after(m,h),r("SRToggle1").addEventListener("click",()=>{le(1,"reader",!0),F("reload");for(let C=1;C<t.strangeness.length;C++)for(let w=0;w<o.strangenessInfo[C].maxActive;w++)O(w,C,"strangeness")});let S=(C=!1)=>{C||le(2,"reader",!0);let w=v.SRSettings[2]?0:-1;r("stageReset").tabIndex=w,r("reset1Button").tabIndex=w;for(let x=1;x<M.longestBuilding;x++)r(`building${x}Btn`).tabIndex=w,r(`toggleBuilding${x}`).tabIndex=w;r("toggleBuilding0").tabIndex=w;for(let x of o.tabList.tabs){r(`${x}TabBtn`).tabIndex=w;let $=o.tabList[`${x}Subtabs`];if($!==void 0)for(let T of $)r(`${x}SubtabBtn${T}`).tabIndex=w}for(let x=1;x<o.stageInfo.word.length;x++)r(`${o.stageInfo.word[x]}Switch`).tabIndex=w};r("SRToggle2").addEventListener("click",()=>{S()}),v.SRSettings[2]&&S(!0);for(let C=0;C<e.SRSettings.length;C++)le(C,"reader");M.styleSheet.textContent+="#starEffects > p > span { display: unset !important; }"}if(v.developerMode){let u=document.createElement("button");u.classList.add("hollowButton"),u.textContent="Pause",u.type="button",r("offlineWarp").after(u),u.addEventListener("click",Tt)}}let n,a=localStorage.getItem("testing_save");if(a!==null){let u=lt(JSON.parse(atob(a)));o.lastSave=gt(),n=`Welcome back, you were away for ${f(o.lastSave,{type:"time",padding:!1})}
${u!==t.version?`Game have been updated from ${u} to ${t.version}`:`Current version is ${t.version}`}`}else we(!1),lt(fe(E)),n=`Welcome to 'Fundamental' ${t.version}, a test-project created by awWhy
(This idle game is not meant to be fast)`;if(v.toggles[1]){let u=r("upgradeSubtabElements");u.id="ElementsTab",r("upgradeTab").after(u),Wt("upgradeSubtabElements");let m=r("upgradeSubtabBtnElements");m.id="ElementsTabBtn",m.classList.add("stage4Include"),r("upgradeTabBtn").after(m),Wt("upgradeSubtabBtnElements");let h=o.tabList;h.upgradeSubtabs.splice(h.upgradeSubtabs.indexOf("Elements"),1),h.tabs.splice(h.tabs.indexOf("upgrade")+1,0,"Elements")}let i=v.MDSettings[0],c=v.SRSettings[0],l=!i||v.MDSettings[1],g=document.body;g.addEventListener("keydown",u=>Gt(u));let d=u=>{o.hotkeys.shift&&!u.shiftKey&&(o.hotkeys.shift=!1),o.hotkeys.ctrl&&!u.ctrlKey&&(o.hotkeys.ctrl=!1)};g.addEventListener("keyup",d),g.addEventListener("contextmenu",u=>{let m=document.activeElement?.type;m!=="text"&&m!=="number"&&!v.developerMode&&u.preventDefault()}),l&&(g.addEventListener("mouseup",u=>{ut(),d(u)}),g.addEventListener("mouseleave",ut)),i&&(g.addEventListener("touchend",ut),g.addEventListener("touchcancel",ut));for(let u=0;u<e.toggles.length;u++)r(`toggleNormal${u}`).addEventListener("click",()=>le(u,"normal",!0,u===1));for(let u=0;u<E.toggles.confirm.length;u++)r(`toggleConfirm${u}`).addEventListener("click",()=>tt(u,!0));for(let u=0;u<M.longestBuilding;u++)r(`toggleBuilding${u}`).addEventListener("click",()=>G(u,"buildings",!0));for(let u=0;u<E.toggles.hover.length;u++)r(`toggleHover${u}`).addEventListener("click",()=>G(u,"hover",!0));for(let u=0;u<E.toggles.max.length;u++)r(`toggleMax${u}`).addEventListener("click",()=>G(u,"max",!0));for(let u=0;u<E.toggles.auto.length;u++)r(`toggleAuto${u}`).addEventListener("click",()=>G(u,"auto",!0));{let u=()=>{t.inflation.vacuum||t.stage.active>=4||Ie()},m=r("stageReset");if(m.addEventListener("click",Ie),l&&m.addEventListener("mousedown",()=>B(u)),i){m.addEventListener("touchstart",()=>B(u));let h=r("stageFooter");h.addEventListener("click",Ie),h.addEventListener("touchstart",()=>B(u)),l&&h.addEventListener("mousedown",()=>B(u))}}{let u=()=>{let S=t.stage.active;S===1?st():S===2?nt():S===3?rt():S===4&&De()},m=()=>{t.stage.active!==1&&t.stage.active!==3||u()},h=r("reset1Button");if(h.addEventListener("click",u),l&&h.addEventListener("mousedown",()=>B(m)),i){h.addEventListener("touchstart",()=>B(m));let S=r("reset1Footer");S.addEventListener("click",u),S.addEventListener("touchstart",()=>B(m)),l&&S.addEventListener("mousedown",()=>B(m))}}for(let u=1;u<M.longestBuilding;u++){let m=r(`building${u}Btn`),h=()=>de(u);m.addEventListener("click",h),l&&m.addEventListener("mousedown",()=>B(h)),i&&m.addEventListener("touchstart",()=>B(h))}{let u=r("makeAllStructures");u.addEventListener("click",Ve),l&&u.addEventListener("mousedown",()=>B(Ve)),i&&u.addEventListener("touchstart",()=>B(Ve))}r("buyAnyInput").addEventListener("change",()=>{let u=r("buyAnyInput");t.toggles.shop.input=Math.max(Math.trunc(Number(u.value)),0),u.value=f(t.toggles.shop.input,{type:"input"}),Q()}),r("autoWaitInput").addEventListener("change",()=>{let u=r("autoWaitInput"),m=Math.max(Number(u.value),1);isNaN(m)&&(m=2),t.toggles.shop.wait[t.stage.active]=m,u.value=f(m,{type:"input"})});for(let u=-1;u<o.challengesInfo.name.length;u++){let m=r(`challenge${u+1}`);l&&m.addEventListener("mouseover",()=>ct(u,"challenge")),i&&m.addEventListener("touchstart",()=>ct(u,"challenge")),c&&m.addEventListener("focus",()=>ct(u,"challenge")),m.addEventListener("click",u===-1?Rt:()=>{Dt(u)})}for(let u=1;u<o.challengesInfo.rewardText[0].length;u++){let m=r(`voidReward${o.stageInfo.word[u]}`);m.addEventListener("click",()=>ct(u,"reward")),i&&m.addEventListener("click",()=>r("voidRewardsDiv").style.display="block")}i&&r("voidRewardsDiv").addEventListener("click",()=>r("voidRewardsDiv").style.display="");for(let u=0;u<M.longestUpgrade;u++){let m=r(`upgrade${u+1}`),h=()=>Z(u,"upgrades");if(l&&m.addEventListener("mouseover",h),i)m.addEventListener("touchstart",()=>{Z(u,"upgrades"),B(h)});else{let S=()=>J(u,t.stage.active,"upgrades");m.addEventListener("click",S),m.addEventListener("mousedown",()=>B(S))}c&&m.addEventListener("focus",h)}for(let u=0;u<M.longestResearch;u++){let m=r(`research${u+1}Image`),h=()=>Z(u,"researches");if(l&&m.addEventListener("mouseover",h),i)m.addEventListener("touchstart",()=>{Z(u,"researches"),B(h)});else{let S=()=>J(u,t.stage.active,"researches");m.addEventListener("click",S),m.addEventListener("mousedown",()=>B(S))}c&&m.addEventListener("focus",h)}for(let u=0;u<M.longestResearchExtra;u++){let m=r(`researchExtra${u+1}Image`),h=()=>Z(u,"researchesExtra");if(l&&m.addEventListener("mouseover",h),i)m.addEventListener("touchstart",()=>{Z(u,"researchesExtra"),B(h)});else{let S=()=>J(u,t.stage.active,"researchesExtra");m.addEventListener("click",S),m.addEventListener("mousedown",()=>B(S))}c&&m.addEventListener("focus",h)}for(let u=0;u<o.researchesAutoInfo.costRange.length;u++){let m=r(`researchAuto${u+1}Image`),h=()=>Z(u,"researchesAuto");if(l&&m.addEventListener("mouseover",h),i)m.addEventListener("touchstart",()=>{Z(u,"researchesAuto"),B(h)});else{let S=()=>J(u,t.stage.active,"researchesAuto");m.addEventListener("click",S),m.addEventListener("mousedown",()=>B(S))}c&&m.addEventListener("focus",h)}{let u=r("ASRImage"),m=()=>Z(0,"ASR");if(l&&u.addEventListener("mouseover",m),i)u.addEventListener("touchstart",()=>{Z(0,"ASR"),B(m)});else{let h=()=>J(0,t.stage.active,"ASR");u.addEventListener("click",h),u.addEventListener("mousedown",()=>B(h))}c&&u.addEventListener("focus",m)}if(i){let u=r("upgradeCreate"),m=()=>{let h=t.stage.active;J(o.lastUpgrade[h][0],h,o.lastUpgrade[h][1])};u.addEventListener("click",m),u.addEventListener("touchstart",()=>B(m)),l&&u.addEventListener("mousedown",()=>B(m))}l&&r("element0").addEventListener("dblclick",()=>{o.lastElement=0,Ne(0,"elements")});for(let u=1;u<o.elementsInfo.startCost.length;u++){let m=r(`element${u}`),h=()=>J(u,4,"elements");l&&(m.addEventListener("mouseover",()=>Z(u,"elements")),m.addEventListener("mousedown",()=>B(h))),i&&m.addEventListener("touchstart",()=>{Z(u,"elements"),B(h)}),c&&m.addEventListener("focus",()=>Z(u,"elements")),(l||c)&&m.addEventListener("click",h)}for(let u=0;u<2;u++){let m=r(`strange${u}`),h=["quarks","strangelets"][u],S=()=>{h==="quarks"&&!t.inflation.vacuum&&t.milestones[4][0]<8||(r(`${h}EffectsMain`).style.display="",Q())};m.addEventListener("focus",S),i&&m.addEventListener("click",S),m.addEventListener("blur",()=>r(`${h}EffectsMain`).style.display="none"),r(`${h}EffectsMain`).addEventListener("click",C=>{r(`${h}EffectsMain`).style.display="none",C.stopPropagation()})}for(let u=1;u<o.strangenessInfo.length;u++){i&&r(`strangenessPage${u}`).addEventListener("click",()=>Ye(u));for(let m=0;m<o.strangenessInfo[u].startCost.length;m++){let h=r(`strange${m+1}Stage${u}Image`),S=()=>ze(m,u,"strangeness");if(l&&h.addEventListener("mouseover",S),i)h.addEventListener("touchstart",()=>{ze(m,u,"strangeness")});else{let C=()=>vt(m,u,"strangeness");h.addEventListener("click",C),h.addEventListener("mousedown",()=>B(C))}c&&h.addEventListener("focus",S)}}if(i){let u=r("strangenessCreate"),m=()=>vt(o.lastStrangeness[0],o.lastStrangeness[1],"strangeness");u.addEventListener("click",m),u.addEventListener("touchstart",()=>B(m)),l&&u.addEventListener("mousedown",()=>B(m))}for(let u=1;u<o.milestonesInfo.length;u++)for(let m=0;m<o.milestonesInfo[u].need.length;m++){let h=z(`#milestone${m+1}Stage${u}Div > img`);l&&h.addEventListener("mouseover",()=>ze(m,u,"milestones")),i&&h.addEventListener("touchstart",()=>ze(m,u,"milestones")),c&&(h.tabIndex=0,h.classList.add("noFocusOutline"),h.addEventListener("focus",()=>ze(m,u,"milestones")))}r("vaporizationInput").addEventListener("change",()=>{let u=r("vaporizationInput");t.vaporization.input[0]=Math.max(Number(u.value),0),u.value=f(t.vaporization.input[0],{type:"input"})}),r("vaporizationInputMax").addEventListener("change",()=>{let u=r("vaporizationInputMax");t.vaporization.input[1]=Math.max(Number(u.value),0),u.value=f(t.vaporization.input[1],{type:"input"})}),r("collapseStarsInput").addEventListener("change",()=>{let u=r("collapseStarsInput"),m=u.value.replace(",","."),h=m.includes("!");h&&(m=m.replace("!","")),m=Math.max(Number(m),1),isNaN(m)&&(m=2,h=!1),t.collapse.input[1]=h,t.collapse.input[0]=m,u.value=`${f(m,{type:"input"})}${h?"!":""}`}),r("stageInput").addEventListener("change",()=>{let u=r("stageInput");t.stage.input=Math.max(Number(u.value),0),u.value=f(t.stage.input,{type:"input"})}),r("versionButton").addEventListener("click",()=>{qt(),r("versionInfo").style.display=""}),r("save").addEventListener("click",()=>{Fe()}),r("file").addEventListener("change",async()=>{let u=r("file");_t(await u.files[0].text()),u.value=""}),r("export").addEventListener("click",Zt),r("saveConsole").addEventListener("click",es),i&&(r("currentTheme").addEventListener("click",()=>r("themeArea").classList.add("windowOpen")),r("themeArea").addEventListener("mouseleave",()=>r("themeArea").classList.remove("windowOpen"))),r("switchTheme0").addEventListener("click",()=>at(null));for(let u=1;u<o.stageInfo.word.length;u++)r(`switchTheme${u}`).addEventListener("click",()=>at(u));r("toggleAuto8").addEventListener("click",pe),r("toggleAuto5").addEventListener("click",()=>me("all")),r("toggleAuto6").addEventListener("click",()=>se("researches","all")),r("toggleAuto7").addEventListener("click",()=>se("researchesExtra","all")),r("saveFileNameInput").addEventListener("change",()=>{let u=r("saveFileNameInput"),m=u.value;if(m.length<1)return void(u.value=E.fileName);try{btoa(m),t.fileName=m}catch(h){N(`Save file name is not allowed
${h}`)}});{let u=r("saveFileHoverButton"),m=()=>r("saveFileNamePreview").textContent=Kt();u.addEventListener("mouseover",m),c&&u.addEventListener("focus",m)}r("mainInterval").addEventListener("change",()=>{let u=r("mainInterval");v.intervals.main=Math.min(Math.max(Math.trunc(Number(u.value)),20),100),u.value=`${v.intervals.main}`,ae(),Y()}),r("numbersInterval").addEventListener("change",()=>{let u=r("numbersInterval");v.intervals.numbers=Math.min(Math.max(Math.trunc(Number(u.value)),40),200),u.value=`${v.intervals.numbers}`,ae(),Y()}),r("visualInterval").addEventListener("change",()=>{let u=r("visualInterval");v.intervals.visual=Math.min(Math.max(Math.trunc(Number(u.value)*100),20),400)*10,u.value=`${v.intervals.visual/1e3}`,ae(),Y()}),r("autoSaveInterval").addEventListener("change",()=>{let u=r("autoSaveInterval");v.intervals.autoSave=Math.min(Math.max(Math.trunc(Number(u.value)),4),1800)*1e3,u.value=`${v.intervals.autoSave/1e3}`,ae(),Y()}),r("thousandSeparator").addEventListener("change",()=>Ct(!1)),r("decimalPoint").addEventListener("change",()=>Ct(!0)),r("MDToggle0").addEventListener("click",()=>le(0,"mobile",!0,!0)),r("SRToggle0").addEventListener("click",()=>le(0,"reader",!0,!0)),r("reviewEvents").addEventListener("click",Ft),r("offlineWarp").addEventListener("click",Mt),r("customFontSize").addEventListener("change",()=>$t(!1)),r("stageResetsSave").addEventListener("change",()=>{let u=r("stageResetsSave");t.history.stage.input[0]=Math.min(Math.max(Math.trunc(Number(u.value)),0),100),u.value=`${t.history.stage.input[0]}`}),r("stageResetsShow").addEventListener("change",()=>{let u=r("stageResetsShow");t.history.stage.input[1]=Math.min(Math.max(Math.trunc(Number(u.value)),4),100),u.value=`${t.history.stage.input[1]}`,o.debug.historyStage=-1,ne()});{let u=r("hideToggle");if(i){let m=()=>{if(!o.footer)return it();o.intervalsId.mouseRepeat===void 0&&(o.intervalsId.mouseRepeat=setTimeout(it,400))};u.addEventListener("touchstart",m),l&&u.addEventListener("mousedown",m)}else u.addEventListener("click",it)}for(let u of o.tabList.tabs){r(`${u}TabBtn`).addEventListener("click",()=>j(u));let m=o.tabList[`${u}Subtabs`];if(m!==void 0)for(let h of m)r(`${u}SubtabBtn${h}`).addEventListener("click",()=>j(u,h))}for(let u=1;u<o.stageInfo.word.length;u++)r(`${o.stageInfo.word[u]}Switch`).addEventListener("click",()=>he(u));F("reload"),document.head.append(document.createComment(" Rarely used CSS rules "),M.styleSheet),r("body").style.display="",r("loading").style.display="none",o.paused=!1,Y(),document.title=`Fundamental ${E.version}`,v.theme!==null&&at(v.theme,!0),N(n+`
(Game loaded after ${f((Date.now()-E.time.started)/1e3,{type:"time",padding:!1})})`)}catch(e){let s=e.stack;N(`Game failed to load
${typeof s=="string"?s.replaceAll(`${window.location.origin}/`,""):e}`);let n=document.createElement("div");n.innerHTML='<button type="button" id="exportError" style="width: 7em;">Export save</button><button type="button" id="deleteError" style="width: 7em;">Delete save</button>',n.style.cssText="display: flex; column-gap: 0.6em; margin-top: 0.4em;",r("loading").append(n);let a=!1;throw r("exportError").addEventListener("click",()=>{a=!0;let i=localStorage.getItem("testing_save");if(i===null)return void N("No save file detected");let c=document.createElement("a");c.href=`data:text/plain,${i}`,c.download="Fundamental post error export",c.click()}),r("deleteError").addEventListener("click",async()=>{!a&&!await K(`Recommended to export save file first
Press 'Confirm' to confirm and delete your save file`)||(localStorage.removeItem("testing_save"),window.location.reload(),N("Awaiting game reload"))}),e}})();
//# sourceMappingURL=Code.js.map
